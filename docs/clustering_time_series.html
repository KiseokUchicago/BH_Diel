<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="KiseokUchicago" />

<meta name="date" content="2021-03-10" />

<title>clustering_time_series</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BH_Diel</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/KiseokUchicago/BH_Diel">
    <span class="fas fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">clustering_time_series</h1>
<h4 class="author">KiseokUchicago</h4>
<h4 class="date">2021-03-10</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-03-10
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>BH_Diel/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20210222code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20210222)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20210222code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20210222)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomKiseokUchicagoBHDieltree71155f848db04d045425be78875e661717977684targetblank71155f8a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/KiseokUchicago/BH_Diel/tree/71155f848db04d045425be78875e661717977684" target="_blank">71155f8</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomKiseokUchicagoBHDieltree71155f848db04d045425be78875e661717977684targetblank71155f8a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/KiseokUchicago/BH_Diel/tree/71155f848db04d045425be78875e661717977684" target="_blank">71155f8</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  01_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-BDCL_filtered_PSMs.tsv
    Untracked:  01_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-BDCL_filtered_PSMs.xlsx
    Untracked:  02_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-DCL_filtered_PSMs.tsv
    Untracked:  02_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-DCL_filtered_PSMs.xlsx
    Untracked:  03_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-SRF_filtered_PSMs.tsv
    Untracked:  03_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-SRF_filtered_PSMs.xlsx
    Untracked:  04_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-BDCL_filtered_PSMs.tsv
    Untracked:  04_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-BDCL_filtered_PSMs.xlsx
    Untracked:  05_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-DCL_filtered_PSMs.tsv
    Untracked:  05_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-DCL_filtered_PSMs.xlsx
    Untracked:  06_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-SRF_filtered_PSMs.tsv
    Untracked:  06_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-SRF_filtered_PSMs.xlsx
    Untracked:  07_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-BDCL_filtered_PSMs.tsv
    Untracked:  07_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-BDCL_filtered_PSMs.xlsx
    Untracked:  08_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-DCL_filtered_PSMs.tsv
    Untracked:  08_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-DCL_filtered_PSMs.xlsx
    Untracked:  09_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-SRF_filtered_PSMs.tsv
    Untracked:  09_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-SRF_filtered_PSMs.xlsx
    Untracked:  10_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-BDCL_filtered_PSMs.tsv
    Untracked:  10_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-BDCL_filtered_PSMs.xlsx
    Untracked:  11_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-DCL_filtered_PSMs.tsv
    Untracked:  11_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-DCL_filtered_PSMs.xlsx
    Untracked:  12_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-SRF_filtered_PSMs.tsv
    Untracked:  12_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-SRF_filtered_PSMs.xlsx
    Untracked:  13_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-BDCL_filtered_PSMs.tsv
    Untracked:  13_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-BDCL_filtered_PSMs.xlsx
    Untracked:  14_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-DCL_filtered_PSMs.tsv
    Untracked:  14_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-DCL_filtered_PSMs.xlsx
    Untracked:  15_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-SRF_filtered_PSMs.tsv
    Untracked:  15_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-SRF_filtered_PSMs.xlsx
    Untracked:  16_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-BDCL_filtered_PSMs.tsv
    Untracked:  16_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-BDCL_filtered_PSMs.xlsx
    Untracked:  17_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-DCL_filtered_PSMs.tsv
    Untracked:  17_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-DCL_filtered_PSMs.xlsx
    Untracked:  18_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-SRF_filtered_PSMs.tsv
    Untracked:  18_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-SRF_filtered_PSMs.xlsx
    Untracked:  19_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T7-DCL_filtered_PSMs.tsv
    Untracked:  19_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T7-DCL_filtered_PSMs.xlsx
    Untracked:  20_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T7-SRF_filtered_PSMs.tsv
    Untracked:  20_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T7-SRF_filtered_PSMs.xlsx
    Untracked:  21_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T8-BDCL_filtered_PSMs.tsv
    Untracked:  21_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T8-BDCL_filtered_PSMs.xlsx
    Untracked:  22_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T8-DCL_filtered_PSMs.tsv
    Untracked:  22_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T8-DCL_filtered_PSMs.xlsx
    Untracked:  23_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T8-SRF_filtered_PSMs.tsv
    Untracked:  23_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T8-SRF_filtered_PSMs.xlsx
    Untracked:  24_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-BDCL_filtered_PSMs.tsv
    Untracked:  24_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-BDCL_filtered_PSMs.xlsx
    Untracked:  25_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-DCL_filtered_PSMs.tsv
    Untracked:  25_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-DCL_filtered_PSMs.xlsx
    Untracked:  26_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-SRF_filtered_PSMs.tsv
    Untracked:  26_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-SRF_filtered_PSMs.xlsx
    Untracked:  27_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-BDCL_filtered_PSMs.tsv
    Untracked:  27_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-BDCL_filtered_PSMs.xlsx
    Untracked:  28_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-DCL_filtered_PSMs.tsv
    Untracked:  28_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-DCL_filtered_PSMs.xlsx
    Untracked:  29_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-SRF_filtered_PSMs.tsv
    Untracked:  29_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-SRF_filtered_PSMs.xlsx
    Untracked:  30_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-BDCL_filtered_PSMs.tsv
    Untracked:  30_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-BDCL_filtered_PSMs.xlsx
    Untracked:  31_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-DCL_filtered_PSMs.tsv
    Untracked:  31_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-DCL_filtered_PSMs.xlsx
    Untracked:  32_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-SRF_filtered_PSMs.tsv
    Untracked:  32_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-SRF_filtered_PSMs.xlsx
    Untracked:  33_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-BDCL_filtered_PSMs.tsv
    Untracked:  33_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-BDCL_filtered_PSMs.xlsx
    Untracked:  34_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-DCL_filtered_PSMs.tsv
    Untracked:  34_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-DCL_filtered_PSMs.xlsx
    Untracked:  35_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-SRF_filtered_PSMs.tsv
    Untracked:  35_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-SRF_filtered_PSMs.xlsx
    Untracked:  36_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-BDCL_filtered_PSMs.tsv
    Untracked:  36_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-BDCL_filtered_PSMs.xlsx
    Untracked:  37_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-DCL_filtered_PSMs.tsv
    Untracked:  37_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-DCL_filtered_PSMs.xlsx
    Untracked:  38_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-SRF_filtered_PSMs.tsv
    Untracked:  38_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-SRF_filtered_PSMs.xlsx
    Untracked:  39_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-BDCL_filtered_PSMs.tsv
    Untracked:  39_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-BDCL_filtered_PSMs.xlsx
    Untracked:  40_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-DCL_filtered_PSMs.tsv
    Untracked:  40_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-DCL_filtered_PSMs.xlsx
    Untracked:  41_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-SRF_filtered_PSMs.tsv
    Untracked:  41_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-SRF_filtered_PSMs.xlsx
    Untracked:  42_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-BDCL_filtered_PSMs.tsv
    Untracked:  42_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-BDCL_filtered_PSMs.xlsx
    Untracked:  43_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-DCL_filtered_PSMs.tsv
    Untracked:  43_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-DCL_filtered_PSMs.xlsx
    Untracked:  44_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-SRF_filtered_PSMs.tsv
    Untracked:  44_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-SRF_filtered_PSMs.xlsx
    Untracked:  45_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-BDCL_filtered_PSMs.tsv
    Untracked:  45_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-BDCL_filtered_PSMs.xlsx
    Untracked:  46_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-DCL_filtered_PSMs.tsv
    Untracked:  46_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-DCL_filtered_PSMs.xlsx
    Untracked:  47_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-SRF_filtered_PSMs.tsv
    Untracked:  47_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-SRF_filtered_PSMs.xlsx
    Untracked:  48_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-BDCL_filtered_PSMs.tsv
    Untracked:  48_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-BDCL_filtered_PSMs.xlsx
    Untracked:  49_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-DCL_filtered_PSMs.tsv
    Untracked:  49_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-DCL_filtered_PSMs.xlsx
    Untracked:  50_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-SRF_filtered_PSMs.tsv
    Untracked:  50_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-SRF_filtered_PSMs.xlsx
    Untracked:  51_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-BDCL_filtered_PSMs.tsv
    Untracked:  51_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-BDCL_filtered_PSMs.xlsx
    Untracked:  52_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-DCL_filtered_PSMs.tsv
    Untracked:  52_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-DCL_filtered_PSMs.xlsx
    Untracked:  53_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-SRF_filtered_PSMs.tsv
    Untracked:  53_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-SRF_filtered_PSMs.xlsx
    Untracked:  54_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-BDCL_filtered_PSMs.tsv
    Untracked:  54_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-BDCL_filtered_PSMs.xlsx
    Untracked:  55_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-DCL_filtered_PSMs.tsv
    Untracked:  55_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-DCL_filtered_PSMs.xlsx
    Untracked:  56_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-SRF_filtered_PSMs.tsv
    Untracked:  56_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-SRF_filtered_PSMs.xlsx
    Untracked:  57_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-BDCL_filtered_PSMs.tsv
    Untracked:  57_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-BDCL_filtered_PSMs.xlsx
    Untracked:  58_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-DCL_filtered_PSMs.tsv
    Untracked:  58_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-DCL_filtered_PSMs.xlsx
    Untracked:  59_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-SRF_filtered_PSMs.tsv
    Untracked:  59_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-SRF_filtered_PSMs.xlsx
    Untracked:  60_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-BDCL_filtered_PSMs.tsv
    Untracked:  60_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-BDCL_filtered_PSMs.xlsx
    Untracked:  61_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-DCL_filtered_PSMs.tsv
    Untracked:  61_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-DCL_filtered_PSMs.xlsx
    Untracked:  62_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-SRF_filtered_PSMs.tsv
    Untracked:  62_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-SRF_filtered_PSMs.xlsx
    Untracked:  63_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T7-BDCL_filtered_PSMs.tsv
    Untracked:  63_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T7-BDCL_filtered_PSMs.xlsx
    Untracked:  64_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T7-DCL_filtered_PSMs.tsv
    Untracked:  64_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T7-DCL_filtered_PSMs.xlsx
    Untracked:  65_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-BDCL_filtered_PSMs.tsv
    Untracked:  65_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-BDCL_filtered_PSMs.xlsx
    Untracked:  66_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-DCL_filtered_PSMs.tsv
    Untracked:  66_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-DCL_filtered_PSMs.xlsx
    Untracked:  67_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-SRF_filtered_PSMs.tsv
    Untracked:  67_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-SRF_filtered_PSMs.xlsx
    Untracked:  Hist_freq_of_peptide_id.pdf
    Untracked:  Hist_intensity_replicate_centered.pdf
    Untracked:  Hist_intensity_replicate_not_centered.pdf
    Untracked:  Hist_intensity_spec_level_centered.pdf
    Untracked:  Hist_intensity_spec_level_not_centered.pdf
    Untracked:  Hist_number of timepoints_peptide_appears.pdf
    Untracked:  P1_number_unique_peptide_per_sample.pdf
    Untracked:  P2_number_of_cumulative_unique_peptides.pdf
    Untracked:  Peptide_id.tsv
    Untracked:  Replicate_ABC50_combined.tsv
    Untracked:  Replicate_ABC50_combined.xlsx
    Untracked:  Replicate_ABC63_combined.tsv
    Untracked:  Replicate_ABC63_combined.xlsx
    Untracked:  Replicate_ABC67_combined.tsv
    Untracked:  Replicate_ABC67_combined.xlsx
    Untracked:  Replicate_BC_combined.tsv
    Untracked:  Replicate_BC_combined.xlsx
    Untracked:  Replicate_B_combined.tsv
    Untracked:  Replicate_B_combined.xlsx
    Untracked:  Time_series_intesity_all.pdf
    Untracked:  data/Time_metadata.txt
    Untracked:  data/counts_example.csv
    Untracked:  data/diel-Feb21/
    Untracked:  data/diel-Feb25/
    Untracked:  data/diel-Feb26/
    Untracked:  data/diel-Mar2/
    Untracked:  data/synthetic_control.data.txt
    Untracked:  hclust_DTW_average_wide.pdf
    Untracked:  hclust_DTW_average_wide_after_normalization.pdf

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/clustering_time_series.Rmd</code>) and HTML (<code>docs/clustering_time_series.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/71155f848db04d045425be78875e661717977684/analysis/clustering_time_series.Rmd" target="_blank">71155f8</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-10
</td>
<td>
splitting rmd
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="time-series-clustering" class="section level3">
<h3>Time series clustering</h3>
</div>
<div id="unsupervised-clustering-with-various-distances-sbd-dtw-prototyping-methods-clustering-methods" class="section level3">
<h3>Unsupervised clustering with various distances (SBD, DTW, …) / prototyping methods / clustering methods<br />
</h3>
<ul>
<li>Using dtwclust package</li>
<li>How many clusters should we use? Evaluate by CVI (Cluster validity index, the bigger the better for internal CVI)<br />
</li>
<li>Please normalize before clustering</li>
</ul>
</div>
<div id="data-formating-for-tsclust-input" class="section level3">
<h3>1. Data formating for tsclust input</h3>
<pre class="r"><code># libraries
library(dplyr)
library(tidyr)
library(stringr)
library(ggplot2)
library(formattable)</code></pre>
<p>Input data formating</p>
<pre class="r"><code># read in combined table of 24 samples (Replicate B)
df_pep &lt;- read.table(&quot;Replicate_ABC67_combined.tsv&quot;,sep=&#39;\t&#39;,header = T)

# Let&#39;s try to plot all of them at once
df_all &lt;- df_pep %&gt;% select(Peptide_id, SampleID, Time, Depth) %&gt;% unique() %&gt;% arrange(Peptide_id)
# How many time points did it appear
(df_all2 &lt;- df_all %&gt;% group_by(Peptide_id, Depth) %&gt;% summarize(Timepoints = n_distinct(Time)) %&gt;% ungroup())</code></pre>
<pre><code># A tibble: 6,104 x 3
   Peptide_id Depth Timepoints
   &lt;chr&gt;      &lt;chr&gt;      &lt;int&gt;
 1 Pep_1      BDCL           8
 2 Pep_1      DCL            8
 3 Pep_1      SRF            8
 4 Pep_10     BDCL           8
 5 Pep_10     DCL            8
 6 Pep_10     SRF            8
 7 Pep_100    BDCL           8
 8 Pep_100    DCL            8
 9 Pep_100    SRF            8
10 Pep_1000   BDCL           1
# ... with 6,094 more rows</code></pre>
<pre class="r"><code>df_all2$Depth &lt;- factor(df_all2$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))

# (1) Get list of peptides that are present in 7 or 8 timepoints
df_all2_filt &lt;- df_all2 %&gt;% filter(Timepoints &gt; 6) %&gt;% unique() 

# (2) Let&#39;s average the abundance_ratio for each unique peptide
df_int &lt;- df_pep %&gt;% select(Peptide_id, Spec_id, cent.log2.16O.18O.Ratio, SampleID, Time, Depth, Replicate) %&gt;%
  unique() %&gt;% arrange(Peptide_id)
# first average the spectrum_id per sample 
# important to make sure to take the mean of the log raio (instead of taking log2 after averaging the original value(2^x))
df_ave &lt;- df_int %&gt;% group_by(SampleID, Time, Depth, Replicate, Peptide_id) %&gt;%
  summarize(Mean_abundance_ratio=mean(cent.log2.16O.18O.Ratio),
            SD_pep=sd(cent.log2.16O.18O.Ratio)) %&gt;% ungroup()
head(df_ave)</code></pre>
<pre><code># A tibble: 6 x 7
  SampleID  Time  Depth Replicate Peptide_id Mean_abundance_ratio  SD_pep
  &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;                     &lt;dbl&gt;   &lt;dbl&gt;
1 BDCL_T1_A T1    BDCL  A         Pep_1                   -0.251   0.240 
2 BDCL_T1_A T1    BDCL  A         Pep_10                   0.229   0.241 
3 BDCL_T1_A T1    BDCL  A         Pep_100                  0.0658  0.286 
4 BDCL_T1_A T1    BDCL  A         Pep_101                  0.0175  0.0496
5 BDCL_T1_A T1    BDCL  A         Pep_1014                 0.863  NA     
6 BDCL_T1_A T1    BDCL  A         Pep_1015                 0.158   0.0991</code></pre>
<pre class="r"><code>dim(df_ave)</code></pre>
<pre><code>[1] 38075     7</code></pre>
<pre class="r"><code># Now, average and error by replicate
# see here for calculating error bar in log scale (https://faculty.washington.edu/stuve/log_error.pdf)
# but here we will not use the method in the link above
# calculate average and error bar for abundance_ratio
# SE calculated with Jake Waldbauer&#39;s method: sqrt(se(Mean_abundance_ratio)^2 +(mean(SD_pep))^2))
# standard error
se &lt;- function(x) sd(x)/sqrt(length(x))
df_ave_rep &lt;- df_ave %&gt;% group_by(Time, Depth, Peptide_id) %&gt;%
  summarize(Ave_abundance_ratio=mean(Mean_abundance_ratio),
            SE_abundance_ratio=sqrt((se(Mean_abundance_ratio))^2 +(mean(SD_pep))^2)) %&gt;% ungroup()
head(df_ave_rep,10)</code></pre>
<pre><code># A tibble: 10 x 5
   Time  Depth Peptide_id Ave_abundance_ratio SE_abundance_ratio
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;              &lt;dbl&gt;
 1 T1    BDCL  Pep_1                   0.0796              0.330
 2 T1    BDCL  Pep_10                 -0.185               0.270
 3 T1    BDCL  Pep_100                 0.214               0.149
 4 T1    BDCL  Pep_1003                0.0789             NA    
 5 T1    BDCL  Pep_1007                0.244              NA    
 6 T1    BDCL  Pep_1008               -0.340              NA    
 7 T1    BDCL  Pep_101                 0.191               0.191
 8 T1    BDCL  Pep_1011                0.253              NA    
 9 T1    BDCL  Pep_1012               -0.267              NA    
10 T1    BDCL  Pep_1014                0.863              NA    </code></pre>
<pre class="r"><code># why is there no sd for Pep_1004?
df_ave %&gt;% group_by(SampleID) %&gt;% filter(Peptide_id==&#39;Pep_1003&#39;) # there is only 1 sample for T1 BDCL </code></pre>
<pre><code># A tibble: 10 x 7
# Groups:   SampleID [10]
   SampleID  Time  Depth Replicate Peptide_id Mean_abundance_ratio   SD_pep
   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;                     &lt;dbl&gt;    &lt;dbl&gt;
 1 BDCL_T1_B T1    BDCL  B         Pep_1003                 0.0789 NA      
 2 BDCL_T7_B T7    BDCL  B         Pep_1003                -0.0795 NA      
 3 DCL_T3_A  T3    DCL   A         Pep_1003                 0.248  NA      
 4 SRF_T1_A  T1    SRF   A         Pep_1003                 0.293   0.125  
 5 SRF_T1_B  T1    SRF   B         Pep_1003                -0.102  NA      
 6 SRF_T2_A  T2    SRF   A         Pep_1003                 0.308  NA      
 7 SRF_T3_A  T3    SRF   A         Pep_1003                 0.288   0.00194
 8 SRF_T3_B  T3    SRF   B         Pep_1003                 0.0473  0.138  
 9 SRF_T4_A  T4    SRF   A         Pep_1003                 0.205   0.0673 
10 SRF_T4_B  T4    SRF   B         Pep_1003                 0.0444  0.196  </code></pre>
<pre class="r"><code>df_ave_rep2 &lt;- df_ave_rep %&gt;% mutate(error_up=Ave_abundance_ratio+SE_abundance_ratio) %&gt;%
  mutate(error_down=Ave_abundance_ratio-SE_abundance_ratio)

head(df_ave_rep2)</code></pre>
<pre><code># A tibble: 6 x 7
  Time  Depth Peptide_id Ave_abundance_rat~ SE_abundance_ra~ error_up error_down
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;            &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
1 T1    BDCL  Pep_1                  0.0796            0.330   0.410     -0.251 
2 T1    BDCL  Pep_10                -0.185             0.270   0.0858    -0.455 
3 T1    BDCL  Pep_100                0.214             0.149   0.363      0.0658
4 T1    BDCL  Pep_1003               0.0789           NA      NA         NA     
5 T1    BDCL  Pep_1007               0.244            NA      NA         NA     
6 T1    BDCL  Pep_1008              -0.340            NA      NA         NA     </code></pre>
<pre class="r"><code># (3) import time metadata and merge
(df_time &lt;- read.table(&#39;data/Time_metadata.txt&#39;, header=T, sep=&#39;\t&#39;))</code></pre>
<pre><code>  timepoint          date_time elapsed_hours
1        T1 6/26/2019 12:45:00             0
2        T2 6/26/2019 15:45:00             3
3        T3 6/26/2019 18:45:00             6
4        T4 6/26/2019 21:45:00             9
5        T5  6/27/2019 4:40:00            15
6        T6  6/27/2019 7:45:00            19
7        T7 6/27/2019 10:45:00            22
8        T8 6/27/2019 13:45:00            25</code></pre>
<pre class="r"><code>df_time$date_time &lt;- str_replace(df_time$date_time, &quot;/2019&quot;,&quot; &quot;)
df_time$date_time &lt;- str_replace(df_time$date_time, &quot;:00$&quot;,&quot;&quot;)

# left_join with average data
df_ave2 &lt;- df_ave_rep2 %&gt;% left_join(df_time, by=c(&#39;Time&#39;=&#39;timepoint&#39;))
head(df_ave2)</code></pre>
<pre><code># A tibble: 6 x 9
  Time  Depth Peptide_id Ave_abundance_rat~ SE_abundance_ra~ error_up error_down
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;            &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
1 T1    BDCL  Pep_1                  0.0796            0.330   0.410     -0.251 
2 T1    BDCL  Pep_10                -0.185             0.270   0.0858    -0.455 
3 T1    BDCL  Pep_100                0.214             0.149   0.363      0.0658
4 T1    BDCL  Pep_1003               0.0789           NA      NA         NA     
5 T1    BDCL  Pep_1007               0.244            NA      NA         NA     
6 T1    BDCL  Pep_1008              -0.340            NA      NA         NA     
# ... with 2 more variables: date_time &lt;chr&gt;, elapsed_hours &lt;int&gt;</code></pre>
<pre class="r"><code># only use peptides that appear 7 or 8 times
df_ave2 %&gt;% select(Peptide_id) %&gt;% unique() %&gt;% dim() # 3233 peptides before</code></pre>
<pre><code>[1] 3366    1</code></pre>
<pre class="r"><code>df_filt78 &lt;- inner_join(df_ave2, df_all2_filt, by=c(&#39;Peptide_id&#39;=&#39;Peptide_id&#39;,&#39;Depth&#39;=&#39;Depth&#39;))

# inspecting if the inner join was successful
head(df_filt78)</code></pre>
<pre><code># A tibble: 6 x 10
  Time  Depth Peptide_id Ave_abundance_rat~ SE_abundance_ra~ error_up error_down
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;            &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
1 T1    BDCL  Pep_1                  0.0796            0.330   0.410   -0.251   
2 T1    BDCL  Pep_10                -0.185             0.270   0.0858  -0.455   
3 T1    BDCL  Pep_100                0.214             0.149   0.363    0.0658  
4 T1    BDCL  Pep_101                0.191             0.191   0.382   -0.000815
5 T1    BDCL  Pep_102                0.272            NA      NA       NA       
6 T1    BDCL  Pep_103                0.478             0.176   0.654    0.302   
# ... with 3 more variables: date_time &lt;chr&gt;, elapsed_hours &lt;int&gt;,
#   Timepoints &lt;int&gt;</code></pre>
<pre class="r"><code>colnames(df_ave2)</code></pre>
<pre><code>[1] &quot;Time&quot;                &quot;Depth&quot;               &quot;Peptide_id&quot;         
[4] &quot;Ave_abundance_ratio&quot; &quot;SE_abundance_ratio&quot;  &quot;error_up&quot;           
[7] &quot;error_down&quot;          &quot;date_time&quot;           &quot;elapsed_hours&quot;      </code></pre>
<pre class="r"><code>colnames(df_time)</code></pre>
<pre><code>[1] &quot;timepoint&quot;     &quot;date_time&quot;     &quot;elapsed_hours&quot;</code></pre>
<pre class="r"><code>colnames(df_filt78)</code></pre>
<pre><code> [1] &quot;Time&quot;                &quot;Depth&quot;               &quot;Peptide_id&quot;         
 [4] &quot;Ave_abundance_ratio&quot; &quot;SE_abundance_ratio&quot;  &quot;error_up&quot;           
 [7] &quot;error_down&quot;          &quot;date_time&quot;           &quot;elapsed_hours&quot;      
[10] &quot;Timepoints&quot;         </code></pre>
<pre class="r"><code>df_filt78 %&gt;% select(Peptide_id) %&gt;% unique() %&gt;% dim() # 841 peptides for peptides in 7 or 8 timepoints</code></pre>
<pre><code>[1] 841   1</code></pre>
<pre class="r"><code>df_filt78$Depth &lt;- factor(df_filt78$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))

# get only 8 ones
df_filt8 &lt;- df_filt78 %&gt;% filter(Timepoints &gt; 7)
df_filt8 %&gt;% select(Peptide_id) %&gt;% unique() %&gt;% dim() # 661 peptides for peptides in all 8 timepoints</code></pre>
<pre><code>[1] 661   1</code></pre>
<pre class="r"><code>df_filt8$Depth &lt;- factor(df_filt8$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))

# get only 7 ones
df_filt7 &lt;- df_filt78 %&gt;% filter(Timepoints == 7)
df_filt7 %&gt;% select(Peptide_id) %&gt;% unique() %&gt;% dim() # 356 peptides for peptides in 7 timepoints</code></pre>
<pre><code>[1] 356   1</code></pre>
<pre class="r"><code>df_filt7$Depth &lt;- factor(df_filt7$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))</code></pre>
<pre class="r"><code># (1) Change our data into list format for input into tsclust
colnames(df_filt8)</code></pre>
<pre><code> [1] &quot;Time&quot;                &quot;Depth&quot;               &quot;Peptide_id&quot;         
 [4] &quot;Ave_abundance_ratio&quot; &quot;SE_abundance_ratio&quot;  &quot;error_up&quot;           
 [7] &quot;error_down&quot;          &quot;date_time&quot;           &quot;elapsed_hours&quot;      
[10] &quot;Timepoints&quot;         </code></pre>
<pre class="r"><code>make_list &lt;- function(df_filt8,depth){
  df_SRF8 &lt;- df_filt8 %&gt;% filter(Depth==depth) %&gt;% select(Peptide_id,Time,Ave_abundance_ratio)
  # reshape the dataframe with timepoints
  library(maditr)
  v_names &lt;- c(&quot;T1&quot;,&quot;T2&quot;,&quot;T3&quot;,&quot;T4&quot;,&quot;T5&quot;,&quot;T6&quot;,&quot;T7&quot;,&quot;T8&quot;)
  df_SRF8$Time &lt;- factor(df_SRF8$Time, levels=v_names)
  dc_SRF8 &lt;- dcast(df_SRF8, Peptide_id ~ Time, value.var = &quot;Ave_abundance_ratio&quot;)
  # make Peptide_id more simpler (Pep_1 -&gt; P.1)
  dc_SRF8$Peptide_id &lt;- str_replace(dc_SRF8$Peptide_id,&quot;Pep_&quot;,&quot;P.&quot;)
  # make first column into row name
  dc_SRF8 &lt;- tibble::column_to_rownames(dc_SRF8, var=&quot;Peptide_id&quot;)
  # make it into list format
  # l_SRF8 &lt;- setNames(split(dc_SRF8, seq(nrow(dc_SRF8))), rownames(dc_SRF8))
  l_SRF8 &lt;- as.list(as.data.frame(t(dc_SRF8)))
  return(l_SRF8)
}

l_SRF8 &lt;- make_list(df_filt8,&#39;SRF&#39;)
l_DCL8 &lt;- make_list(df_filt8,&#39;DCL&#39;)
l_BDCL8 &lt;- make_list(df_filt8,&#39;BDCL&#39;)

l_SRF8_z &lt;- zscore(l_SRF8)</code></pre>
<pre><code>Error in zscore(l_SRF8): could not find function &quot;zscore&quot;</code></pre>
<pre class="r"><code>l_DCL8_z &lt;- zscore(l_DCL8)</code></pre>
<pre><code>Error in zscore(l_DCL8): could not find function &quot;zscore&quot;</code></pre>
<pre class="r"><code>l_BDCL8_z &lt;- zscore(l_BDCL8)</code></pre>
<pre><code>Error in zscore(l_BDCL8): could not find function &quot;zscore&quot;</code></pre>
</div>
<div id="hierarchical-clustering-w-shape-based-distance" class="section level3">
<h3>2. Hierarchical clustering w/ shape based distance</h3>
<pre class="r"><code># input into tsclust
library(dtwclust)
require(&quot;TSclust&quot;)

### Hierarchical clustering w/ shape based distance
hc_sbd &lt;- tsclust(l_SRF8, type = &quot;h&quot;, k = 2L:10L,
  preproc = zscore, seed = 899,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))

internal_CVI &lt;- function(hc_sbd,main){
  names(hc_sbd) &lt;- 2L:10L
  (eval &lt;- sapply(hc_sbd, cvi, type = &quot;internal&quot;))
  # divide CH value with 100 just to plot with other internal CVIs 
  eval[&#39;CH&#39;,] &lt;- eval[&#39;CH&#39;,]/100
  t(eval)
  matplot(x=seq(2,10,by=1),y=t(eval), type = c(&quot;b&quot;),pch=1,col = 1:7,
          xlab=&quot;Number of clusters&quot;,ylab=&quot;Internal CVI (cluster validity index)&quot;,main=main,axes=F) #plot
  axis(2)
  axis(side=1,at=2:10)
  legend(&quot;bottomright&quot;, legend = c(&quot;Sil&quot;,&quot;SF&quot;,&quot;CH/100&quot;,&quot;DB&quot;,&quot;DBstar&quot;,&quot;D&quot;,&quot;COP&quot;), col=1:7, pch=1,cex=0.8) # optional legend
}

internal_CVI(hc_sbd,&quot;Hierarchical clustering w/ shape based distance&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-4-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 4 or 5 or 6 clusters
hc_sbd4 &lt;- tsclust(l_SRF8, type = &quot;h&quot;, k = 4L,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))

hc_sbd5 &lt;- tsclust(l_SRF8, type = &quot;h&quot;, k = 5L,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))

hc_sbd6 &lt;- tsclust(l_SRF8, type = &quot;h&quot;, k = 6L,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))

# cluster dendrogram
plot(hc_sbd4)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-4-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># The series and the obtained prototypes can be plotted too
plot(hc_sbd4, type = &quot;sc&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-4-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Focusing on the first cluster
plot(hc_sbd4, type = &quot;series&quot;, clus = 1L)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-4-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(hc_sbd4, type = &quot;centroids&quot;, clus = 1L)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-4-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># cluster dendrogram
plot(hc_sbd5)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-4-6.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># The series and the obtained prototypes can be plotted too
plot(hc_sbd5, type = &quot;sc&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-4-7.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># cluster dendrogram
plot(hc_sbd6)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-4-8.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># The series and the obtained prototypes can be plotted too
plot(hc_sbd6, type = &quot;sc&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-4-9.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="partial-clustering-methods---dtw" class="section level3">
<h3>3.1. partial clustering methods - DTW</h3>
<pre class="r"><code>### partial clustering methods
# z-normalization
l_SRF8_z &lt;- zscore(l_SRF8)

# DTW distance
pc_dtw &lt;- tsclust(l_SRF8_z, k = 2L:10L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 8L,
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 532 / 1214.679
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
Iteration 2: Changes / Distsum = 48 / 1085.806
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 15 / 1083.017
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 2 / 1082.445
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 5: Changes / Distsum = 0 / 1082.494

Iteration 1: Changes / Distsum = 532 / 1235.579
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
Iteration 2: Changes / Distsum = 97 / 1061.215
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 3: Changes / Distsum = 44 / 1043.463
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
Iteration 4: Changes / Distsum = 9 / 1041.652
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 5: Changes / Distsum = 5 / 1041.612
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 6: Changes / Distsum = 8 / 1041.314
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
Iteration 7: Changes / Distsum = 5 / 1041.763
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 6 / 1041.858
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 9: Changes / Distsum = 7 / 1041.404
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 10: Changes / Distsum = 3 / 1041.383
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 0 / 1041.228

Iteration 1: Changes / Distsum = 532 / 1232.396
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
Iteration 2: Changes / Distsum = 170 / 1034.028
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
Iteration 3: Changes / Distsum = 81 / 999.1841
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
Iteration 4: Changes / Distsum = 41 / 985.0683
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 25 / 980.7371
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
Iteration 6: Changes / Distsum = 21 / 979.7708
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 7: Changes / Distsum = 19 / 979.2376
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
Iteration 8: Changes / Distsum = 14 / 977.6997
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 9: Changes / Distsum = 20 / 971.434
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 10: Changes / Distsum = 8 / 970.7558
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 7 / 970.5809
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum = 4 / 970.1304
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 13: Changes / Distsum = 2 / 969.9946
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum = 2 / 970.0759
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 15: Changes / Distsum = 3 / 969.9814
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 16: Changes / Distsum =  1 / 969.694
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 17: Changes / Distsum =  1 / 969.526
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 18: Changes / Distsum = 0 / 969.3254

Iteration 1: Changes / Distsum = 532 / 1151.813
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19 - Converged!
Iteration 2: Changes / Distsum = 144 / 1000.64
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 3: Changes / Distsum = 94 / 969.0625
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 4: Changes / Distsum = 54 / 955.1176
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 31 / 946.9429
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
Iteration 6: Changes / Distsum = 16 / 944.7161
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 18 / 943.1374
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 8: Changes / Distsum = 16 / 941.573
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 15 / 940.4903
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 9 / 939.6274
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 11: Changes / Distsum = 13 / 939.2089
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 12: Changes / Distsum = 11 / 938.6039
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
Iteration 13: Changes / Distsum = 25 / 934.9694
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 14: Changes / Distsum = 14 / 934.0234
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 15: Changes / Distsum = 10 / 933.4718
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 16: Changes / Distsum = 5 / 933.3492
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 17: Changes / Distsum =  1 / 933.453
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 18: Changes / Distsum = 0 / 933.4545

Iteration 1: Changes / Distsum = 532 / 1081.412
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 2: Changes / Distsum = 150 / 966.9098
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 3: Changes / Distsum = 60 / 946.3859
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 51 / 937.2223
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 37 / 931.8805
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 17 / 930.7812
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 7: Changes / Distsum = 12 / 929.8785
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 5 / 929.6228
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 9: Changes / Distsum = 2 / 929.3797
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 3 / 929.1132
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 3 / 929.0612
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum =  4 / 928.816
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 5 / 928.4278
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum = 9 / 928.2142
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 15: Changes / Distsum = 11 / 927.7428
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 16: Changes / Distsum =  9 / 927.587
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 17: Changes / Distsum = 11 / 927.6354
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 18: Changes / Distsum = 7 / 927.2812
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 19: Changes / Distsum = 3 / 927.3717
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 20: Changes / Distsum = 8 / 927.1906
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 21: Changes / Distsum = 3 / 927.1205
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 22: Changes / Distsum =  0 / 926.934

Iteration 1: Changes / Distsum = 532 / 1057.127
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 2: Changes / Distsum = 134 / 950.3135
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 78 / 927.9988
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 4: Changes / Distsum = 52 / 914.275
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 5: Changes / Distsum = 35 / 908.6606
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 6: Changes / Distsum = 18 / 907.0194
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 13 / 906.379
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 9 / 906.4386
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 8 / 906.2982
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 6 / 905.8474
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 6 / 905.7696
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
Iteration 12: Changes / Distsum = 2 / 905.7997
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 1 / 905.8556
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum = 0 / 905.8105

Iteration 1: Changes / Distsum = 532 / 1010.016
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
Iteration 2: Changes / Distsum = 105 / 907.3174
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20 - Converged!
Iteration 3: Changes / Distsum = 54 / 892.6393
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 4: Changes / Distsum = 42 / 884.6915
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 5: Changes / Distsum = 19 / 879.2494
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
Iteration 6: Changes / Distsum = 15 / 878.033
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
Iteration 7: Changes / Distsum = 11 / 876.8902
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 8: Changes / Distsum = 8 / 876.5469
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 9: Changes / Distsum = 9 / 876.1131
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 7 / 875.5836
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 11: Changes / Distsum = 4 / 874.9549
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum = 4 / 875.0247
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 13: Changes / Distsum = 1 / 874.7495
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 14: Changes / Distsum = 2 / 874.8087
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum = 0 / 874.8049

Iteration 1: Changes / Distsum = 532 / 1003.176
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 2: Changes / Distsum = 95 / 893.7058
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 55 / 881.7159
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 37 / 875.3398
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
Iteration 5: Changes / Distsum = 26 / 872.1637
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum =  21 / 869.39
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 18 / 867.4931
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 10 / 866.918
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 8 / 866.2375
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 4 / 866.1905
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 11: Changes / Distsum = 2 / 866.0823
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum = 2 / 865.9632
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 13: Changes / Distsum = 3 / 865.8644
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum = 2 / 865.7537
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 15: Changes / Distsum = 3 / 865.6689
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 16: Changes / Distsum = 4 / 865.3888
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 17: Changes / Distsum = 3 / 865.2711
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 18: Changes / Distsum = 1 / 865.3401
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 19: Changes / Distsum = 1 / 865.3802
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 20: Changes / Distsum = 1 / 865.3832
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 21: Changes / Distsum = 0 / 865.3372

Iteration 1: Changes / Distsum = 532 / 977.4373
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 2: Changes / Distsum = 116 / 883.6319
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 3: Changes / Distsum = 60 / 868.8152
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 4: Changes / Distsum = 36 / 861.1171
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 5: Changes / Distsum = 23 / 856.8175
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 6: Changes / Distsum = 15 / 854.4633
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 6 / 853.0239
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 2 / 852.6894
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 3 / 852.4384
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 1 / 852.4908
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 0 / 852.5162

    Elapsed time is 2.65 seconds.</code></pre>
<pre class="r"><code>internal_CVI(pc_dtw, &quot;Partial clustering with DTW distance&quot;)</code></pre>
<pre><code>    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-5-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 2, 3, 4 clusters

pc_dtw2 &lt;- tsclust(l_SRF8_z, k = 2L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 8L,
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 532 / 1214.679
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
Iteration 2: Changes / Distsum = 48 / 1085.806
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 15 / 1083.017
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 2 / 1082.445
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 5: Changes / Distsum = 0 / 1082.494

    Elapsed time is 0.09 seconds.</code></pre>
<pre class="r"><code>pc_dtw3 &lt;- tsclust(l_SRF8_z, k = 3L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 8L,
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 532 / 1153.271
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
Iteration 2: Changes / Distsum = 65 / 1023.602
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 33 / 1017.11
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 4: Changes / Distsum = 16 / 1013.939
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 5: Changes / Distsum = 14 / 1012.746
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 14 / 1011.294
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 13 / 1009.94
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 8: Changes / Distsum = 9 / 1008.903
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 3 / 1008.987
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 10: Changes / Distsum =  4 / 1008.97
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 6 / 1008.708
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 12: Changes / Distsum = 4 / 1008.798
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 13: Changes / Distsum = 1 / 1008.683
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 14: Changes / Distsum = 2 / 1008.664
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum = 0 / 1008.677

    Elapsed time is 0.32 seconds.</code></pre>
<pre class="r"><code>pc_dtw4 &lt;- tsclust(l_SRF8_z, k = 4L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 8L,
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 532 / 1116.358
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 2: Changes / Distsum = 83 / 997.8015
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 37 / 991.8741
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 4: Changes / Distsum = 26 / 988.2049
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 5: Changes / Distsum = 27 / 984.379
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 6: Changes / Distsum = 21 / 982.3666
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 19 / 980.3382
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 15 / 976.7316
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 9: Changes / Distsum = 11 / 975.2326
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 10: Changes / Distsum = 10 / 975.0064
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 3 / 975.0927
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 12: Changes / Distsum = 3 / 975.1718
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 13: Changes / Distsum = 1 / 975.1722
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 14: Changes / Distsum =  0 / 975.141

    Elapsed time is 0.29 seconds.</code></pre>
<pre class="r"><code># Prototypes for 2 clusters
plot(pc_dtw2)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-5-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(pc_dtw2, type = &quot;centroids&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-5-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for 3 clusters
plot(pc_dtw3)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-5-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(pc_dtw3, type = &quot;centroids&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-5-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for 4 clusters
plot(pc_dtw4)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-5-6.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(pc_dtw4, type = &quot;centroids&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-5-7.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="partial-clustering-methods---dtw_lb" class="section level3">
<h3>3.2. partial clustering methods - DTW_lb</h3>
<p>cross-distance matrix is NOT symmetric, which can be problematic for</p>
<pre class="r"><code># DTW_lb distance method
pc_dtwlb &lt;- tsclust(l_SRF8_z, k = 2L:10L,
  distance = &quot;dtw_lb&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 4L,
  control = partitional_control(pam.precompute = FALSE),
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 532 / 1214.759
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
Iteration 2: Changes / Distsum =    49 / 1086
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 14 / 1083.662
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 3 / 1082.905
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 5: Changes / Distsum =     3 / 1083
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 2 / 1083.219
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 0 / 1083.091

Iteration 1: Changes / Distsum = 532 / 1235.879
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
Iteration 2: Changes / Distsum = 90 / 1061.286
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 3: Changes / Distsum = 48 / 1041.185
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 10 / 1038.69
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 5 / 1038.282
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 6: Changes / Distsum = 4 / 1038.285
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 0 / 1038.501

Iteration 1: Changes / Distsum = 532 / 1232.917
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
Iteration 2: Changes / Distsum = 159 / 1036.756
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
Iteration 3: Changes / Distsum = 87 / 1005.51
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 4: Changes / Distsum = 54 / 990.5814
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 5: Changes / Distsum = 32 / 982.7197
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 6: Changes / Distsum = 18 / 983.3779
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 23 / 978.197
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 9 / 976.8768
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 5 / 976.9138
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 5 / 976.9903
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 10 / 977.067
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum = 13 / 976.5439
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 17 / 976.3333
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum = 14 / 975.8159
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum = 16 / 975.4872
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 16: Changes / Distsum = 14 / 975.5778
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 17: Changes / Distsum = 14 / 974.995
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 18: Changes / Distsum = 13 / 974.9792
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 19: Changes / Distsum = 15 / 974.4768
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 20: Changes / Distsum = 13 / 973.539
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 21: Changes / Distsum = 22 / 969.0719
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 22: Changes / Distsum = 16 / 967.0777
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 23: Changes / Distsum = 13 / 965.8193
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 24: Changes / Distsum = 7 / 964.6379
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 25: Changes / Distsum = 9 / 964.2667
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
Iteration 26: Changes / Distsum = 8 / 964.3926
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 27: Changes / Distsum = 6 / 964.1947
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 28: Changes / Distsum = 4 / 964.2221
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 29: Changes / Distsum = 1 / 964.2858
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 30: Changes / Distsum = 0 / 964.3179

Iteration 1: Changes / Distsum = 532 / 1151.851
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19 - Converged!
Iteration 2: Changes / Distsum = 143 / 1001.098
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 3: Changes / Distsum = 89 / 970.8782
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 4: Changes / Distsum = 60 / 953.8755
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
Iteration 5: Changes / Distsum = 23 / 947.3524
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 16 / 945.5868
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 7: Changes / Distsum = 17 / 943.9976
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 14 / 942.2577
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 6 / 942.3825
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 9 / 942.4787
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 12 / 942.7277
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 12: Changes / Distsum =   12 / 942.9
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 13: Changes / Distsum = 10 / 942.258
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum = 14 / 941.7284
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
Iteration 15: Changes / Distsum = 15 / 940.6101
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 16: Changes / Distsum = 21 / 939.4608
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 17: Changes / Distsum = 15 / 938.6738
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 18: Changes / Distsum =  5 / 937.948
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 19: Changes / Distsum = 3 / 937.6398
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 20: Changes / Distsum = 1 / 937.2233
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 21: Changes / Distsum = 0 / 937.1146

Iteration 1: Changes / Distsum = 532 / 1081.475
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 2: Changes / Distsum = 150 / 966.9228
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 3: Changes / Distsum = 58 / 946.1319
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 50 / 936.8198
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 40 / 931.7741
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 6: Changes / Distsum = 16 / 930.8478
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 15 / 930.4147
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 11 / 929.5864
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 9: Changes / Distsum =  3 / 929.722
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 0 / 929.8999

Iteration 1: Changes / Distsum = 532 / 1057.373
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 2: Changes / Distsum = 128 / 950.3321
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 79 / 928.507
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 4: Changes / Distsum = 51 / 915.8251
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 5: Changes / Distsum = 26 / 910.9103
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 18 / 910.1965
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 20 / 909.528
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 16 / 908.7944
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 9: Changes / Distsum = 9 / 908.0541
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 9 / 907.7321
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 5 / 907.6193
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 12: Changes / Distsum = 8 / 907.5712
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 13: Changes / Distsum = 2 / 907.5884
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 14: Changes / Distsum = 1 / 907.6427
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 15: Changes / Distsum = 0 / 907.6374

Iteration 1: Changes / Distsum = 532 / 1010.112
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 2: Changes / Distsum = 107 / 908.7569
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
Iteration 3: Changes / Distsum = 59 / 893.1217
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 38 / 886.4944
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 30 / 880.2442
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 6: Changes / Distsum = 13 / 879.0363
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 7: Changes / Distsum = 15 / 878.3966
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 8: Changes / Distsum = 12 / 877.3024
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
Iteration 9: Changes / Distsum = 16 / 876.3601
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
Iteration 10: Changes / Distsum = 10 / 876.1527
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 11 / 875.3312
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum = 7 / 874.6221
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 1 / 874.4684
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum = 0 / 874.5118

Iteration 1: Changes / Distsum = 532 / 1003.261
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 2: Changes / Distsum = 95 / 893.7367
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 56 / 881.633
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 37 / 875.2796
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
Iteration 5: Changes / Distsum = 29 / 872.1203
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
Iteration 6: Changes / Distsum =  21 / 869.86
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 14 / 867.7827
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 6 / 867.1204
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 7 / 866.5261
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 10: Changes / Distsum = 5 / 866.4465
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 4 / 866.2174
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 12: Changes / Distsum = 4 / 866.0571
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 13: Changes / Distsum = 3 / 865.9587
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 14: Changes / Distsum = 3 / 865.8476
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 15: Changes / Distsum = 7 / 865.4354
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 16: Changes / Distsum = 6 / 864.8884
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 17: Changes / Distsum = 7 / 864.1353
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 18: Changes / Distsum = 4 / 863.5688
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 19: Changes / Distsum =  5 / 863.307
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 20: Changes / Distsum = 4 / 862.8939
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 21: Changes / Distsum = 4 / 862.5957
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 22: Changes / Distsum =  6 / 862.343
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 23: Changes / Distsum = 8 / 861.5483
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 24: Changes / Distsum = 6 / 860.9799
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 25: Changes / Distsum = 9 / 860.3182
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 26: Changes / Distsum = 5 / 859.6218
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 27: Changes / Distsum = 1 / 859.5693
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 28: Changes / Distsum =  1 / 859.529
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 29: Changes / Distsum = 4 / 859.2536
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 30: Changes / Distsum = 5 / 859.1027
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 31: Changes / Distsum = 7 / 858.2774
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 32: Changes / Distsum = 8 / 856.9206
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 33: Changes / Distsum = 5 / 856.3688
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 34: Changes / Distsum = 2 / 856.0819
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 35: Changes / Distsum = 5 / 855.8305
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 36: Changes / Distsum = 5 / 855.5911
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 37: Changes / Distsum = 9 / 854.9278
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 38: Changes / Distsum = 10 / 854.5173
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 39: Changes / Distsum = 6 / 853.7404
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 40: Changes / Distsum =  3 / 853.749
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 41: Changes / Distsum = 1 / 853.8307
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 42: Changes / Distsum = 1 / 853.8877
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 43: Changes / Distsum = 0 / 853.8072

Iteration 1: Changes / Distsum = 532 / 977.9135
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 2: Changes / Distsum = 116 / 884.0352
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 3: Changes / Distsum = 62 / 869.097
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 37 / 861.2205
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 5: Changes / Distsum = 25 / 856.3187
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 18 / 853.2315
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 9 / 851.5493
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum =   8 / 850.88
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 9: Changes / Distsum = 3 / 850.6951
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 10: Changes / Distsum = 2 / 850.4027
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 2 / 850.2196
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 12: Changes / Distsum = 0 / 850.3005

    Elapsed time is 3.78 seconds.</code></pre>
<pre class="r"><code>internal_CVI(pc_dtwlb, &quot;Partial clustering with DTW_lb distance&quot;)</code></pre>
<pre><code>    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-6-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 8 clusters
pc_dtwlb8 &lt;- tsclust(l_SRF8_z, k = 8L,
  distance = &quot;dtw_lb&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 4L,
  control = partitional_control(pam.precompute = FALSE),
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 532 / 1031.335
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 2: Changes / Distsum = 117 / 922.8339
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
Iteration 3: Changes / Distsum = 59 / 908.1942
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 4: Changes / Distsum = 42 / 902.1996
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 5: Changes / Distsum = 35 / 897.5738
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
Iteration 6: Changes / Distsum = 28 / 893.7395
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 28 / 890.4848
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 8: Changes / Distsum = 29 / 884.9613
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 18 / 881.423
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 19 / 878.9053
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 11 / 877.1528
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 12: Changes / Distsum = 21 / 875.3902
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 15 / 873.3985
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 14: Changes / Distsum = 4 / 872.7913
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 15: Changes / Distsum = 1 / 872.6045
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 16: Changes / Distsum = 0 / 872.5455

    Elapsed time is 0.41 seconds.</code></pre>
<pre class="r"><code># Prototypes for 8 clusters
plot(pc_dtwlb8)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-6-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(pc_dtwlb8, type = &quot;centroids&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-6-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 4 clusters
pc_dtwlb4 &lt;- tsclust(l_SRF8_z, k = 4L,
  distance = &quot;dtw_lb&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 4L,
  control = partitional_control(pam.precompute = FALSE),
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 532 / 1116.438
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 2: Changes / Distsum = 83 / 997.806
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 38 / 991.7388
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 4: Changes / Distsum = 26 / 988.3643
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 21 / 984.5473
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 11 / 982.8083
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 8 / 982.5938
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 17 / 980.7592
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 19 / 978.5101
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 18 / 977.363
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
Iteration 11: Changes / Distsum = 11 / 975.4673
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum = 10 / 975.2812
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 13: Changes / Distsum = 6 / 975.0369
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 14: Changes / Distsum = 4 / 974.7606
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 15: Changes / Distsum = 3 / 974.7458
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 16: Changes / Distsum = 4 / 974.7241
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 17: Changes / Distsum =  3 / 974.733
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 18: Changes / Distsum = 3 / 974.6039
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 19: Changes / Distsum = 3 / 974.4519
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 20: Changes / Distsum = 7 / 974.1536
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 21: Changes / Distsum = 9 / 973.9265
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 22: Changes / Distsum = 9 / 973.5566
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 23: Changes / Distsum = 6 / 973.6772
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 24: Changes / Distsum = 2 / 973.7075
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 25: Changes / Distsum = 3 / 973.5997
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 26: Changes / Distsum = 6 / 973.4879
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 27: Changes / Distsum = 3 / 973.5668
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 28: Changes / Distsum = 3 / 973.4351
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 29: Changes / Distsum = 2 / 973.6114
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 30: Changes / Distsum = 2 / 973.7113
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 31: Changes / Distsum = 2 / 973.6766
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 32: Changes / Distsum = 0 / 973.5983

    Elapsed time is 0.68 seconds.</code></pre>
<pre class="r"><code># Prototypes for 8 clusters
plot(pc_dtwlb4)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-6-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(pc_dtwlb4, type = &quot;centroids&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-6-5.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="partial-clustering-methods---k-shape" class="section level3">
<h3>3.3. partial clustering methods - k-shape</h3>
<pre class="r"><code># k-shape method
pc_ks &lt;- tsclust(l_SRF8_z, k = 2L:10L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 532 / 200.3958
Iteration 2: Changes / Distsum = 60 / 191.2659
Iteration 3: Changes / Distsum = 47 / 186.8754
Iteration 4: Changes / Distsum = 37 / 183.3642
Iteration 5: Changes / Distsum = 26 / 181.0874
Iteration 6: Changes / Distsum = 23 / 179.4481
Iteration 7: Changes / Distsum = 25 / 178.2472
Iteration 8: Changes / Distsum = 21 / 176.9136
Iteration 9: Changes / Distsum = 24 / 175.4498
Iteration 10: Changes / Distsum = 19 / 174.5458
Iteration 11: Changes / Distsum = 18 / 174.0191
Iteration 12: Changes / Distsum = 20 / 173.4992
Iteration 13: Changes / Distsum = 11 / 172.9733
Iteration 14: Changes / Distsum =  8 / 172.748
Iteration 15: Changes / Distsum = 4 / 172.6375
Iteration 16: Changes / Distsum = 3 / 172.6044
Iteration 17: Changes / Distsum = 1 / 172.5919
Iteration 18: Changes / Distsum = 2 / 172.5772
Iteration 19: Changes / Distsum = 4 / 172.5742
Iteration 20: Changes / Distsum = 3 / 172.5574
Iteration 21: Changes / Distsum = 3 / 172.5346
Iteration 22: Changes / Distsum = 3 / 172.4919
Iteration 23: Changes / Distsum = 3 / 172.4528
Iteration 24: Changes / Distsum = 5 / 172.3744
Iteration 25: Changes / Distsum = 0 / 172.3513

Iteration 1: Changes / Distsum = 532 / 195.2288
Iteration 2: Changes / Distsum = 106 / 169.2473
Iteration 3: Changes / Distsum = 69 / 159.5856
Iteration 4: Changes / Distsum = 31 / 156.3785
Iteration 5: Changes / Distsum = 25 / 155.1618
Iteration 6: Changes / Distsum = 25 / 154.421
Iteration 7: Changes / Distsum = 16 / 153.9445
Iteration 8: Changes / Distsum = 10 / 153.7679
Iteration 9: Changes / Distsum = 14 / 153.642
Iteration 10: Changes / Distsum = 9 / 153.4987
Iteration 11: Changes / Distsum = 2 / 153.3306
Iteration 12: Changes / Distsum = 3 / 153.2626
Iteration 13: Changes / Distsum = 5 / 153.2312
Iteration 14: Changes / Distsum = 2 / 153.2283
Iteration 15: Changes / Distsum = 0 / 153.1973

Iteration 1: Changes / Distsum = 532 / 163.2131
Iteration 2: Changes / Distsum = 92 / 146.197
Iteration 3: Changes / Distsum = 49 / 142.3416
Iteration 4: Changes / Distsum = 26 / 140.9477
Iteration 5: Changes / Distsum = 18 / 140.1709
Iteration 6: Changes / Distsum = 11 / 139.7486
Iteration 7: Changes / Distsum = 10 / 139.514
Iteration 8: Changes / Distsum = 9 / 139.3023
Iteration 9: Changes / Distsum = 9 / 139.1652
Iteration 10: Changes / Distsum = 14 / 138.9545
Iteration 11: Changes / Distsum = 8 / 138.7627
Iteration 12: Changes / Distsum = 5 / 138.6935
Iteration 13: Changes / Distsum = 7 / 138.6314
Iteration 14: Changes / Distsum = 11 / 138.4481
Iteration 15: Changes / Distsum = 8 / 138.2228
Iteration 16: Changes / Distsum = 9 / 138.0754
Iteration 17: Changes / Distsum = 6 / 137.9138
Iteration 18: Changes / Distsum = 10 / 137.804
Iteration 19: Changes / Distsum = 13 / 137.5738
Iteration 20: Changes / Distsum = 10 / 137.3561
Iteration 21: Changes / Distsum = 14 / 137.1937
Iteration 22: Changes / Distsum = 5 / 136.9419
Iteration 23: Changes / Distsum = 4 / 136.8824
Iteration 24: Changes / Distsum = 3 / 136.8185
Iteration 25: Changes / Distsum = 2 / 136.8116
Iteration 26: Changes / Distsum = 0 / 136.7898

Iteration 1: Changes / Distsum = 532 / 161.8126
Iteration 2: Changes / Distsum = 80 / 145.7379
Iteration 3: Changes / Distsum = 75 / 139.3602
Iteration 4: Changes / Distsum = 54 / 135.1924
Iteration 5: Changes / Distsum = 47 / 133.0846
Iteration 6: Changes / Distsum = 28 / 131.7007
Iteration 7: Changes / Distsum = 22 / 130.9028
Iteration 8: Changes / Distsum = 22 / 130.4237
Iteration 9: Changes / Distsum = 20 / 129.8521
Iteration 10: Changes / Distsum = 14 / 129.4297
Iteration 11: Changes / Distsum = 12 / 129.1787
Iteration 12: Changes / Distsum = 7 / 129.0634
Iteration 13: Changes / Distsum = 4 / 128.9815
Iteration 14: Changes / Distsum = 1 / 128.9449
Iteration 15: Changes / Distsum = 5 / 128.9324
Iteration 16: Changes / Distsum = 5 / 128.8996
Iteration 17: Changes / Distsum = 5 / 128.8585
Iteration 18: Changes / Distsum = 7 / 128.8335
Iteration 19: Changes / Distsum = 11 / 128.6776
Iteration 20: Changes / Distsum = 12 / 128.4849
Iteration 21: Changes / Distsum = 10 / 128.2216
Iteration 22: Changes / Distsum = 10 / 127.9911
Iteration 23: Changes / Distsum =   6 / 127.85
Iteration 24: Changes / Distsum = 2 / 127.8393
Iteration 25: Changes / Distsum = 0 / 127.8528

Iteration 1: Changes / Distsum = 532 / 164.5055
Iteration 2: Changes / Distsum = 131 / 142.9439
Iteration 3: Changes / Distsum = 73 / 135.6312
Iteration 4: Changes / Distsum = 35 / 132.8678
Iteration 5: Changes / Distsum = 24 / 131.6971
Iteration 6: Changes / Distsum = 24 / 130.6279
Iteration 7: Changes / Distsum = 25 / 129.5029
Iteration 8: Changes / Distsum =  29 / 128.57
Iteration 9: Changes / Distsum = 30 / 127.3249
Iteration 10: Changes / Distsum = 27 / 126.1351
Iteration 11: Changes / Distsum = 20 / 125.3845
Iteration 12: Changes / Distsum = 13 / 125.1321
Iteration 13: Changes / Distsum = 11 / 124.9473
Iteration 14: Changes / Distsum = 12 / 124.662
Iteration 15: Changes / Distsum = 16 / 124.3704
Iteration 16: Changes / Distsum = 24 / 123.7256
Iteration 17: Changes / Distsum = 21 / 122.7829
Iteration 18: Changes / Distsum = 21 / 122.183
Iteration 19: Changes / Distsum = 14 / 121.7339
Iteration 20: Changes / Distsum = 8 / 121.4302
Iteration 21: Changes / Distsum = 9 / 121.2604
Iteration 22: Changes / Distsum = 11 / 121.0055
Iteration 23: Changes / Distsum = 9 / 120.7443
Iteration 24: Changes / Distsum = 4 / 120.6106
Iteration 25: Changes / Distsum = 1 / 120.5538
Iteration 26: Changes / Distsum = 0 / 120.5451

Iteration 1: Changes / Distsum = 532 / 153.8151
Iteration 2: Changes / Distsum = 122 / 128.459
Iteration 3: Changes / Distsum = 56 / 123.0718
Iteration 4: Changes / Distsum = 35 / 121.2718
Iteration 5: Changes / Distsum = 18 / 120.3717
Iteration 6: Changes / Distsum = 13 / 119.9752
Iteration 7: Changes / Distsum = 11 / 119.7874
Iteration 8: Changes / Distsum = 6 / 119.6583
Iteration 9: Changes / Distsum = 5 / 119.6055
Iteration 10: Changes / Distsum = 3 / 119.5617
Iteration 11: Changes / Distsum = 3 / 119.5283
Iteration 12: Changes / Distsum = 8 / 119.4848
Iteration 13: Changes / Distsum = 6 / 119.3921
Iteration 14: Changes / Distsum =  2 / 119.348
Iteration 15: Changes / Distsum = 2 / 119.3458
Iteration 16: Changes / Distsum = 1 / 119.3316
Iteration 17: Changes / Distsum = 3 / 119.3357
Iteration 18: Changes / Distsum = 2 / 119.3226
Iteration 19: Changes / Distsum = 4 / 119.2924
Iteration 20: Changes / Distsum = 4 / 119.2359
Iteration 21: Changes / Distsum = 7 / 119.1573
Iteration 22: Changes / Distsum = 13 / 118.7887
Iteration 23: Changes / Distsum = 16 / 118.2722
Iteration 24: Changes / Distsum = 18 / 117.8188
Iteration 25: Changes / Distsum = 22 / 117.2769
Iteration 26: Changes / Distsum = 19 / 116.7408
Iteration 27: Changes / Distsum = 12 / 116.403
Iteration 28: Changes / Distsum = 8 / 116.2711
Iteration 29: Changes / Distsum = 6 / 116.1716
Iteration 30: Changes / Distsum = 6 / 116.0869
Iteration 31: Changes / Distsum = 1 / 116.0484
Iteration 32: Changes / Distsum = 1 / 116.0417
Iteration 33: Changes / Distsum =  6 / 116.003
Iteration 34: Changes / Distsum = 7 / 115.8831
Iteration 35: Changes / Distsum = 6 / 115.7699
Iteration 36: Changes / Distsum = 7 / 115.6887
Iteration 37: Changes / Distsum = 3 / 115.6174
Iteration 38: Changes / Distsum = 1 / 115.6089
Iteration 39: Changes / Distsum = 2 / 115.6073
Iteration 40: Changes / Distsum = 1 / 115.5808
Iteration 41: Changes / Distsum = 0 / 115.5552

Iteration 1: Changes / Distsum = 532 / 144.6013
Iteration 2: Changes / Distsum = 112 / 125.3734
Iteration 3: Changes / Distsum = 59 / 120.6981
Iteration 4: Changes / Distsum = 41 / 118.6724
Iteration 5: Changes / Distsum = 36 / 117.2343
Iteration 6: Changes / Distsum = 30 / 115.9871
Iteration 7: Changes / Distsum =  23 / 115.15
Iteration 8: Changes / Distsum = 23 / 114.5317
Iteration 9: Changes / Distsum = 18 / 114.0379
Iteration 10: Changes / Distsum = 8 / 113.7137
Iteration 11: Changes / Distsum = 6 / 113.6242
Iteration 12: Changes / Distsum = 5 / 113.5597
Iteration 13: Changes / Distsum = 7 / 113.4534
Iteration 14: Changes / Distsum = 2 / 113.3933
Iteration 15: Changes / Distsum = 3 / 113.3608
Iteration 16: Changes / Distsum =  2 / 113.327
Iteration 17: Changes / Distsum = 2 / 113.3139
Iteration 18: Changes / Distsum =  2 / 113.287
Iteration 19: Changes / Distsum = 2 / 113.2578
Iteration 20: Changes / Distsum = 1 / 113.2422
Iteration 21: Changes / Distsum = 0 / 113.2261

Iteration 1: Changes / Distsum = 532 / 138.4382
Iteration 2: Changes / Distsum = 127 / 121.6014
Iteration 3: Changes / Distsum = 63 / 116.3618
Iteration 4: Changes / Distsum = 46 / 114.0432
Iteration 5: Changes / Distsum = 37 / 112.3038
Iteration 6: Changes / Distsum = 23 / 111.3467
Iteration 7: Changes / Distsum = 18 / 110.7779
Iteration 8: Changes / Distsum = 11 / 110.5307
Iteration 9: Changes / Distsum =  8 / 110.363
Iteration 10: Changes / Distsum = 8 / 110.2585
Iteration 11: Changes / Distsum = 5 / 110.1537
Iteration 12: Changes / Distsum = 3 / 110.0985
Iteration 13: Changes / Distsum = 1 / 110.0649
Iteration 14: Changes / Distsum = 0 / 110.0535

Iteration 1: Changes / Distsum = 532 / 132.1546
Iteration 2: Changes / Distsum = 108 / 120.0351
Iteration 3: Changes / Distsum = 74 / 114.3476
Iteration 4: Changes / Distsum = 41 / 111.5655
Iteration 5: Changes / Distsum = 35 / 109.941
Iteration 6: Changes / Distsum = 22 / 109.0309
Iteration 7: Changes / Distsum = 24 / 108.3271
Iteration 8: Changes / Distsum = 17 / 107.8601
Iteration 9: Changes / Distsum = 10 / 107.5842
Iteration 10: Changes / Distsum = 9 / 107.4497
Iteration 11: Changes / Distsum = 10 / 107.3616
Iteration 12: Changes / Distsum = 6 / 107.3051
Iteration 13: Changes / Distsum =  5 / 107.268
Iteration 14: Changes / Distsum = 6 / 107.2178
Iteration 15: Changes / Distsum = 7 / 107.1181
Iteration 16: Changes / Distsum = 4 / 107.0108
Iteration 17: Changes / Distsum = 7 / 106.9543
Iteration 18: Changes / Distsum = 2 / 106.8461
Iteration 19: Changes / Distsum = 2 / 106.8266
Iteration 20: Changes / Distsum =  2 / 106.808
Iteration 21: Changes / Distsum = 1 / 106.7852
Iteration 22: Changes / Distsum = 1 / 106.7672
Iteration 23: Changes / Distsum = 0 / 106.7618

    Elapsed time is 11.31 seconds.</code></pre>
<pre class="r"><code>internal_CVI(pc_ks, &quot;Partial clustering with k-shape method&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-7-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 2, 3, or 4 clusters
pc_ks2 &lt;- tsclust(l_SRF8_z, k = 2L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 532 / 200.3958
Iteration 2: Changes / Distsum = 60 / 191.2659
Iteration 3: Changes / Distsum = 47 / 186.8754
Iteration 4: Changes / Distsum = 37 / 183.3642
Iteration 5: Changes / Distsum = 26 / 181.0874
Iteration 6: Changes / Distsum = 23 / 179.4481
Iteration 7: Changes / Distsum = 25 / 178.2472
Iteration 8: Changes / Distsum = 21 / 176.9136
Iteration 9: Changes / Distsum = 24 / 175.4498
Iteration 10: Changes / Distsum = 19 / 174.5458
Iteration 11: Changes / Distsum = 18 / 174.0191
Iteration 12: Changes / Distsum = 20 / 173.4992
Iteration 13: Changes / Distsum = 11 / 172.9733
Iteration 14: Changes / Distsum =  8 / 172.748
Iteration 15: Changes / Distsum = 4 / 172.6375
Iteration 16: Changes / Distsum = 3 / 172.6044
Iteration 17: Changes / Distsum = 1 / 172.5919
Iteration 18: Changes / Distsum = 2 / 172.5772
Iteration 19: Changes / Distsum = 4 / 172.5742
Iteration 20: Changes / Distsum = 3 / 172.5574
Iteration 21: Changes / Distsum = 3 / 172.5346
Iteration 22: Changes / Distsum = 3 / 172.4919
Iteration 23: Changes / Distsum = 3 / 172.4528
Iteration 24: Changes / Distsum = 5 / 172.3744
Iteration 25: Changes / Distsum = 0 / 172.3513

    Elapsed time is 1.41 seconds.</code></pre>
<pre class="r"><code>pc_ks3 &lt;- tsclust(l_SRF8_z, k = 3L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 532 / 187.9674
Iteration 2: Changes / Distsum = 89 / 173.4365
Iteration 3: Changes / Distsum = 59 / 166.4354
Iteration 4: Changes / Distsum = 45 / 162.5429
Iteration 5: Changes / Distsum = 44 / 160.2387
Iteration 6: Changes / Distsum = 24 / 158.8933
Iteration 7: Changes / Distsum = 29 / 158.196
Iteration 8: Changes / Distsum = 20 / 157.4393
Iteration 9: Changes / Distsum = 21 / 156.6075
Iteration 10: Changes / Distsum = 11 / 156.2094
Iteration 11: Changes / Distsum = 6 / 156.0933
Iteration 12: Changes / Distsum = 7 / 156.0493
Iteration 13: Changes / Distsum = 6 / 155.9435
Iteration 14: Changes / Distsum = 9 / 155.8207
Iteration 15: Changes / Distsum = 10 / 155.644
Iteration 16: Changes / Distsum = 10 / 155.4027
Iteration 17: Changes / Distsum = 11 / 155.224
Iteration 18: Changes / Distsum = 19 / 154.9539
Iteration 19: Changes / Distsum = 18 / 154.3203
Iteration 20: Changes / Distsum = 20 / 153.7558
Iteration 21: Changes / Distsum = 23 / 153.1354
Iteration 22: Changes / Distsum = 19 / 152.4885
Iteration 23: Changes / Distsum = 15 / 152.1055
Iteration 24: Changes / Distsum = 13 / 151.8892
Iteration 25: Changes / Distsum = 9 / 151.7227
Iteration 26: Changes / Distsum = 9 / 151.6133
Iteration 27: Changes / Distsum = 1 / 151.5749
Iteration 28: Changes / Distsum = 0 / 151.5667

    Elapsed time is 1.54 seconds.</code></pre>
<pre class="r"><code>pc_ks4 &lt;- tsclust(l_SRF8_z, k = 4L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 532 / 168.52
Iteration 2: Changes / Distsum = 97 / 153.8169
Iteration 3: Changes / Distsum = 56 / 148.021
Iteration 4: Changes / Distsum = 40 / 146.1238
Iteration 5: Changes / Distsum = 29 / 145.2076
Iteration 6: Changes / Distsum = 31 / 144.4671
Iteration 7: Changes / Distsum = 22 / 143.9373
Iteration 8: Changes / Distsum = 18 / 143.4564
Iteration 9: Changes / Distsum = 17 / 142.9969
Iteration 10: Changes / Distsum = 11 / 142.5233
Iteration 11: Changes / Distsum = 11 / 142.2131
Iteration 12: Changes / Distsum = 13 / 141.8213
Iteration 13: Changes / Distsum = 11 / 141.5375
Iteration 14: Changes / Distsum = 4 / 141.4405
Iteration 15: Changes / Distsum =  4 / 141.421
Iteration 16: Changes / Distsum = 3 / 141.4141
Iteration 17: Changes / Distsum = 2 / 141.3894
Iteration 18: Changes / Distsum = 3 / 141.3786
Iteration 19: Changes / Distsum = 6 / 141.3522
Iteration 20: Changes / Distsum = 4 / 141.2532
Iteration 21: Changes / Distsum = 4 / 141.1904
Iteration 22: Changes / Distsum = 4 / 141.1597
Iteration 23: Changes / Distsum = 3 / 141.1359
Iteration 24: Changes / Distsum = 5 / 141.1165
Iteration 25: Changes / Distsum = 1 / 141.0633
Iteration 26: Changes / Distsum = 2 / 141.0515
Iteration 27: Changes / Distsum = 3 / 141.0409
Iteration 28: Changes / Distsum =  1 / 141.007
Iteration 29: Changes / Distsum =  1 / 140.992
Iteration 30: Changes / Distsum = 0 / 140.9717

    Elapsed time is 1.63 seconds.</code></pre>
<pre class="r"><code>pc_ks5 &lt;- tsclust(l_SRF8_z, k = 5L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 532 / 161.8514
Iteration 2: Changes / Distsum = 100 / 148.6935
Iteration 3: Changes / Distsum = 69 / 142.4906
Iteration 4: Changes / Distsum = 41 / 140.0478
Iteration 5: Changes / Distsum = 34 / 138.8307
Iteration 6: Changes / Distsum = 23 / 137.773
Iteration 7: Changes / Distsum = 23 / 137.1449
Iteration 8: Changes / Distsum = 24 / 136.3135
Iteration 9: Changes / Distsum = 17 / 135.6154
Iteration 10: Changes / Distsum = 14 / 135.3935
Iteration 11: Changes / Distsum = 5 / 135.2865
Iteration 12: Changes / Distsum = 3 / 135.2529
Iteration 13: Changes / Distsum = 1 / 135.2219
Iteration 14: Changes / Distsum = 0 / 135.2108

    Elapsed time is 0.84 seconds.</code></pre>
<pre class="r"><code># Prototypes for 2 clusters
plot(pc_ks2)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-7-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(pc_ks2, type=&#39;centroid&#39;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-7-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for 3 clusters
plot(pc_ks3)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-7-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(pc_ks3, type=&#39;centroid&#39;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-7-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for 4 clusters
plot(pc_ks4)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-7-6.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(pc_ks4, type=&#39;centroid&#39;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-7-7.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for 5 clusters
plot(pc_ks5)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-7-8.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(pc_ks5, type=&#39;centroid&#39;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-7-9.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="partial-clustering-methods---tadpole" class="section level3">
<h3>3.4. partial clustering methods - Tadpole</h3>
<p>problematic for our dataset (series’ cross-distance matrix is NOT symmetric)</p>
<pre class="r"><code># Tadpole method
pc_tp &lt;- tsclust(l_SRF8_z, k = 2L:10L, type = &quot;t&quot;,
  seed = 8, trace = TRUE,
  control = tadpole_control(dc = 1.5,
  window.size = 4L))</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 5.12%
Performing cluster assignment

TADPole completed for k = 2 &amp; dc = 1.5
TADPole completed for k = 3 &amp; dc = 1.5
TADPole completed for k = 4 &amp; dc = 1.5
TADPole completed for k = 5 &amp; dc = 1.5
TADPole completed for k = 6 &amp; dc = 1.5
TADPole completed for k = 7 &amp; dc = 1.5
TADPole completed for k = 8 &amp; dc = 1.5
TADPole completed for k = 9 &amp; dc = 1.5
TADPole completed for k = 10 &amp; dc = 1.5

    Elapsed time is 0.6 seconds.</code></pre>
<pre class="r"><code>internal_CVI(pc_tp, &quot;Partial clustering with Tadpole method&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-8-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 4 or 5 clusters
pc_tp4 &lt;- tsclust(l_SRF8_z, k = 4L, type = &quot;t&quot;,
  seed = 8, trace = TRUE,
  control = tadpole_control(dc = 1.5,
  window.size = 4L))</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 5.12%
Performing cluster assignment

TADPole completed for k = 4 &amp; dc = 1.5

    Elapsed time is 0.46 seconds.</code></pre>
<pre class="r"><code>pc_tp5 &lt;- tsclust(l_SRF8_z, k = 5L, type = &quot;t&quot;,
  seed = 8, trace = TRUE,
  control = tadpole_control(dc = 1.5,
  window.size = 4L))</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 5.12%
Performing cluster assignment

TADPole completed for k = 5 &amp; dc = 1.5

    Elapsed time is 0.47 seconds.</code></pre>
<pre class="r"><code># Prototypes for 4,5 clusters
plot(pc_tp4)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-8-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(pc_tp4, type=&quot;centroid&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-8-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(pc_tp5)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-8-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(pc_tp5, type=&quot;centroid&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-8-5.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="other-depths-with-tadpole" class="section level3">
<h3>Other Depths with Tadpole</h3>
<ol start="2" style="list-style-type: decimal">
<li>DCL</li>
</ol>
<pre class="r"><code># DCL
pc_tp &lt;- tsclust(l_DCL8_z, k = 2L:10L, type = &quot;t&quot;,
  seed = 8, trace = TRUE,
  control = tadpole_control(dc = 1.5,
  window.size = 4L))</code></pre>
<pre><code>Error in tslist(series, error.check): object &#39;l_DCL8_z&#39; not found</code></pre>
<pre class="r"><code>internal_CVI(pc_tp, &quot;Partial clustering with Tadpole method&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-9-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 4 or 5 clusters
partial_tadpole &lt;- function(df_filt8, depth=&quot;DCL&quot;,k=4){
  l_DCL8 &lt;- make_list(df_filt8,&#39;DCL&#39;)
  l_DCL8_z &lt;- zscore(l_DCL8)
  pc_tp_k &lt;- tsclust(l_DCL8_z, k = k, type = &quot;t&quot;,
    seed = 8, trace = TRUE,
    control = tadpole_control(dc = 1.5,
    window.size = 4L))
  plot(pc_tp_k)
  plot(pc_tp_k, type=&quot;centroid&quot;)
}

# Prototypes for DCL
partial_tadpole(df_filt8, depth=&quot;DCL&quot;,k=3)</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 5.39%
Performing cluster assignment

TADPole completed for k = 3 &amp; dc = 1.5

    Elapsed time is 0.33 seconds.</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-9-2.png" width="1056" style="display: block; margin: auto;" /><img src="figure/clustering_time_series.Rmd/unnamed-chunk-9-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>partial_tadpole(df_filt8, depth=&quot;DCL&quot;,k=4)</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 5.39%
Performing cluster assignment

TADPole completed for k = 4 &amp; dc = 1.5

    Elapsed time is 0.31 seconds.</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-9-4.png" width="1056" style="display: block; margin: auto;" /><img src="figure/clustering_time_series.Rmd/unnamed-chunk-9-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>partial_tadpole(df_filt8, depth=&quot;DCL&quot;,k=5)</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 5.39%
Performing cluster assignment

TADPole completed for k = 5 &amp; dc = 1.5

    Elapsed time is 0.36 seconds.</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-9-6.png" width="1056" style="display: block; margin: auto;" /><img src="figure/clustering_time_series.Rmd/unnamed-chunk-9-7.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>partial_tadpole(df_filt8, depth=&quot;DCL&quot;,k=6)</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 5.39%
Performing cluster assignment

TADPole completed for k = 6 &amp; dc = 1.5

    Elapsed time is 0.29 seconds.</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-9-8.png" width="1056" style="display: block; margin: auto;" /><img src="figure/clustering_time_series.Rmd/unnamed-chunk-9-9.png" width="1056" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>BDCL</li>
</ol>
<pre class="r"><code># BDCL
pc_tp &lt;- tsclust(l_BDCL8_z, k = 2L:10L, type = &quot;t&quot;,
  seed = 8, trace = TRUE,
  control = tadpole_control(dc = 1.5,
  window.size = 4L))</code></pre>
<pre><code>Error in tslist(series, error.check): object &#39;l_BDCL8_z&#39; not found</code></pre>
<pre class="r"><code>internal_CVI(pc_tp, &quot;Partial clustering with Tadpole method&quot;)</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-10-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for BDCL
partial_tadpole(df_filt8, depth=&quot;BDCL&quot;,k=2)</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 5.39%
Performing cluster assignment

TADPole completed for k = 2 &amp; dc = 1.5

    Elapsed time is 0.31 seconds.</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-10-2.png" width="1056" style="display: block; margin: auto;" /><img src="figure/clustering_time_series.Rmd/unnamed-chunk-10-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>partial_tadpole(df_filt8, depth=&quot;BDCL&quot;,k=3)</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 5.39%
Performing cluster assignment

TADPole completed for k = 3 &amp; dc = 1.5

    Elapsed time is 0.35 seconds.</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-10-4.png" width="1056" style="display: block; margin: auto;" /><img src="figure/clustering_time_series.Rmd/unnamed-chunk-10-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>partial_tadpole(df_filt8, depth=&quot;BDCL&quot;,k=4)</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 5.39%
Performing cluster assignment

TADPole completed for k = 4 &amp; dc = 1.5

    Elapsed time is 0.31 seconds.</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-10-6.png" width="1056" style="display: block; margin: auto;" /><img src="figure/clustering_time_series.Rmd/unnamed-chunk-10-7.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>partial_tadpole(df_filt8, depth=&quot;BDCL&quot;,k=5)</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 5.39%
Performing cluster assignment

TADPole completed for k = 5 &amp; dc = 1.5

    Elapsed time is 0.31 seconds.</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-10-8.png" width="1056" style="display: block; margin: auto;" /><img src="figure/clustering_time_series.Rmd/unnamed-chunk-10-9.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>partial_tadpole(df_filt8, depth=&quot;BDCL&quot;,k=6)</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 5.39%
Performing cluster assignment

TADPole completed for k = 6 &amp; dc = 1.5

    Elapsed time is 0.34 seconds.</code></pre>
<p><img src="figure/clustering_time_series.Rmd/unnamed-chunk-10-10.png" width="1056" style="display: block; margin: auto;" /><img src="figure/clustering_time_series.Rmd/unnamed-chunk-10-11.png" width="1056" style="display: block; margin: auto;" /></p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19042)

Matrix products: default

Random number generation:
 RNG:     L&#39;Ecuyer-CMRG 
 Normal:  Inversion 
 Sample:  Rejection 
 
locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] TSclust_1.3.1     cluster_2.1.0     pdc_1.0.3         dtwclust_5.5.6   
 [5] dtw_1.22-3        proxy_0.4-24      maditr_0.7.4      formattable_0.2.1
 [9] ggplot2_3.3.3     stringr_1.4.0     tidyr_1.1.2       dplyr_1.0.4      
[13] workflowr_1.6.2  

loaded via a namespace (and not attached):
  [1] nlme_3.1-149            fs_1.5.0                xts_0.12.1             
  [4] webshot_0.5.2           rprojroot_2.0.2         tools_4.0.3            
  [7] bslib_0.2.4             utf8_1.1.4              R6_2.5.0               
 [10] KernSmooth_2.23-17      DBI_1.1.1               colorspace_2.0-0       
 [13] nnet_7.3-14             manipulateWidget_0.10.1 withr_2.4.1            
 [16] tidyselect_1.1.0        curl_4.3                compiler_4.0.3         
 [19] git2r_0.28.0            flexclust_1.4-0         cli_2.3.1              
 [22] shinyjs_2.0.0           labeling_0.4.2          tseries_0.10-48        
 [25] sass_0.3.1              scales_1.1.1            lmtest_0.9-38          
 [28] fracdiff_1.5-1          quadprog_1.5-8          digest_0.6.27          
 [31] clv_0.3-2.2             rmarkdown_2.7           pkgconfig_2.0.3        
 [34] htmltools_0.5.1.1       highr_0.8               fastmap_1.1.0          
 [37] TTR_0.24.2              htmlwidgets_1.5.3       rlang_0.4.10           
 [40] quantmod_0.4.18         rstudioapi_0.13         shiny_1.6.0            
 [43] farver_2.1.0            jquerylib_0.1.3         generics_0.1.0         
 [46] zoo_1.8-8               jsonlite_1.7.2          crosstalk_1.1.1        
 [49] magrittr_2.0.1          modeltools_0.2-23       Matrix_1.2-18          
 [52] Rcpp_1.0.5              munsell_0.5.0           fansi_0.4.2            
 [55] lifecycle_1.0.0         stringi_1.5.3           forecast_8.13          
 [58] whisker_0.4             yaml_2.2.1              plyr_1.8.6             
 [61] grid_4.0.3              misc3d_0.9-0            parallel_4.0.3         
 [64] promises_1.1.1          ggrepel_0.9.1           bigmemory.sri_0.1.3    
 [67] crayon_1.4.1            miniUI_0.1.1.1          lattice_0.20-41        
 [70] knitr_1.31              ps_1.6.0                pillar_1.5.1           
 [73] tcltk_4.0.3             reshape2_1.4.4          codetools_0.2-16       
 [76] stats4_4.0.3            urca_1.3-0              glue_1.4.2             
 [79] evaluate_0.14           data.table_1.14.0       RcppParallel_5.0.3     
 [82] vctrs_0.3.6             nloptr_1.2.2.2          httpuv_1.5.4           
 [85] foreach_1.5.1           gtable_0.3.0            purrr_0.3.4            
 [88] clue_0.3-58             assertthat_0.2.1        xfun_0.20              
 [91] mime_0.10               xtable_1.8-4            RSpectra_0.16-0        
 [94] later_1.1.0.1           class_7.3-17            timeDate_3043.102      
 [97] tibble_3.0.4            iterators_1.0.13        locpol_0.7-0           
[100] longitudinalData_2.4.1  rgl_0.105.22            bigmemory_4.5.36       
[103] ellipsis_0.3.1         </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
