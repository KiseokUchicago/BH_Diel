<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="KiseokUchicago" />

<meta name="date" content="2021-02-22" />

<title>peptide_level_visualization</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BH_Diel</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/KiseokUchicago/BH_Diel">
    <span class="fas fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">peptide_level_visualization</h1>
<h4 class="author">KiseokUchicago</h4>
<h4 class="date">2021-02-22</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-03-04
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>BH_Diel/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20210222code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20210222)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20210222code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20210222)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomKiseokUchicagoBHDieltree227f4ae68bd8936606faff4c78622c261dffb648targetblank227f4aea"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/KiseokUchicago/BH_Diel/tree/227f4ae68bd8936606faff4c78622c261dffb648" target="_blank">227f4ae</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomKiseokUchicagoBHDieltree227f4ae68bd8936606faff4c78622c261dffb648targetblank227f4aea" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/KiseokUchicago/BH_Diel/tree/227f4ae68bd8936606faff4c78622c261dffb648" target="_blank">227f4ae</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  01_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-BDCL_filtered_PSMs.tsv
    Untracked:  01_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-BDCL_filtered_PSMs.xlsx
    Untracked:  02_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-DCL_filtered_PSMs.tsv
    Untracked:  02_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-DCL_filtered_PSMs.xlsx
    Untracked:  03_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-SRF_filtered_PSMs.tsv
    Untracked:  03_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-SRF_filtered_PSMs.xlsx
    Untracked:  04_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-BDCL_filtered_PSMs.tsv
    Untracked:  04_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-BDCL_filtered_PSMs.xlsx
    Untracked:  05_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-DCL_filtered_PSMs.tsv
    Untracked:  05_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-DCL_filtered_PSMs.xlsx
    Untracked:  06_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-SRF_filtered_PSMs.tsv
    Untracked:  06_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-SRF_filtered_PSMs.xlsx
    Untracked:  07_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-BDCL_filtered_PSMs.tsv
    Untracked:  07_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-BDCL_filtered_PSMs.xlsx
    Untracked:  08_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-DCL_filtered_PSMs.tsv
    Untracked:  08_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-DCL_filtered_PSMs.xlsx
    Untracked:  09_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-SRF_filtered_PSMs.tsv
    Untracked:  09_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-SRF_filtered_PSMs.xlsx
    Untracked:  10_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-BDCL_filtered_PSMs.tsv
    Untracked:  10_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-BDCL_filtered_PSMs.xlsx
    Untracked:  11_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-DCL_filtered_PSMs.tsv
    Untracked:  11_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-DCL_filtered_PSMs.xlsx
    Untracked:  12_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-SRF_filtered_PSMs.tsv
    Untracked:  12_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-SRF_filtered_PSMs.xlsx
    Untracked:  13_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-BDCL_filtered_PSMs.tsv
    Untracked:  13_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-BDCL_filtered_PSMs.xlsx
    Untracked:  14_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-DCL_filtered_PSMs.tsv
    Untracked:  14_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-DCL_filtered_PSMs.xlsx
    Untracked:  15_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-SRF_filtered_PSMs.tsv
    Untracked:  15_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-SRF_filtered_PSMs.xlsx
    Untracked:  16_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-BDCL_filtered_PSMs.tsv
    Untracked:  16_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-BDCL_filtered_PSMs.xlsx
    Untracked:  17_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-DCL_filtered_PSMs.tsv
    Untracked:  17_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-DCL_filtered_PSMs.xlsx
    Untracked:  18_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-SRF_filtered_PSMs.tsv
    Untracked:  18_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-SRF_filtered_PSMs.xlsx
    Untracked:  19_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T8-BDCL_filtered_PSMs.tsv
    Untracked:  19_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T8-BDCL_filtered_PSMs.xlsx
    Untracked:  20_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-BDCL_filtered_PSMs.tsv
    Untracked:  20_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-BDCL_filtered_PSMs.xlsx
    Untracked:  21_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-DCL_filtered_PSMs.tsv
    Untracked:  21_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-DCL_filtered_PSMs.xlsx
    Untracked:  22_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-SRF_filtered_PSMs.tsv
    Untracked:  22_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-SRF_filtered_PSMs.xlsx
    Untracked:  23_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-BDCL_filtered_PSMs.tsv
    Untracked:  23_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-BDCL_filtered_PSMs.xlsx
    Untracked:  24_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-DCL_filtered_PSMs.tsv
    Untracked:  24_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-DCL_filtered_PSMs.xlsx
    Untracked:  25_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-SRF_filtered_PSMs.tsv
    Untracked:  25_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-SRF_filtered_PSMs.xlsx
    Untracked:  26_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-BDCL_filtered_PSMs.tsv
    Untracked:  26_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-BDCL_filtered_PSMs.xlsx
    Untracked:  27_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-DCL_filtered_PSMs.tsv
    Untracked:  27_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-DCL_filtered_PSMs.xlsx
    Untracked:  28_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-SRF_filtered_PSMs.tsv
    Untracked:  28_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-SRF_filtered_PSMs.xlsx
    Untracked:  29_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-BDCL_filtered_PSMs.tsv
    Untracked:  29_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-BDCL_filtered_PSMs.xlsx
    Untracked:  30_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-DCL_filtered_PSMs.tsv
    Untracked:  30_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-DCL_filtered_PSMs.xlsx
    Untracked:  31_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-SRF_filtered_PSMs.tsv
    Untracked:  31_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-SRF_filtered_PSMs.xlsx
    Untracked:  32_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-BDCL_filtered_PSMs.tsv
    Untracked:  32_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-BDCL_filtered_PSMs.xlsx
    Untracked:  33_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-DCL_filtered_PSMs.tsv
    Untracked:  33_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-DCL_filtered_PSMs.xlsx
    Untracked:  34_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-SRF_filtered_PSMs.tsv
    Untracked:  34_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-SRF_filtered_PSMs.xlsx
    Untracked:  35_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-BDCL_filtered_PSMs.tsv
    Untracked:  35_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-BDCL_filtered_PSMs.xlsx
    Untracked:  36_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-DCL_filtered_PSMs.tsv
    Untracked:  36_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-DCL_filtered_PSMs.xlsx
    Untracked:  37_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-SRF_filtered_PSMs.tsv
    Untracked:  37_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-SRF_filtered_PSMs.xlsx
    Untracked:  38_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-BDCL_filtered_PSMs.tsv
    Untracked:  38_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-BDCL_filtered_PSMs.xlsx
    Untracked:  39_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-DCL_filtered_PSMs.tsv
    Untracked:  39_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-DCL_filtered_PSMs.xlsx
    Untracked:  40_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-SRF_filtered_PSMs.tsv
    Untracked:  40_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-SRF_filtered_PSMs.xlsx
    Untracked:  41_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-BDCL_filtered_PSMs.tsv
    Untracked:  41_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-BDCL_filtered_PSMs.xlsx
    Untracked:  42_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-DCL_filtered_PSMs.tsv
    Untracked:  42_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-DCL_filtered_PSMs.xlsx
    Untracked:  43_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-SRF_filtered_PSMs.tsv
    Untracked:  43_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-SRF_filtered_PSMs.xlsx
    Untracked:  44_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-BDCL_filtered_PSMs.tsv
    Untracked:  44_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-BDCL_filtered_PSMs.xlsx
    Untracked:  45_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-DCL_filtered_PSMs.tsv
    Untracked:  45_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-DCL_filtered_PSMs.xlsx
    Untracked:  46_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-SRF_filtered_PSMs.tsv
    Untracked:  46_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-SRF_filtered_PSMs.xlsx
    Untracked:  47_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-BDCL_filtered_PSMs.tsv
    Untracked:  47_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-BDCL_filtered_PSMs.xlsx
    Untracked:  48_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-DCL_filtered_PSMs.tsv
    Untracked:  48_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-DCL_filtered_PSMs.xlsx
    Untracked:  49_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-SRF_filtered_PSMs.tsv
    Untracked:  49_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-SRF_filtered_PSMs.xlsx
    Untracked:  50_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-BDCL_filtered_PSMs.tsv
    Untracked:  50_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-BDCL_filtered_PSMs.xlsx
    Untracked:  51_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-DCL_filtered_PSMs.tsv
    Untracked:  51_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-DCL_filtered_PSMs.xlsx
    Untracked:  52_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-SRF_filtered_PSMs.tsv
    Untracked:  52_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-SRF_filtered_PSMs.xlsx
    Untracked:  53_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-BDCL_filtered_PSMs.tsv
    Untracked:  53_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-BDCL_filtered_PSMs.xlsx
    Untracked:  54_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-DCL_filtered_PSMs.tsv
    Untracked:  54_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-DCL_filtered_PSMs.xlsx
    Untracked:  55_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-SRF_filtered_PSMs.tsv
    Untracked:  55_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-SRF_filtered_PSMs.xlsx
    Untracked:  56_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-BDCL_filtered_PSMs.tsv
    Untracked:  56_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-BDCL_filtered_PSMs.xlsx
    Untracked:  57_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-DCL_filtered_PSMs.tsv
    Untracked:  57_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-DCL_filtered_PSMs.xlsx
    Untracked:  58_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-SRF_filtered_PSMs.tsv
    Untracked:  58_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-SRF_filtered_PSMs.xlsx
    Untracked:  59_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T7-BDCL_filtered_PSMs.tsv
    Untracked:  59_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T7-BDCL_filtered_PSMs.xlsx
    Untracked:  60_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T7-DCL_filtered_PSMs.tsv
    Untracked:  60_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T7-DCL_filtered_PSMs.xlsx
    Untracked:  61_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-BDCL_filtered_PSMs.tsv
    Untracked:  61_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-BDCL_filtered_PSMs.xlsx
    Untracked:  62_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-DCL_filtered_PSMs.tsv
    Untracked:  62_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-DCL_filtered_PSMs.xlsx
    Untracked:  63_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-SRF_filtered_PSMs.tsv
    Untracked:  63_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-SRF_filtered_PSMs.xlsx
    Untracked:  Hist_freq_of_peptide_id.pdf
    Untracked:  Hist_intensity_replicate.pdf
    Untracked:  Hist_intensity_spec_level.pdf
    Untracked:  Hist_number of timepoints_peptide_appears.pdf
    Untracked:  P1_number_unique_peptide_per_sample.pdf
    Untracked:  P2_number_of_cumulative_unique_peptides.pdf
    Untracked:  Peptide_id.tsv
    Untracked:  Replicate_ABC50_combined.tsv
    Untracked:  Replicate_ABC50_combined.xlsx
    Untracked:  Replicate_ABC63_combined.tsv
    Untracked:  Replicate_ABC63_combined.xlsx
    Untracked:  Replicate_BC_combined.tsv
    Untracked:  Replicate_BC_combined.xlsx
    Untracked:  Replicate_B_combined.tsv
    Untracked:  Replicate_B_combined.xlsx
    Untracked:  Time_series_intesity_all.pdf
    Untracked:  data/Time_metadata.txt
    Untracked:  data/counts_example.csv
    Untracked:  data/diel-Feb21/
    Untracked:  data/diel-Feb25/
    Untracked:  data/diel-Feb26/
    Untracked:  data/diel-Mar2/
    Untracked:  data/synthetic_control.data.txt
    Untracked:  hclust_DTW_average_wide.pdf

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/peptide_level_visualization.Rmd</code>) and HTML (<code>docs/peptide_level_visualization.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/227f4ae68bd8936606faff4c78622c261dffb648/analysis/peptide_level_visualization.Rmd" target="_blank">227f4ae</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-04
</td>
<td>
spec_level
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/c974307139ff5f126397f0e41c958cd2f37eaaa9/docs/peptide_level_visualization.html" target="_blank">c974307</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-04
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/2a8d1baa0753a5fb1ce13c40005b1787bc4fbab4/analysis/peptide_level_visualization.Rmd" target="_blank">2a8d1ba</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-04
</td>
<td>
grid
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/f77b37f32a9ff55d40ef7d579a5cfc42f19c2c21/docs/peptide_level_visualization.html" target="_blank">f77b37f</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-04
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/7f223a8f8561ef76901926468a4d13e2f6bcda7b/analysis/peptide_level_visualization.Rmd" target="_blank">7f223a8</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-04
</td>
<td>
intensity_histogram
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/3eb4d8892bf9cefac7d0cc85d46628e66e0de6b6/docs/peptide_level_visualization.html" target="_blank">3eb4d88</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-03
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/19d1e6c3242b4fd500c1500ad77e6ea298da142f/analysis/peptide_level_visualization.Rmd" target="_blank">19d1e6c</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-03
</td>
<td>
rain fdr
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/45127bd04e7e4abc5fa3898da9bbd1ddf3a56235/docs/peptide_level_visualization.html" target="_blank">45127bd</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-03
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/c6a81a1791ff2d152d4afefb1b87f0d47b4c97b6/analysis/peptide_level_visualization.Rmd" target="_blank">c6a81a1</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-03
</td>
<td>
x-axis label
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/cd5bef3583bb77b123c9e13ff671a87dcc3aa64c/docs/peptide_level_visualization.html" target="_blank">cd5bef3</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-03
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/21703f26decd3e16e0d1f5930a890f499b1ecada/analysis/peptide_level_visualization.Rmd" target="_blank">21703f2</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-03
</td>
<td>
Rain
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/86aa80188d28226f3e412f84853d061b2187888a/docs/peptide_level_visualization.html" target="_blank">86aa801</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-03
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/7a8405a4efd40a8494bdf38a3d224b56406bdbf5/analysis/peptide_level_visualization.Rmd" target="_blank">7a8405a</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-03
</td>
<td>
rain_not_done
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/403a8fb73c61d964f60bec6f048d4d6638c546c9/docs/peptide_level_visualization.html" target="_blank">403a8fb</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-03
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/2294f512531a7fb7d0fdf56e259e674cf6b6c570/analysis/peptide_level_visualization.Rmd" target="_blank">2294f51</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-03
</td>
<td>
clustering
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/6a616230eede9f744ec3f3134d36affbb46ff1f3/docs/peptide_level_visualization.html" target="_blank">6a61623</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-02
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/5478476358f9190fb8438dfee193052b3c2e3bb0/analysis/peptide_level_visualization.Rmd" target="_blank">5478476</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-02
</td>
<td>
hclust
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/7218e38d19977eee4cdac9f49bb92a9c754c0687/docs/peptide_level_visualization.html" target="_blank">7218e38</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-02
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/dc0c92541c7a095cc906479e3d7db744c6e4f4ca/analysis/peptide_level_visualization.Rmd" target="_blank">dc0c925</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-02
</td>
<td>
average
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/52cb18451f2c50292d084abf3126d330ef6be2bb/docs/peptide_level_visualization.html" target="_blank">52cb184</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-02
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/7f26b0f0ed5a088087ff67171af9bd22c65efe5f/analysis/peptide_level_visualization.Rmd" target="_blank">7f26b0f</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-02
</td>
<td>
update
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/c2f25d3613813ebed224e4e969c5753250e890fe/docs/peptide_level_visualization.html" target="_blank">c2f25d3</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-26
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/c5ec37ef6ebd29a83bdba8d242b57fccc7837df9/analysis/peptide_level_visualization.Rmd" target="_blank">c5ec37e</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-26
</td>
<td>
total 50 samples
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/e6cbdfa41b1e0486cb84eb4cb9e37efb7dc3e5ff/docs/peptide_level_visualization.html" target="_blank">e6cbdfa</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-25
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/af94ad010f576c08f5207ee8e60e202cb93a8691/analysis/peptide_level_visualization.Rmd" target="_blank">af94ad0</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-25
</td>
<td>
peptide
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/3db29b0bc2c1673a15f5600c103841a88b5a47bf/docs/peptide_level_visualization.html" target="_blank">3db29b0</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-23
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/fe508d15413c128cce2d577485c74c32d77d1704/analysis/peptide_level_visualization.Rmd" target="_blank">fe508d1</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-23
</td>
<td>
publish
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/e55579c873cb14ccd7bc7796c410ba177abc2a6c/docs/peptide_level_visualization.html" target="_blank">e55579c</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-23
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/44eb05fc0b315c8860224b5d2d2d40e0947e21dd/analysis/peptide_level_visualization.Rmd" target="_blank">44eb05f</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-23
</td>
<td>
publish
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/1ca336372d560d548ec8e4f1ee97dd6bd9de4d26/docs/peptide_level_visualization.html" target="_blank">1ca3363</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/dd3354ea8f4f0fc98a1ac9e91aeb7b5acc3645c9/analysis/peptide_level_visualization.Rmd" target="_blank">dd3354e</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
peptide
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/69d6ce78a34ed33f4c1c6f84cc3d565cc46908a9/docs/peptide_level_visualization.html" target="_blank">69d6ce7</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/deb4db2f0aae05e8a37b3c9f238db1621ed35046/analysis/peptide_level_visualization.Rmd" target="_blank">deb4db2</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
peptide
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/6915013940ded02942cbecc91fd9b56b9ecbec28/docs/peptide_level_visualization.html" target="_blank">6915013</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/5a66cb1df60159b096f60da4df338e24228e996d/analysis/peptide_level_visualization.Rmd" target="_blank">5a66cb1</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
peptide
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/12b2c74add495b09b165c27e24022cdd0f863103/docs/peptide_level_visualization.html" target="_blank">12b2c74</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/c4cbcd229432d571f38ef352a2c584f61be1c6c1/docs/peptide_level_visualization.html" target="_blank">c4cbcd2</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/7830f0053fe892c583494bdfddfc272fe7ffbd2c/analysis/peptide_level_visualization.Rmd" target="_blank">7830f00</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
publish
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/ee263ad22c2ca793bafd055ecf12f368d5b9386e/docs/peptide_level_visualization.html" target="_blank">ee263ad</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/0ccca1470fe945598555adf482d6057be73b219f/analysis/peptide_level_visualization.Rmd" target="_blank">0ccca14</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
visualization
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="peptide-level-visualization" class="section level3">
<h3>Peptide level visualization</h3>
<pre class="r"><code># libraries
library(dplyr)
library(tidyr)
library(stringr)
library(ggplot2)
library(formattable)</code></pre>
</div>
<div id="quality-check-number-of-uniq-peptides-sequence-per-sample" class="section level3">
<h3>1. Quality check: Number of uniq peptides (sequence) per sample</h3>
<pre class="r"><code># read in combined table of 24 samples (Replicate B)
df_pep &lt;- read.table(&quot;Replicate_ABC63_combined.tsv&quot;,sep=&#39;\t&#39;,header = T)

# count unique peptide per sample
df_uni &lt;- df_pep %&gt;% group_by(SampleID) %&gt;% summarize(uniq_pep = length(unique(Base.Peptide.Sequence)))
df_uni1 &lt;- df_uni %&gt;% separate(SampleID, sep=&#39;_&#39;, into= c(&#39;Depth&#39;,&#39;Time&#39;,&#39;Replicate&#39;),remove = F) %&gt;% select(-Time, -Replicate)
df_uni2 &lt;- df_uni1 %&gt;% arrange(desc(Depth))

# get the order right from SRF -&gt; DCL -&gt; BDCL
ord &lt;- df_uni2$SampleID 
df_uni2$SampleID &lt;- factor(df_uni2$SampleID, levels = ord)
df_uni2$Depth &lt;- factor(df_uni2$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))

# Making barplot
theme_set(theme_bw())
cols &lt;- c(&#39;SRF&#39;=&#39;#fc8d62&#39;,&#39;DCL&#39;=&#39;#66c2a5&#39;,&#39;BDCL&#39;=&#39;#8da0cb&#39;)
uniq1 &lt;- ggplot(df_uni2, aes(x=SampleID, fill=Depth, y=uniq_pep)) +  ## I put fill=value which was wrong
  geom_bar(stat=&quot;identity&quot;) +
  scale_fill_manual(values=cols) +
  ylab(&quot;Number of unique peptide sequence \n&quot;) +
  xlab(&quot;\n SampleID&quot;) +
  ggtitle(&quot;Number of unique peptide sequences per sample&quot;)+
  ## adjust positions
  theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(angle = 90, hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=10))+
  theme(panel.grid.major = element_blank()) +
  theme(panel.grid.minor = element_blank())

uniq2 &lt;- uniq1 + geom_text(aes(x=df_uni$SampleID, y=df_uni$uniq_pep, label=df_uni$uniq_pep),
            size = 3, hjust = 0.5, position = position_stack(vjust = +1.05), family=&quot;serif&quot;)
uniq2</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-2-1.png" width="1056" style="display: block; margin: auto;" /></p>
<p>sample DCL_T8 doesn’t seem to have good quality MS data.</p>
</div>
<div id="number-of-accumulative-uniq-peptides-sequence-does-it-saturate" class="section level3">
<h3>2. Number of accumulative uniq peptides (sequence): Does it saturate?</h3>
<pre class="r"><code># read in combined table of 24 samples (Replicate B)
df_pep &lt;- read.table(&quot;Replicate_ABC63_combined.tsv&quot;,sep=&#39;\t&#39;,header = T)

# get unique peptides per sample
dt &lt;- df_pep %&gt;% select(SampleID, Base.Peptide.Sequence) %&gt;% unique()
# change SampleID into number
dt1 &lt;- dt %&gt;% select(SampleID) %&gt;% unique() %&gt;% arrange(SampleID) %&gt;%  arrange()
dt2 &lt;- tibble::rownames_to_column(dt1,&quot;depth&quot;)
# merge dt and dt2
dt_depth &lt;- left_join(dt,dt2,by=c(&#39;SampleID&#39;=&#39;SampleID&#39;))
dim(dt_depth)</code></pre>
<pre><code>[1] 34685     3</code></pre>
<pre class="r"><code># get cumulative number of unique peptides (https://stackoverflow.com/questions/15698399/cumulative-count-of-unique-values-in-r)
require(data.table)
dt_depth &lt;- as.data.table(dt_depth)
setkey(dt_depth, &quot;depth&quot;)
dt_depth[, Base.Peptide.Sequence := as.numeric(factor(Base.Peptide.Sequence, levels = unique(Base.Peptide.Sequence)))]
setkey(dt_depth, &quot;depth&quot;, &quot;Base.Peptide.Sequence&quot;)
dt.out &lt;- dt_depth[J(unique(depth)), mult=&quot;last&quot;]
dt.out[, Base.Peptide.Sequence := cummax(Base.Peptide.Sequence)]

# getting ready to make plot
df.out &lt;- tibble::rowid_to_column(dt.out) 
df.out2 &lt;- df.out %&gt;% select(rowid, Base.Peptide.Sequence) %&gt;% rename(value=Base.Peptide.Sequence)
# Making line plot
theme_set(theme_bw())

p1 &lt;- ggplot(df.out2,aes(x = rowid,y = value)) + geom_line(col=&quot;magenta&quot;) + geom_point(color=&#39;maroon&#39;) +
  ylab(&quot;Number of cumulative unique peptide sequence \n&quot;) +
  xlab(&quot;\n Number of cumulative samples&quot;) +
  # ylim(c(0,2200)) +
  ggtitle(&quot;Number of cumulative unique peptide sequences \n&quot;)+
  ## adjust positions
  theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=10))
  # theme(panel.grid.major = element_blank())
  # theme(panel.grid.minor = element_blank())

p1</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-3-1.png" width="1056" style="display: block; margin: auto;" /> It seems to saturate as more samples are added.</p>
</div>
<div id="which-peptide_ids-are-present-in-allalmost-time-points" class="section level3">
<h3>3. Which Peptide_ids are present in all(almost) time points?</h3>
<p>Make a histogram of x-axis being the # of time points present, y-axis being the number of Peptide_ids<br />
We need 3 histogram for (1) Surface, (2) DCL, and (3) BDCL</p>
<pre class="r"><code># read in combined table of 24 samples (Replicate B)
df_pep &lt;- read.table(&quot;Replicate_ABC63_combined.tsv&quot;,sep=&#39;\t&#39;,header = T)

# (1) Surface
colnames(df_pep)</code></pre>
<pre><code> [1] &quot;Spec_id&quot;               &quot;Base.Peptide.Sequence&quot; &quot;log2.18O.16O.Ratio&quot;   
 [4] &quot;SampleID&quot;              &quot;Index&quot;                 &quot;Cruise&quot;               
 [7] &quot;Station&quot;               &quot;Isotope&quot;               &quot;Replicate&quot;            
[10] &quot;Time&quot;                  &quot;Depth&quot;                 &quot;SpectrumID&quot;           
[13] &quot;ScanID&quot;                &quot;Target.&quot;               &quot;Decoy.&quot;               
[16] &quot;Peptide_id&quot;           </code></pre>
<pre class="r"><code>df_srf &lt;- df_pep %&gt;% filter(Depth == &#39;SRF&#39;) %&gt;% select(Peptide_id, SampleID, Time, Depth) %&gt;% unique() %&gt;% arrange(Peptide_id)
# How many time points did it appear
(df_srf2 &lt;- df_srf %&gt;% group_by(Peptide_id) %&gt;% summarize(Timepoints = n_distinct(Time)) %&gt;% ungroup())</code></pre>
<pre><code># A tibble: 1,956 x 2
   Peptide_id Timepoints
 * &lt;chr&gt;           &lt;int&gt;
 1 Pep_1               8
 2 Pep_10              8
 3 Pep_100             8
 4 Pep_1000            5
 5 Pep_1001            4
 6 Pep_1002            6
 7 Pep_1003            4
 8 Pep_1004            4
 9 Pep_1005            6
10 Pep_1006            4
# ... with 1,946 more rows</code></pre>
<pre class="r"><code># Check if Pep_1 appeared in 8 time points
df_srf %&gt;% filter(Peptide_id==&quot;Pep_1004&quot;) # true 8 times</code></pre>
<pre><code>  Peptide_id SampleID Time Depth
1   Pep_1004 SRF_T1_A   T1   SRF
2   Pep_1004 SRF_T6_A   T6   SRF
3   Pep_1004 SRF_T3_B   T3   SRF
4   Pep_1004 SRF_T7_B   T7   SRF</code></pre>
<pre class="r"><code># Histogram
theme_set(theme_bw())
ggplot(df_srf2, aes(Timepoints)) + geom_bar() +
  ylab(&quot;Number of peptides \n&quot;) +
  xlab(&quot;\n Cumulative number of timepoints peptide are present&quot;) +
  scale_x_continuous(breaks=seq(1,8,1))+
  ggtitle(&quot;Distribution of number of timepoints each Peptide_id appears (Surface) \n&quot;)+
  ## adjust positions
  theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=10))</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-4-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>  # theme(panel.grid.major = element_blank())
  # theme(panel.grid.minor = element_blank())

# Let&#39;s try to plot all of them at once
df_all &lt;- df_pep %&gt;% select(Peptide_id, SampleID, Time, Depth) %&gt;% unique() %&gt;% arrange(Peptide_id)
# How many time points did it appear
(df_all2 &lt;- df_all %&gt;% group_by(Peptide_id, Depth) %&gt;% summarize(Timepoints = n_distinct(Time)) %&gt;% ungroup())</code></pre>
<pre><code># A tibble: 5,831 x 3
   Peptide_id Depth Timepoints
   &lt;chr&gt;      &lt;chr&gt;      &lt;int&gt;
 1 Pep_1      BDCL           8
 2 Pep_1      DCL            8
 3 Pep_1      SRF            8
 4 Pep_10     BDCL           8
 5 Pep_10     DCL            8
 6 Pep_10     SRF            8
 7 Pep_100    BDCL           8
 8 Pep_100    DCL            7
 9 Pep_100    SRF            8
10 Pep_1000   BDCL           1
# ... with 5,821 more rows</code></pre>
<pre class="r"><code>df_all2$Depth &lt;- factor(df_all2$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))

# Histogram
ggplot(df_all2, aes(Timepoints)) + geom_bar(aes(fill=Depth), position=&#39;dodge&#39;) +
  scale_fill_manual(values=cols) +
  ylab(&quot;Number of peptides \n&quot;) +
  xlab(&quot;\n Cumulative number of timepoints peptide are present&quot;) +
  scale_x_continuous(breaks=seq(1,8,1))+
  ggtitle(&quot;Distribution of number of timepoints each Peptide_id appears \n&quot;)+
  ## adjust positions
  theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=10))</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-4-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>  # theme(panel.grid.major = element_blank())
  # theme(panel.grid.minor = element_blank())</code></pre>
<p>Why does DCL have so less?</p>
</div>
<div id="plotting-time-series-fluctuation-for-the-peptides" class="section level3">
<h3>4. Plotting time series fluctuation for the peptides</h3>
<p>First retrieve the log intensity value for all peptides (average over the same spec_id)</p>
<pre class="r"><code># (1) Get list of peptides that are present in 7 or 8 timepoints
df_all2_filt &lt;- df_all2 %&gt;% filter(Timepoints &gt; 6) %&gt;% unique() 

# (2) Let&#39;s average the intensity for each unique peptide
df_int &lt;- df_pep %&gt;% select(Peptide_id, Spec_id, log2.18O.16O.Ratio, SampleID, Time, Depth, Replicate) %&gt;% unique() %&gt;% arrange(Peptide_id)
head(df_int)</code></pre>
<pre><code>  Peptide_id         Spec_id log2.18O.16O.Ratio  SampleID Time Depth Replicate
1      Pep_1 BDCL_T1_A_31195         -0.3969800 BDCL_T1_A   T1  BDCL         A
2      Pep_1 BDCL_T1_A_31179         -0.5078004 BDCL_T1_A   T1  BDCL         A
3      Pep_1 BDCL_T1_A_31003         -0.3509932 BDCL_T1_A   T1  BDCL         A
4      Pep_1 BDCL_T1_A_31022         -0.4062575 BDCL_T1_A   T1  BDCL         A
5      Pep_1 BDCL_T1_A_31372         -0.4000644 BDCL_T1_A   T1  BDCL         A
6      Pep_1 BDCL_T1_A_31355         -0.3204865 BDCL_T1_A   T1  BDCL         A</code></pre>
<pre class="r"><code># first average the spectrum_id per sample 
# important to make sure to take log2 after averaging the original value(2^x)
df_int %&gt;% filter(Peptide_id==&#39;Pep_1&#39; &amp; Time ==&#39;T1&#39; &amp; SampleID == &#39;BDCL_T1_A&#39;)</code></pre>
<pre><code>   Peptide_id         Spec_id log2.18O.16O.Ratio  SampleID Time Depth Replicate
1       Pep_1 BDCL_T1_A_31195         -0.3969800 BDCL_T1_A   T1  BDCL         A
2       Pep_1 BDCL_T1_A_31179         -0.5078004 BDCL_T1_A   T1  BDCL         A
3       Pep_1 BDCL_T1_A_31003         -0.3509932 BDCL_T1_A   T1  BDCL         A
4       Pep_1 BDCL_T1_A_31022         -0.4062575 BDCL_T1_A   T1  BDCL         A
5       Pep_1 BDCL_T1_A_31372         -0.4000644 BDCL_T1_A   T1  BDCL         A
6       Pep_1 BDCL_T1_A_31355         -0.3204865 BDCL_T1_A   T1  BDCL         A
7       Pep_1 BDCL_T1_A_30845         -0.9341082 BDCL_T1_A   T1  BDCL         A
8       Pep_1 BDCL_T1_A_30832         -1.0560891 BDCL_T1_A   T1  BDCL         A
9       Pep_1 BDCL_T1_A_31549         -0.5557501 BDCL_T1_A   T1  BDCL         A
10      Pep_1 BDCL_T1_A_31536         -0.5959763 BDCL_T1_A   T1  BDCL         A
11      Pep_1 BDCL_T1_A_31789         -0.4540486 BDCL_T1_A   T1  BDCL         A
12      Pep_1 BDCL_T1_A_32226         -0.2962970 BDCL_T1_A   T1  BDCL         A</code></pre>
<pre class="r"><code>df_ave &lt;- df_int %&gt;% group_by(SampleID, Time, Depth, Replicate, Peptide_id) %&gt;% summarize(log2_Mean_intensity=log2(mean(2^log2.18O.16O.Ratio))) %&gt;% ungroup()
head(df_ave)</code></pre>
<pre><code># A tibble: 6 x 6
  SampleID  Time  Depth Replicate Peptide_id log2_Mean_intensity
  &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;                    &lt;dbl&gt;
1 BDCL_T1_A T1    BDCL  A         Pep_1                   -0.506
2 BDCL_T1_A T1    BDCL  A         Pep_10                  -0.446
3 BDCL_T1_A T1    BDCL  A         Pep_100                 -0.865
4 BDCL_T1_A T1    BDCL  A         Pep_101                 -0.820
5 BDCL_T1_A T1    BDCL  A         Pep_1017                -0.655
6 BDCL_T1_A T1    BDCL  A         Pep_1018                -1.64 </code></pre>
<pre class="r"><code>df_ave %&gt;% filter(Peptide_id==&#39;Pep_1&#39; &amp; Time ==&#39;T1&#39; &amp; SampleID == &#39;BDCL_T1_A&#39;) # check if Pep_1 in sample &#39;BDCL_T1_A&#39; is -0.5059 (yes correct)</code></pre>
<pre><code># A tibble: 1 x 6
  SampleID  Time  Depth Replicate Peptide_id log2_Mean_intensity
  &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;                    &lt;dbl&gt;
1 BDCL_T1_A T1    BDCL  A         Pep_1                   -0.506</code></pre>
<pre class="r"><code># then average and error by replicate
# see here for calculating error bar in log scale (https://faculty.washington.edu/stuve/log_error.pdf)
# for example of Pep_1
df_ave %&gt;% group_by(SampleID) %&gt;% filter(Peptide_id==&#39;Pep_1&#39;) %&gt;% head(10)</code></pre>
<pre><code># A tibble: 10 x 6
# Groups:   SampleID [10]
   SampleID  Time  Depth Replicate Peptide_id log2_Mean_intensity
   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;                    &lt;dbl&gt;
 1 BDCL_T1_A T1    BDCL  A         Pep_1                  -0.506 
 2 BDCL_T1_B T1    BDCL  B         Pep_1                  -0.606 
 3 BDCL_T1_C T1    BDCL  C         Pep_1                  -1.38  
 4 BDCL_T2_A T2    BDCL  A         Pep_1                  -1.04  
 5 BDCL_T2_B T2    BDCL  B         Pep_1                  -0.910 
 6 BDCL_T3_A T3    BDCL  A         Pep_1                  -0.0283
 7 BDCL_T3_B T3    BDCL  B         Pep_1                  -0.618 
 8 BDCL_T3_C T3    BDCL  C         Pep_1                  -0.240 
 9 BDCL_T4_A T4    BDCL  A         Pep_1                  -0.582 
10 BDCL_T4_B T4    BDCL  B         Pep_1                  -0.859 </code></pre>
<pre class="r"><code># calculate average and error bar for intensity
df_ave_rep &lt;- df_ave %&gt;% group_by(Time, Depth, Peptide_id) %&gt;% summarize(log2_ave_intensity=log2(mean(2^log2_Mean_intensity)), sd_intensity=sd(2^log2_Mean_intensity)) %&gt;% ungroup()
head(df_ave_rep)</code></pre>
<pre><code># A tibble: 6 x 5
  Time  Depth Peptide_id log2_ave_intensity sd_intensity
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;        &lt;dbl&gt;
1 T1    BDCL  Pep_1                  -0.781       0.173 
2 T1    BDCL  Pep_10                 -0.204       0.160 
3 T1    BDCL  Pep_100                -1.02        0.0770
4 T1    BDCL  Pep_1004               -1.03       NA     
5 T1    BDCL  Pep_1009               -0.749      NA     
6 T1    BDCL  Pep_101                -0.968       0.0619</code></pre>
<pre class="r"><code># why is there no sd for Pep_1004?
df_ave %&gt;% group_by(SampleID) %&gt;% filter(Peptide_id==&#39;Pep_1004&#39;) # there is only 1 sample for T1 BDCL </code></pre>
<pre><code># A tibble: 11 x 6
# Groups:   SampleID [11]
   SampleID  Time  Depth Replicate Peptide_id log2_Mean_intensity
   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;                    &lt;dbl&gt;
 1 BDCL_T1_B T1    BDCL  B         Pep_1004                -1.03 
 2 BDCL_T2_B T2    BDCL  B         Pep_1004                -0.320
 3 BDCL_T3_B T3    BDCL  B         Pep_1004                -0.697
 4 BDCL_T5_A T5    BDCL  A         Pep_1004                -0.341
 5 BDCL_T5_B T5    BDCL  B         Pep_1004                -0.602
 6 BDCL_T8_B T8    BDCL  B         Pep_1004                -0.876
 7 DCL_T1_B  T1    DCL   B         Pep_1004                -0.454
 8 SRF_T1_A  T1    SRF   A         Pep_1004                -0.548
 9 SRF_T3_B  T3    SRF   B         Pep_1004                -0.214
10 SRF_T6_A  T6    SRF   A         Pep_1004                -0.474
11 SRF_T7_B  T7    SRF   B         Pep_1004                -0.751</code></pre>
<pre class="r"><code># log scale error bar: d(log2y)=1/log2 * (dy / y)
df_ave_rep2 &lt;- df_ave_rep %&gt;% mutate(ave_intensity = 2^log2_ave_intensity) %&gt;% mutate(rel_error = sd_intensity/ave_intensity) %&gt;% mutate(log2_sd_intensity = (1/log(2))*rel_error) %&gt;% mutate(log2_error_up=log2_ave_intensity+log2_sd_intensity) %&gt;% mutate(log2_error_down=log2_ave_intensity-log2_sd_intensity)

head(df_ave_rep2)</code></pre>
<pre><code># A tibble: 6 x 10
  Time  Depth Peptide_id log2_ave_intensity sd_intensity ave_intensity rel_error
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
1 T1    BDCL  Pep_1                  -0.781       0.173          0.582     0.297
2 T1    BDCL  Pep_10                 -0.204       0.160          0.868     0.184
3 T1    BDCL  Pep_100                -1.02        0.0770         0.493     0.156
4 T1    BDCL  Pep_1004               -1.03       NA              0.488    NA    
5 T1    BDCL  Pep_1009               -0.749      NA              0.595    NA    
6 T1    BDCL  Pep_101                -0.968       0.0619         0.511     0.121
# ... with 3 more variables: log2_sd_intensity &lt;dbl&gt;, log2_error_up &lt;dbl&gt;,
#   log2_error_down &lt;dbl&gt;</code></pre>
<pre class="r"><code># (3) import time metadata and merge
(df_time &lt;- read.table(&#39;data/Time_metadata.txt&#39;, header=T, sep=&#39;\t&#39;))</code></pre>
<pre><code>  timepoint          date_time elapsed_hours
1        T1 6/26/2019 12:45:00             0
2        T2 6/26/2019 15:45:00             3
3        T3 6/26/2019 18:45:00             6
4        T4 6/26/2019 21:45:00             9
5        T5  6/27/2019 4:40:00            15
6        T6  6/27/2019 7:45:00            19
7        T7 6/27/2019 10:45:00            22
8        T8 6/27/2019 13:45:00            25</code></pre>
<pre class="r"><code>df_time$date_time &lt;- str_replace(df_time$date_time, &quot;/2019&quot;,&quot; &quot;)
df_time$date_time &lt;- str_replace(df_time$date_time, &quot;:00$&quot;,&quot;&quot;)

# left_join with average data
df_ave2 &lt;- df_ave_rep2 %&gt;% left_join(df_time, by=c(&#39;Time&#39;=&#39;timepoint&#39;))
head(df_ave2)</code></pre>
<pre><code># A tibble: 6 x 12
  Time  Depth Peptide_id log2_ave_intensity sd_intensity ave_intensity rel_error
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
1 T1    BDCL  Pep_1                  -0.781       0.173          0.582     0.297
2 T1    BDCL  Pep_10                 -0.204       0.160          0.868     0.184
3 T1    BDCL  Pep_100                -1.02        0.0770         0.493     0.156
4 T1    BDCL  Pep_1004               -1.03       NA              0.488    NA    
5 T1    BDCL  Pep_1009               -0.749      NA              0.595    NA    
6 T1    BDCL  Pep_101                -0.968       0.0619         0.511     0.121
# ... with 5 more variables: log2_sd_intensity &lt;dbl&gt;, log2_error_up &lt;dbl&gt;,
#   log2_error_down &lt;dbl&gt;, date_time &lt;chr&gt;, elapsed_hours &lt;int&gt;</code></pre>
<pre class="r"><code># only use peptides that appear 7 or 8 times
df_ave2 %&gt;% select(Peptide_id) %&gt;% unique() %&gt;% dim() # 3233 peptides before</code></pre>
<pre><code>[1] 3233    1</code></pre>
<pre class="r"><code>df_filt78 &lt;- inner_join(df_ave2, df_all2_filt, by=c(&#39;Peptide_id&#39;=&#39;Peptide_id&#39;,&#39;Depth&#39;=&#39;Depth&#39;))

# inspecting if the inner join was successful
head(df_filt78)</code></pre>
<pre><code># A tibble: 6 x 13
  Time  Depth Peptide_id log2_ave_intensity sd_intensity ave_intensity rel_error
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
1 T1    BDCL  Pep_1                  -0.781       0.173          0.582     0.297
2 T1    BDCL  Pep_10                 -0.204       0.160          0.868     0.184
3 T1    BDCL  Pep_100                -1.02        0.0770         0.493     0.156
4 T1    BDCL  Pep_101                -0.968       0.0619         0.511     0.121
5 T1    BDCL  Pep_102                -1.21        0.109          0.432     0.251
6 T1    BDCL  Pep_1020               -1.31        0.108          0.404     0.267
# ... with 6 more variables: log2_sd_intensity &lt;dbl&gt;, log2_error_up &lt;dbl&gt;,
#   log2_error_down &lt;dbl&gt;, date_time &lt;chr&gt;, elapsed_hours &lt;int&gt;,
#   Timepoints &lt;int&gt;</code></pre>
<pre class="r"><code>colnames(df_ave2)</code></pre>
<pre><code> [1] &quot;Time&quot;               &quot;Depth&quot;              &quot;Peptide_id&quot;        
 [4] &quot;log2_ave_intensity&quot; &quot;sd_intensity&quot;       &quot;ave_intensity&quot;     
 [7] &quot;rel_error&quot;          &quot;log2_sd_intensity&quot;  &quot;log2_error_up&quot;     
[10] &quot;log2_error_down&quot;    &quot;date_time&quot;          &quot;elapsed_hours&quot;     </code></pre>
<pre class="r"><code>colnames(df_time)</code></pre>
<pre><code>[1] &quot;timepoint&quot;     &quot;date_time&quot;     &quot;elapsed_hours&quot;</code></pre>
<pre class="r"><code>colnames(df_filt78)</code></pre>
<pre><code> [1] &quot;Time&quot;               &quot;Depth&quot;              &quot;Peptide_id&quot;        
 [4] &quot;log2_ave_intensity&quot; &quot;sd_intensity&quot;       &quot;ave_intensity&quot;     
 [7] &quot;rel_error&quot;          &quot;log2_sd_intensity&quot;  &quot;log2_error_up&quot;     
[10] &quot;log2_error_down&quot;    &quot;date_time&quot;          &quot;elapsed_hours&quot;     
[13] &quot;Timepoints&quot;        </code></pre>
<pre class="r"><code>df_filt78 %&gt;% select(Peptide_id) %&gt;% unique() %&gt;% dim() # 736 peptides for peptides in 7 or 8 timepoints</code></pre>
<pre><code>[1] 736   1</code></pre>
<pre class="r"><code>df_filt78$Depth &lt;- factor(df_filt78$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))

# get only 8 ones
df_filt8 &lt;- df_filt78 %&gt;% filter(Timepoints &gt; 7)
df_filt8 %&gt;% select(Peptide_id) %&gt;% unique() %&gt;% dim() # 539 peptides for peptides in all 8 timepoints</code></pre>
<pre><code>[1] 539   1</code></pre>
<pre class="r"><code>df_filt8$Depth &lt;- factor(df_filt8$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))

# get only 7 ones
df_filt7 &lt;- df_filt78 %&gt;% filter(Timepoints == 7)
df_filt7 %&gt;% select(Peptide_id) %&gt;% unique() %&gt;% dim() # 533 peptides for peptides in 7 timepoints</code></pre>
<pre><code>[1] 533   1</code></pre>
<pre class="r"><code>df_filt8$Depth &lt;- factor(df_filt8$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))</code></pre>
<p>Plot for peptides present in 7 or 8 timepoints</p>
<pre class="r"><code># (4) Plot the scatter plot with error bars
theme_set(theme_bw())

ggplot(df_filt78, aes(x=elapsed_hours,y=log2_ave_intensity, color=Depth, group=interaction(Peptide_id,Depth))) +
  geom_point(size=2, shape=21) +
  geom_line()+
  geom_errorbar(aes(ymin=log2_error_down, ymax=log2_error_up), width=.2, position=position_dodge(.9))+
  scale_color_manual(values=cols) +
  ylab(&quot;log2 Mean intensity (log2(18O/16O)) \n&quot;) +
  xlab(&quot;\n Time of day on June 26 2019 (Daylight 05:17-20:30)&quot;) +
  scale_x_continuous(breaks=df_time$elapsed_hours,labels =c(df_time$date_time))+
  ggtitle(&quot;Time series intensity of peptide_id \n&quot;)+
  ## adjust positions
  theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(hjust = 0.9, vjust=0.9,angle=40,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=10)) +
  annotate(&quot;rect&quot;, xmin = 7.75, xmax = 16.53, ymin = -Inf, ymax = Inf, alpha = .2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-6-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>  # geom_rect(aes(xmin=7.75, xmax=16.53, ymin=0, ymax=Inf))
  # theme(panel.grid.major = element_blank()) +
  # theme(panel.grid.minor = element_blank())</code></pre>
<p>without error bars</p>
<pre class="r"><code>theme_set(theme_bw())
ggplot(df_filt78, aes(x=elapsed_hours,y=log2_ave_intensity, color=Depth, group=interaction(Peptide_id,Depth))) +
  geom_point(size=2, shape=21) +
  geom_line()+
  # geom_errorbar(aes(ymin=log2_error_down, ymax=log2_error_up), width=.2, position=position_dodge(.9))+
  scale_color_manual(values=cols) +
  ylab(&quot;log2 Mean intensity (log2(18O/16O)) \n&quot;) +
  xlab(&quot;\n Time of day on June 26 2019 (Daylight 05:17-20:30)&quot;) +
  scale_x_continuous(breaks=df_time$elapsed_hours,labels =c(df_time$date_time))+
  ggtitle(&quot;Time series intensity of peptide_id \n&quot;)+
  ## adjust positions
  theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(hjust = 0.9, vjust=0.9,angle=40,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=10)) +
  annotate(&quot;rect&quot;, xmin = 7.75, xmax = 16.53, ymin = -Inf, ymax = Inf, alpha = .2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-7-1.png" width="1056" style="display: block; margin: auto;" /></p>
<p>4.1. Surface(SRF)</p>
<pre class="r"><code># color code
# 1. Surface(orange): #fc8d62
# 2. DCL(green): #66c2a5
# 3. BDCL(blue): #8da0cb
color_vec &lt;- c(&#39;#fc8d62&#39;,&#39;#66c2a5&#39;,&#39;#8da0cb&#39;)
depth_vec &lt;- c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;)

time_series_1depth_woError &lt;- function(df_filt78, depth){
  theme_set(theme_bw())
  # filter depth
  df_filt78_s &lt;- df_filt78 %&gt;% filter(Depth == depth_vec[depth])
  ggplot(df_filt78_s, aes(x=elapsed_hours,y=log2_ave_intensity, group=Peptide_id)) +
    geom_point(size=2, shape=21, color=color_vec[depth]) +
    geom_line(color= color_vec[depth])+
    ylab(&quot;Log2 mean intensity (log2(18O/16O)) \n&quot;) +
    xlab(&quot;\n Time of day on June 26 2019 (Daylight 05:17-20:30)&quot;) +
    scale_x_continuous(breaks=df_time$elapsed_hours,labels =c(df_time$date_time))+
    ggtitle(paste0(&quot;Time series intensity of peptide_id&quot;,&quot; (&quot;,depth_vec[depth],&quot;)&quot;,&quot;\n&quot;))+
    ## adjust positions
    theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.text.x = element_text(hjust = 0.9, vjust=0.9,angle=40,size=13, family=&quot;serif&quot;))+
    theme(axis.text.y = element_text(size=10)) +
    annotate(&quot;rect&quot;, xmin = 7.75, xmax = 16.53, ymin = -Inf, ymax = Inf, alpha = .2)
    # theme(panel.grid.major = element_blank()) +
    # theme(panel.grid.minor = element_blank())
}

time_series_1depth_wError &lt;- function(df_filt78, depth){
  theme_set(theme_bw())
  # filter depth
  df_filt78_s &lt;- df_filt78 %&gt;% filter(Depth == depth_vec[depth])
  ggplot(df_filt78_s, aes(x=elapsed_hours,y=log2_ave_intensity, group=Peptide_id)) +
    geom_point(size=2, shape=21, color=color_vec[depth]) +
    geom_line(color= color_vec[depth])+
    geom_errorbar(aes(ymin=log2_error_down, ymax=log2_error_up), width=.05, position=position_dodge(.2),color=&#39;red&#39;)+
    ylab(&quot;Log2 mean intensity (log2(18O/16O)) \n&quot;) +
    xlab(&quot;\n Time of day on June 26 2019 (Daylight 05:17-20:30)&quot;) +
    scale_x_continuous(breaks=df_time$elapsed_hours,labels =c(df_time$date_time))+
    ggtitle(paste0(&quot;Time series intensity of peptide_id&quot;,&quot; (&quot;,depth_vec[depth],&quot;)&quot;,&quot;\n&quot;))+
    ## adjust positions
    theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.text.x = element_text(hjust = 0.9, vjust=0.9,angle=40,size=13, family=&quot;serif&quot;))+
    theme(axis.text.y = element_text(size=10)) +
    annotate(&quot;rect&quot;, xmin = 7.75, xmax = 16.53, ymin = -Inf, ymax = Inf, alpha = .2)
    # theme(panel.grid.major = element_blank()) +
    # theme(panel.grid.minor = element_blank())
}

# when we use all 7, 8 appearance cases
time_series_1depth_woError(df_filt78,1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-8-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt78,1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-8-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># when we use only 8 appearance cases
time_series_1depth_woError(df_filt8,1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-8-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt8,1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-8-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># when we use only 7 appearance cases
time_series_1depth_woError(df_filt7,1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-8-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt7,1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-8-6.png" width="1056" style="display: block; margin: auto;" /></p>
<p>4.2. Deep Chlorophyll layer (DCL)</p>
<pre class="r"><code># when we use all 7, 8 appearance cases
time_series_1depth_woError(df_filt78,2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-9-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt78,2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-9-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># when we use only 8 appearance cases
time_series_1depth_woError(df_filt8,2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-9-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt8,2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-9-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># when we use only 7 appearance cases
time_series_1depth_woError(df_filt7,2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-9-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt7,2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-9-6.png" width="1056" style="display: block; margin: auto;" /></p>
<p>4.3. Below Deep Chlorophyll layer (BDCL)</p>
<pre class="r"><code># when we use all 7, 8 appearance cases
time_series_1depth_woError(df_filt78,3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-10-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt78,3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-10-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># when we use only 8 appearance cases
time_series_1depth_woError(df_filt8,3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-10-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt8,3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-10-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># when we use only 7 appearance cases
time_series_1depth_woError(df_filt7,3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-10-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt7,3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-10-6.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="time-series-clustering" class="section level3">
<h3>5. Time series clustering</h3>
<p>For time series clustering with R, the first step is to work out an appropriate distance/similarity metric, and then, at the second step, use existing clustering techniques, such as k-means, hierarchical clustering, density-based clustering or subspace clustering, to find clustering structures. (<a href="http://www.rdatamining.com/examples/time-series-clustering-classification" class="uri">http://www.rdatamining.com/examples/time-series-clustering-classification</a>)</p>
<p>5.1. Approach 1: Hierarchical clustering using Dynamic time warping distance Dynamic Time Warping (DTW) finds optimal alignment between two time series, and DTW distance is used as a distance metric in the example below. (<a href="http://www.rdatamining.com/examples/time-series-clustering-classification" class="uri">http://www.rdatamining.com/examples/time-series-clustering-classification</a>)</p>
<pre class="r"><code># let&#39;s try cluster our time series data
colnames(df_filt8)</code></pre>
<pre><code> [1] &quot;Time&quot;               &quot;Depth&quot;              &quot;Peptide_id&quot;        
 [4] &quot;log2_ave_intensity&quot; &quot;sd_intensity&quot;       &quot;ave_intensity&quot;     
 [7] &quot;rel_error&quot;          &quot;log2_sd_intensity&quot;  &quot;log2_error_up&quot;     
[10] &quot;log2_error_down&quot;    &quot;date_time&quot;          &quot;elapsed_hours&quot;     
[13] &quot;Timepoints&quot;        </code></pre>
<pre class="r"><code>df_8 &lt;- df_filt8 %&gt;% filter(Depth==&#39;SRF&#39;) %&gt;% select(Peptide_id,Time,log2_ave_intensity)

# reshape the dataframe with timepoints
library(maditr)
v_names &lt;- c(&quot;T1&quot;,&quot;T2&quot;,&quot;T3&quot;,&quot;T4&quot;,&quot;T5&quot;,&quot;T6&quot;,&quot;T7&quot;,&quot;T8&quot;)
df_8$Time &lt;- factor(df_8$Time, levels=v_names)
dc_8 &lt;- dcast(df_8, Peptide_id ~ Time, value.var = &quot;log2_ave_intensity&quot;)
# make Peptide_id more simpler (Pep_1 -&gt; 1)
dc_8$Peptide_id &lt;- str_replace(dc_8$Peptide_id,&quot;Pep_&quot;,&quot;P.&quot;)
# make first column into row name
dc_8 &lt;- tibble::column_to_rownames(dc_8, var=&quot;Peptide_id&quot;)

# DTW distances
library(dtw)
any(is.na(dc_8)) # False: there is no NA in the table</code></pre>
<pre><code>[1] FALSE</code></pre>
<pre class="r"><code>distMatrix &lt;- dist(dc_8, method=&quot;DTW&quot;)
hc &lt;- hclust(distMatrix, method=&quot;average&quot;)
plot(hc, cex=0.7, xlab=&#39;Hierarchical clustering of Distance(DTW) Matrix&#39;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-11-1.png" width="1056" style="display: block; margin: auto;" /></p>
<p>Draw the particular small cluster in the time series plot</p>
<pre class="r"><code># function for plotting cluster of piptides
time_series_clust_wError &lt;- function(df_filt78, depth, clust1){
  theme_set(theme_bw())
  # filter depth
  df_filt78_s &lt;- df_filt78 %&gt;% filter(Depth == depth_vec[depth]) %&gt;% filter(Peptide_id %in% clust1)
  ggplot(df_filt78_s, aes(x=elapsed_hours,y=log2_ave_intensity, group=Peptide_id)) +
    geom_point(size=2, shape=21, color=color_vec[depth]) +
    geom_line(color= color_vec[depth])+
    geom_errorbar(aes(ymin=log2_error_down, ymax=log2_error_up), width=.05, position=position_dodge(.2),color=&#39;red&#39;)+
    ylab(&quot;Log2 mean intensity (log2(18O/16O)) \n&quot;) +
    xlab(&quot;\n Time of day on June 26 2019 (Daylight 05:17-20:30)&quot;) +
    scale_x_continuous(breaks=df_time$elapsed_hours,labels =c(df_time$date_time))+
    ggtitle(paste0(&quot;Time series intensity of peptide_id&quot;,&quot; (&quot;,depth_vec[depth],&quot;)&quot;,&quot;\n&quot;))+
    ## adjust positions
    theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.text.x = element_text(hjust = 0.9, vjust=0.9,angle=40,size=13, family=&quot;serif&quot;))+
    theme(axis.text.y = element_text(size=10)) +
    annotate(&quot;rect&quot;, xmin = 7.75, xmax = 16.53, ymin = -Inf, ymax = Inf, alpha = .2)
    # theme(panel.grid.major = element_blank()) +
    # theme(panel.grid.minor = element_blank())
}

# cluster1
clust1 &lt;- c(&#39;149&#39;)
clust1 &lt;- str_replace(clust1,&quot;P.&quot;,&quot;Pep_&quot;) # make Peptide_id
time_series_clust_wError(df_filt8, 1, clust1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-12-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># cluster2
clust2 &lt;- c(&quot;167&quot;,&quot;216&quot;,&quot;351&quot;,&quot;352&quot;,&quot;96&quot;,&quot;502&quot;,&quot;242&quot;, &quot;77&quot;,&quot;110&quot;,&quot;133&quot;, &quot;81&quot;,&quot;33&quot;,&quot;539&quot;,&quot;46&quot;,&quot;51&quot;, &quot;137&quot;,&quot;264&quot;,&quot;94&quot;,&quot;535&quot;,&quot;18&quot;,&quot;4&quot;, &quot;898&quot;, &quot;314&quot;, &quot;8&quot;)
clust2 &lt;- str_replace(clust2,&quot;P.&quot;,&quot;Pep_&quot;) # make Peptide_id
time_series_clust_wError(df_filt8, 1, clust2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-12-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># cluster
clust3 &lt;- c(&quot;374&quot;,&quot;479&quot;,&quot;758&quot;,&quot;905&quot;,&quot;52&quot;,&quot;435&quot;,&quot;461&quot;,&quot;111&quot;,&quot;196&quot;,&quot;482&quot;,&quot;691&quot;,&quot;597&quot;,&quot;739&quot;,&quot;657&quot;,&quot;740&quot;)
clust3 &lt;- str_replace(clust3,&quot;P.&quot;,&quot;Pep_&quot;) # make Peptide_id
time_series_clust_wError(df_filt8, 1, clust3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-12-3.png" width="1056" style="display: block; margin: auto;" /></p>
<p>5.2. Unsupervised clustering with various distances (SBD, DTW, …) / prototyping methods / clustering methods<br />
- Using dtwclust package - How many clusters should we use? Evaluate by CVI (Cluster validity index, the bigger the better for internal CVI)<br />
- Please normalize before clustering</p>
<ol start="0" style="list-style-type: decimal">
<li>Data formating for tsclust input</li>
</ol>
<pre class="r"><code># (1) Change our data into list format for input into tsclust
colnames(df_filt8)</code></pre>
<pre><code> [1] &quot;Time&quot;               &quot;Depth&quot;              &quot;Peptide_id&quot;        
 [4] &quot;log2_ave_intensity&quot; &quot;sd_intensity&quot;       &quot;ave_intensity&quot;     
 [7] &quot;rel_error&quot;          &quot;log2_sd_intensity&quot;  &quot;log2_error_up&quot;     
[10] &quot;log2_error_down&quot;    &quot;date_time&quot;          &quot;elapsed_hours&quot;     
[13] &quot;Timepoints&quot;        </code></pre>
<pre class="r"><code>make_list &lt;- function(df_filt8,depth){
  df_SRF8 &lt;- df_filt8 %&gt;% filter(Depth==depth) %&gt;% select(Peptide_id,Time,log2_ave_intensity)
  # reshape the dataframe with timepoints
  library(maditr)
  v_names &lt;- c(&quot;T1&quot;,&quot;T2&quot;,&quot;T3&quot;,&quot;T4&quot;,&quot;T5&quot;,&quot;T6&quot;,&quot;T7&quot;,&quot;T8&quot;)
  df_SRF8$Time &lt;- factor(df_SRF8$Time, levels=v_names)
  dc_SRF8 &lt;- dcast(df_SRF8, Peptide_id ~ Time, value.var = &quot;log2_ave_intensity&quot;)
  # make Peptide_id more simpler (Pep_1 -&gt; P.1)
  dc_SRF8$Peptide_id &lt;- str_replace(dc_SRF8$Peptide_id,&quot;Pep_&quot;,&quot;P.&quot;)
  # make first column into row name
  dc_SRF8 &lt;- tibble::column_to_rownames(dc_SRF8, var=&quot;Peptide_id&quot;)
  # make it into list format
  # l_SRF8 &lt;- setNames(split(dc_SRF8, seq(nrow(dc_SRF8))), rownames(dc_SRF8))
  l_SRF8 &lt;- as.list(as.data.frame(t(dc_SRF8)))
  return(l_SRF8)
}

l_SRF8 &lt;- make_list(df_filt8,&#39;SRF&#39;)
l_DCL8 &lt;- make_list(df_filt8,&#39;DCL&#39;)
l_BDCL8 &lt;- make_list(df_filt8,&#39;BDCL&#39;)</code></pre>
<div id="hierarchical-clustering-w-shape-based-distance" class="section level4">
<h4>(1) Hierarchical clustering w/ shape based distance</h4>
<pre class="r"><code># input into tsclust
library(dtwclust)
require(&quot;TSclust&quot;)

### Hierarchical clustering w/ shape based distance
hc_sbd &lt;- tsclust(l_SRF8, type = &quot;h&quot;, k = 2L:10L,
  preproc = zscore, seed = 899,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))

internal_CVI &lt;- function(hc_sbd,main){
  names(hc_sbd) &lt;- 2L:10L
  (eval &lt;- sapply(hc_sbd, cvi, type = &quot;internal&quot;))
  # divide CH value with 100 just to plot with other internal CVIs 
  eval[&#39;CH&#39;,] &lt;- eval[&#39;CH&#39;,]/100
  t(eval)
  matplot(x=seq(2,10,by=1),y=t(eval), type = c(&quot;b&quot;),pch=1,col = 1:7,
          xlab=&quot;Number of clusters&quot;,ylab=&quot;Internal CVI (cluster validity index)&quot;,main=main,axes=F) #plot
  axis(2)
  axis(side=1,at=2:10)
  legend(&quot;bottomright&quot;, legend = c(&quot;Sil&quot;,&quot;SF&quot;,&quot;CH/100&quot;,&quot;DB&quot;,&quot;DBstar&quot;,&quot;D&quot;,&quot;COP&quot;), col=1:7, pch=1,cex=0.8) # optional legend
}

internal_CVI(hc_sbd,&quot;Hierarchical clustering w/ shape based distance&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 3 or 4 clusters
hc_sbd3 &lt;- tsclust(l_SRF8, type = &quot;h&quot;, k = 3L,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))

hc_sbd4 &lt;- tsclust(l_SRF8, type = &quot;h&quot;, k = 4L,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))

# cluster dendrogram
plot(hc_sbd3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># The series and the obtained prototypes can be plotted too
plot(hc_sbd3, type = &quot;sc&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Focusing on the first cluster
plot(hc_sbd3, type = &quot;series&quot;, clus = 1L)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(hc_sbd3, type = &quot;centroids&quot;, clus = 1L)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># cluster dendrogram
plot(hc_sbd4)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-6.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># The series and the obtained prototypes can be plotted too
plot(hc_sbd4, type = &quot;sc&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-7.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="partial-clustering-methods---dtw" class="section level4">
<h4>(2-1) partial clustering methods - DTW</h4>
<pre class="r"><code>### partial clustering methods
# z-normalization
l_SRF8_z &lt;- zscore(l_SRF8)

# DTW distance
pc_dtw &lt;- tsclust(l_SRF8_z, k = 2L:10L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 8L,
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 837.7641
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 2: Changes / Distsum = 40 / 676.8562
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 12 / 672.476
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 3 / 672.3992
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 0 / 672.1413

Iteration 1: Changes / Distsum = 424 / 713.123
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
Iteration 2: Changes / Distsum = 59 / 644.8097
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 43 / 636.7099
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 4: Changes / Distsum = 13 / 632.0591
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 5: Changes / Distsum = 13 / 630.8079
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 10 / 629.7147
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 11 / 628.179
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 8: Changes / Distsum = 2 / 627.0636
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 9: Changes / Distsum = 0 / 626.7866

Iteration 1: Changes / Distsum = 424 / 705.456
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 2: Changes / Distsum = 140 / 632.637
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 49 / 617.8038
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 4: Changes / Distsum = 38 / 612.1329
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 5: Changes / Distsum = 22 / 610.2031
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 17 / 609.7836
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 15 / 609.7511
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 8: Changes / Distsum = 11 / 609.5684
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 8 / 609.2241
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
Iteration 10: Changes / Distsum = 18 / 609.113
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 11: Changes / Distsum = 14 / 608.2401
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 12: Changes / Distsum = 10 / 608.0425
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 13: Changes / Distsum = 10 / 607.459
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 14: Changes / Distsum =  6 / 606.965
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 15: Changes / Distsum = 4 / 606.5796
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 16: Changes / Distsum = 4 / 606.2551
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 17: Changes / Distsum = 0 / 606.2718

Iteration 1: Changes / Distsum = 424 / 691.6452
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
Iteration 2: Changes / Distsum = 94 / 619.9781
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 3: Changes / Distsum = 54 / 595.4692
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 17 / 591.6031
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 8 / 591.2969
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 6: Changes / Distsum = 3 / 591.2872
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 3 / 591.1367
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 3 / 590.9102
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum =  2 / 590.735
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 1 / 590.6449
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum =  1 / 590.578
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum = 2 / 590.2061
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 3 / 589.9384
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum =  4 / 589.754
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum = 5 / 589.5962
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 16: Changes / Distsum = 2 / 589.2462
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 17: Changes / Distsum = 2 / 589.1934
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 18: Changes / Distsum = 1 / 589.1304
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 19: Changes / Distsum = 0 / 589.0896

Iteration 1: Changes / Distsum = 424 / 642.5331
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
Iteration 2: Changes / Distsum = 52 / 574.976
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 33 / 568.7701
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 20 / 564.5507
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 5: Changes / Distsum = 24 / 561.8103
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 17 / 559.5756
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 7: Changes / Distsum =  5 / 558.778
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 1 / 558.9816
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 0 / 559.0266

Iteration 1: Changes / Distsum = 424 / 646.413
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 2: Changes / Distsum = 104 / 593.1594
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 3: Changes / Distsum = 70 / 581.8461
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 55 / 570.879
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 5: Changes / Distsum = 47 / 562.1578
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 26 / 555.7919
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 15 / 552.6757
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 19 / 549.1367
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 12 / 546.1405
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 10: Changes / Distsum = 14 / 544.931
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 8 / 544.6424
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 12: Changes / Distsum = 4 / 544.4062
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 2 / 544.1247
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 14: Changes / Distsum = 2 / 543.9265
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 15: Changes / Distsum = 0 / 543.8863

Iteration 1: Changes / Distsum = 424 / 612.6845
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 2: Changes / Distsum = 75 / 574.049
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 3: Changes / Distsum = 60 / 562.6258
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 47 / 553.4506
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 39 / 548.0562
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 27 / 544.9811
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 19 / 543.9388
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 8: Changes / Distsum = 14 / 543.7594
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 9: Changes / Distsum = 8 / 543.8479
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 6 / 543.3883
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 6 / 543.3656
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 12: Changes / Distsum = 3 / 543.1945
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 3 / 543.2105
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum = 5 / 543.1334
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum = 2 / 542.8555
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 16: Changes / Distsum =  0 / 542.946

Iteration 1: Changes / Distsum = 424 / 605.1872
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 2: Changes / Distsum = 76 / 549.9719
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 3: Changes / Distsum = 32 / 545.0619
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 20 / 541.2164
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 18 / 537.4147
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 6: Changes / Distsum = 18 / 533.621
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 26 / 530.192
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 19 / 526.7403
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 11 / 524.7159
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 13 / 523.3768
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 7 / 521.7618
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 12: Changes / Distsum = 10 / 520.9247
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 13: Changes / Distsum = 5 / 520.6718
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 14: Changes / Distsum = 2 / 520.5759
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 15: Changes / Distsum = 3 / 520.5492
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 16: Changes / Distsum = 1 / 520.4426
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 17: Changes / Distsum = 1 / 520.3869
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 18: Changes / Distsum = 0 / 520.2891

Iteration 1: Changes / Distsum = 424 / 600.0815
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1 - Converged!
Iteration 2: Changes / Distsum = 93 / 541.6657
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 3: Changes / Distsum = 50 / 530.1269
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 4: Changes / Distsum = 44 / 520.8806
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 32 / 515.1676
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 6: Changes / Distsum = 13 / 512.8808
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 5 / 512.2954
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 2 / 512.2923
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 1 / 512.1826
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 10: Changes / Distsum = 1 / 512.1642
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 0 / 512.1043

    Elapsed time is 1.71 seconds.</code></pre>
<pre class="r"><code>internal_CVI(pc_dtw, &quot;Partial clustering with DTW distance&quot;)</code></pre>
<pre><code>    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18 - Converged!</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-15-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 4, 5, 7 clusters
pc_dtw4 &lt;- tsclust(l_SRF8_z, k = 4L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 8L,
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 684.7276
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 2: Changes / Distsum = 74 / 615.4492
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 32 / 606.7503
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 4: Changes / Distsum = 20 / 600.5017
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 14 / 597.3448
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 6 / 596.5909
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 0 / 596.7076

    Elapsed time is 0.08 seconds.</code></pre>
<pre class="r"><code>pc_dtw5 &lt;- tsclust(l_SRF8_z, k = 5L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 8L,
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 670.696
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
Iteration 2: Changes / Distsum = 83 / 584.9872
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 30 / 573.5762
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 14 / 571.5058
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 9 / 570.9038
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 6: Changes / Distsum = 7 / 570.5918
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 7 / 570.3472
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 1 / 570.2049
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum =  0 / 570.166

    Elapsed time is 0.11 seconds.</code></pre>
<pre class="r"><code>pc_dtw7 &lt;- tsclust(l_SRF8_z, k = 7L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 8L,
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 658.6697
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 2: Changes / Distsum = 93 / 569.0959
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 3: Changes / Distsum = 44 / 555.4464
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 18 / 551.7695
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 5 / 550.2864
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 12 / 549.6522
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 7: Changes / Distsum = 5 / 549.3066
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 4 / 549.0096
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 8 / 548.5317
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum =  8 / 547.939
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 8 / 547.1678
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 12: Changes / Distsum = 4 / 546.4228
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 13: Changes / Distsum = 2 / 546.5455
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum = 2 / 546.6194
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum = 0 / 546.5289

    Elapsed time is 0.19 seconds.</code></pre>
<pre class="r"><code># Prototypes for 4 clusters
plot(pc_dtw4)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-15-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for 5 clusters
plot(pc_dtw5)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-15-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for 7 clusters
plot(pc_dtw7)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-15-4.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="partial-clustering-methods---dtw_lb" class="section level4">
<h4>(2-2) partial clustering methods - DTW_lb</h4>
<p>cross-distance matrix is NOT symmetric, which can be problematic for</p>
<pre class="r"><code># DTW_lb distance method
pc_dtwlb &lt;- tsclust(l_SRF8_z, k = 2L:10L,
  distance = &quot;dtw_lb&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 4L,
  control = partitional_control(pam.precompute = FALSE),
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 837.7735
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 2: Changes / Distsum = 40 / 677.2462
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 3: Changes / Distsum = 12 / 673.1021
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 4: Changes / Distsum = 3 / 672.5112
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 1 / 672.2699
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 2 / 672.1298
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 3 / 672.1824
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum =  1 / 671.834
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 9: Changes / Distsum = 5 / 671.8343
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 10: Changes / Distsum = 1 / 671.4003
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 11: Changes / Distsum = 0 / 671.2992

Iteration 1: Changes / Distsum = 424 / 713.1526
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
Iteration 2: Changes / Distsum = 59 / 644.9703
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 43 / 636.8731
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 4: Changes / Distsum = 13 / 632.2127
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 5: Changes / Distsum = 14 / 630.9387
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 9 / 629.7357
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 11 / 628.4192
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 8: Changes / Distsum = 1 / 627.2398
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 0 / 627.0085

Iteration 1: Changes / Distsum = 424 / 705.6913
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 2: Changes / Distsum = 133 / 632.8126
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 57 / 617.002
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 4: Changes / Distsum = 27 / 611.1268
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 5: Changes / Distsum = 20 / 609.7637
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 6: Changes / Distsum = 17 / 609.3526
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 7: Changes / Distsum = 13 / 609.1593
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 8: Changes / Distsum = 9 / 608.9651
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 13 / 609.2297
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
Iteration 10: Changes / Distsum = 12 / 608.6984
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 10 / 607.9724
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum =  6 / 607.386
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 13: Changes / Distsum = 10 / 607.1356
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 14: Changes / Distsum = 10 / 606.5816
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 15: Changes / Distsum = 5 / 605.9825
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 16: Changes / Distsum = 0 / 605.8668

Iteration 1: Changes / Distsum = 424 / 691.6497
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
Iteration 2: Changes / Distsum = 87 / 622.4207
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 57 / 596.9498
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 18 / 592.3744
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 11 / 591.9529
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 6: Changes / Distsum =  6 / 591.657
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 4 / 591.4229
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 3 / 590.8425
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 4 / 590.5225
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 4 / 590.1917
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 11: Changes / Distsum = 4 / 589.7865
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 12: Changes / Distsum = 4 / 589.4766
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 13: Changes / Distsum = 7 / 588.6399
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum =  4 / 587.936
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 15: Changes / Distsum = 5 / 587.5831
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 16: Changes / Distsum = 7 / 587.0608
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 17: Changes / Distsum = 5 / 586.1688
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 18: Changes / Distsum = 6 / 585.6281
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 19: Changes / Distsum = 5 / 585.2422
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 20: Changes / Distsum = 2 / 585.0732
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 21: Changes / Distsum = 3 / 585.0456
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 22: Changes / Distsum = 3 / 585.1037
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 23: Changes / Distsum = 0 / 585.0548

Iteration 1: Changes / Distsum = 424 / 642.5366
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
Iteration 2: Changes / Distsum = 52 / 574.976
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 33 / 568.8178
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 20 / 564.4819
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 5: Changes / Distsum = 22 / 561.7997
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 6: Changes / Distsum = 19 / 559.6681
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 5 / 558.3871
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 2 / 558.1468
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 1 / 558.0975
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 0 / 558.0752

Iteration 1: Changes / Distsum = 424 / 646.4274
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 2: Changes / Distsum = 105 / 593.2074
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 76 / 578.8887
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 4: Changes / Distsum = 50 / 569.6825
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 5: Changes / Distsum = 40 / 561.1869
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 28 / 556.7661
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 18 / 554.4278
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 8: Changes / Distsum = 19 / 551.1638
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 13 / 549.5969
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 13 / 547.8961
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 11: Changes / Distsum = 9 / 546.2824
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum =  9 / 545.445
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 7 / 544.8721
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 14: Changes / Distsum = 3 / 544.7822
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum = 5 / 544.6579
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 16: Changes / Distsum = 6 / 544.1657
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 17: Changes / Distsum = 4 / 543.6922
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 18: Changes / Distsum = 0 / 543.7148

Iteration 1: Changes / Distsum = 424 / 612.8833
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 2: Changes / Distsum = 72 / 574.3342
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 3: Changes / Distsum = 55 / 563.6968
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 45 / 554.3876
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 5: Changes / Distsum = 31 / 550.2312
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 36 / 547.3352
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 25 / 545.427
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 15 / 544.5716
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 10 / 544.2227
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 20 / 542.1422
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 11: Changes / Distsum = 11 / 539.8553
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum =  8 / 538.735
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 13 / 537.2757
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 14: Changes / Distsum = 12 / 536.8118
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum =  8 / 535.991
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 16: Changes / Distsum = 9 / 535.8227
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 17: Changes / Distsum = 7 / 535.4407
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 18: Changes / Distsum = 13 / 534.9361
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 19: Changes / Distsum = 1 / 535.0951
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 20: Changes / Distsum = 2 / 535.1217
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 21: Changes / Distsum = 1 / 535.1453
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 22: Changes / Distsum = 3 / 535.1157
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 23: Changes / Distsum = 2 / 534.9935
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 24: Changes / Distsum = 2 / 534.9358
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 25: Changes / Distsum = 3 / 534.9118
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 26: Changes / Distsum = 2 / 534.9833
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 27: Changes / Distsum = 0 / 535.0576

Iteration 1: Changes / Distsum = 424 / 605.2519
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 2: Changes / Distsum = 74 / 550.033
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 3: Changes / Distsum = 31 / 545.0757
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 24 / 541.6724
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum =  18 / 537.19
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 27 / 532.4771
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 27 / 527.3292
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 17 / 524.5549
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 12 / 522.9514
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 4 / 522.3964
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 4 / 521.8214
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum = 7 / 521.6429
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 5 / 521.5748
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum =  2 / 521.428
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum = 1 / 521.4018
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 16: Changes / Distsum = 1 / 521.3733
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 17: Changes / Distsum = 1 / 521.3657
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 18: Changes / Distsum = 2 / 521.3768
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 19: Changes / Distsum = 0 / 521.1723

Iteration 1: Changes / Distsum = 424 / 600.108
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1 - Converged!
Iteration 2: Changes / Distsum = 92 / 541.186
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 3: Changes / Distsum = 46 / 530.1588
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 39 / 521.523
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 5: Changes / Distsum = 33 / 516.3971
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 6: Changes / Distsum = 13 / 514.1648
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 15 / 512.8581
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 4 / 512.0193
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 1 / 511.7074
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum =  0 / 511.633

    Elapsed time is 2.17 seconds.</code></pre>
<pre class="r"><code>internal_CVI(pc_dtwlb, &quot;Partial clustering with DTW_lb distance&quot;)</code></pre>
<pre><code>    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-16-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 8 clusters
pc_dtwlb8 &lt;- tsclust(l_SRF8_z, k = 8L,
  distance = &quot;dtw_lb&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 4L,
  control = partitional_control(pam.precompute = FALSE),
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 656.7353
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 2: Changes / Distsum = 93 / 566.8099
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 3: Changes / Distsum = 41 / 553.2823
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 24 / 548.9263
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 18 / 547.0032
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 10 / 546.153
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 6 / 545.8056
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 5 / 545.7109
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 3 / 545.5889
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 3 / 545.5444
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 0 / 545.6608

    Elapsed time is 0.17 seconds.</code></pre>
<pre class="r"><code># Prototypes for 8 clusters
plot(pc_dtwlb8)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-16-2.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="partial-clustering-methods---k-shape" class="section level4">
<h4>(2-3) partial clustering methods - k-shape</h4>
<pre class="r"><code># k-shape method
pc_ks &lt;- tsclust(l_SRF8_z, k = 2L:10L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 127.8352
Iteration 2: Changes / Distsum = 31 / 84.35843
Iteration 3: Changes / Distsum = 9 / 81.47124
Iteration 4: Changes / Distsum = 6 / 80.31175
Iteration 5: Changes / Distsum = 8 / 79.82077
Iteration 6: Changes / Distsum = 10 / 79.34237
Iteration 7: Changes / Distsum = 6 / 78.92006
Iteration 8: Changes / Distsum = 9 / 78.66047
Iteration 9: Changes / Distsum =  9 / 78.3451
Iteration 10: Changes / Distsum =  2 / 78.2486
Iteration 11: Changes / Distsum = 3 / 78.24276
Iteration 12: Changes / Distsum = 0 / 78.24913

Iteration 1: Changes / Distsum = 424 / 91.63448
Iteration 2: Changes / Distsum = 57 / 73.75331
Iteration 3: Changes / Distsum = 34 / 71.78614
Iteration 4: Changes / Distsum = 20 / 71.08878
Iteration 5: Changes / Distsum = 18 / 70.63454
Iteration 6: Changes / Distsum = 11 / 70.37204
Iteration 7: Changes / Distsum = 12 / 70.27019
Iteration 8: Changes / Distsum = 11 / 70.17373
Iteration 9: Changes / Distsum =  6 / 70.1371
Iteration 10: Changes / Distsum = 5 / 70.12271
Iteration 11: Changes / Distsum = 1 / 70.13185
Iteration 12: Changes / Distsum = 0 / 70.13395

Iteration 1: Changes / Distsum = 424 / 79.99188
Iteration 2: Changes / Distsum = 59 / 70.77821
Iteration 3: Changes / Distsum = 37 / 67.79595
Iteration 4: Changes / Distsum = 39 / 65.41857
Iteration 5: Changes / Distsum = 26 / 64.0674
Iteration 6: Changes / Distsum = 17 / 63.53135
Iteration 7: Changes / Distsum = 18 / 63.03356
Iteration 8: Changes / Distsum = 15 / 62.81145
Iteration 9: Changes / Distsum = 9 / 62.65685
Iteration 10: Changes / Distsum = 9 / 62.57608
Iteration 11: Changes / Distsum = 2 / 62.54508
Iteration 12: Changes / Distsum = 1 / 62.51721
Iteration 13: Changes / Distsum = 2 / 62.50475
Iteration 14: Changes / Distsum = 1 / 62.50677
Iteration 15: Changes / Distsum = 0 / 62.50656

Iteration 1: Changes / Distsum = 424 / 80.28873
Iteration 2: Changes / Distsum = 63 / 67.43831
Iteration 3: Changes / Distsum = 60 / 65.1471
Iteration 4: Changes / Distsum = 43 / 63.34235
Iteration 5: Changes / Distsum = 29 / 62.35339
Iteration 6: Changes / Distsum = 21 / 61.62261
Iteration 7: Changes / Distsum = 20 / 61.01708
Iteration 8: Changes / Distsum = 15 / 60.4075
Iteration 9: Changes / Distsum = 13 / 59.97423
Iteration 10: Changes / Distsum = 6 / 59.69924
Iteration 11: Changes / Distsum = 6 / 59.67798
Iteration 12: Changes / Distsum = 5 / 59.60016
Iteration 13: Changes / Distsum = 5 / 59.50334
Iteration 14: Changes / Distsum = 3 / 59.44172
Iteration 15: Changes / Distsum =  5 / 59.3639
Iteration 16: Changes / Distsum =  6 / 59.1843
Iteration 17: Changes / Distsum = 5 / 59.11497
Iteration 18: Changes / Distsum = 3 / 59.07076
Iteration 19: Changes / Distsum = 2 / 59.05037
Iteration 20: Changes / Distsum = 1 / 59.03982
Iteration 21: Changes / Distsum = 1 / 59.03794
Iteration 22: Changes / Distsum = 1 / 59.03843
Iteration 23: Changes / Distsum = 0 / 59.03373

Iteration 1: Changes / Distsum = 424 / 66.70894
Iteration 2: Changes / Distsum = 55 / 57.57221
Iteration 3: Changes / Distsum = 37 / 55.71473
Iteration 4: Changes / Distsum = 16 / 54.99563
Iteration 5: Changes / Distsum = 5 / 54.83773
Iteration 6: Changes / Distsum =  4 / 54.7453
Iteration 7: Changes / Distsum = 5 / 54.61884
Iteration 8: Changes / Distsum = 3 / 54.54992
Iteration 9: Changes / Distsum = 2 / 54.50298
Iteration 10: Changes / Distsum = 4 / 54.49187
Iteration 11: Changes / Distsum = 4 / 54.43837
Iteration 12: Changes / Distsum = 4 / 54.37353
Iteration 13: Changes / Distsum = 1 / 54.33473
Iteration 14: Changes / Distsum = 1 / 54.31347
Iteration 15: Changes / Distsum = 0 / 54.31179

Iteration 1: Changes / Distsum = 424 / 69.42148
Iteration 2: Changes / Distsum = 83 / 60.8033
Iteration 3: Changes / Distsum = 61 / 57.98168
Iteration 4: Changes / Distsum = 41 / 55.24823
Iteration 5: Changes / Distsum = 25 / 54.12382
Iteration 6: Changes / Distsum = 19 / 53.61069
Iteration 7: Changes / Distsum = 12 / 53.24575
Iteration 8: Changes / Distsum = 6 / 53.07515
Iteration 9: Changes / Distsum = 7 / 53.00589
Iteration 10: Changes / Distsum = 7 / 52.89861
Iteration 11: Changes / Distsum = 3 / 52.81761
Iteration 12: Changes / Distsum = 9 / 52.70754
Iteration 13: Changes / Distsum = 7 / 52.38418
Iteration 14: Changes / Distsum = 8 / 52.22399
Iteration 15: Changes / Distsum = 8 / 52.12492
Iteration 16: Changes / Distsum = 3 / 52.01335
Iteration 17: Changes / Distsum = 6 / 51.95592
Iteration 18: Changes / Distsum = 7 / 51.90004
Iteration 19: Changes / Distsum = 6 / 51.83915
Iteration 20: Changes / Distsum = 3 / 51.69992
Iteration 21: Changes / Distsum = 5 / 51.65069
Iteration 22: Changes / Distsum = 2 / 51.60975
Iteration 23: Changes / Distsum = 1 / 51.58112
Iteration 24: Changes / Distsum = 0 / 51.57497

Iteration 1: Changes / Distsum = 424 / 63.5389
Iteration 2: Changes / Distsum = 80 / 54.96947
Iteration 3: Changes / Distsum = 67 / 51.2042
Iteration 4: Changes / Distsum = 41 / 49.37241
Iteration 5: Changes / Distsum = 26 / 48.53739
Iteration 6: Changes / Distsum = 11 / 48.2218
Iteration 7: Changes / Distsum = 10 / 48.09409
Iteration 8: Changes / Distsum = 6 / 47.99314
Iteration 9: Changes / Distsum = 5 / 47.95021
Iteration 10: Changes / Distsum =  2 / 47.9402
Iteration 11: Changes / Distsum = 3 / 47.93425
Iteration 12: Changes / Distsum = 3 / 47.91191
Iteration 13: Changes / Distsum = 2 / 47.89456
Iteration 14: Changes / Distsum = 3 / 47.88037
Iteration 15: Changes / Distsum = 1 / 47.86614
Iteration 16: Changes / Distsum = 1 / 47.86509
Iteration 17: Changes / Distsum = 1 / 47.85159
Iteration 18: Changes / Distsum = 1 / 47.83419
Iteration 19: Changes / Distsum = 4 / 47.83091
Iteration 20: Changes / Distsum = 4 / 47.80601
Iteration 21: Changes / Distsum = 0 / 47.77499

Iteration 1: Changes / Distsum = 424 / 59.57675
Iteration 2: Changes / Distsum = 53 / 50.64901
Iteration 3: Changes / Distsum = 34 / 48.83143
Iteration 4: Changes / Distsum = 19 / 47.77401
Iteration 5: Changes / Distsum = 16 / 47.15763
Iteration 6: Changes / Distsum = 9 / 46.79344
Iteration 7: Changes / Distsum = 12 / 46.58196
Iteration 8: Changes / Distsum = 13 / 46.30513
Iteration 9: Changes / Distsum = 8 / 46.02839
Iteration 10: Changes / Distsum = 9 / 45.88055
Iteration 11: Changes / Distsum = 6 / 45.78132
Iteration 12: Changes / Distsum = 8 / 45.71217
Iteration 13: Changes / Distsum = 8 / 45.64266
Iteration 14: Changes / Distsum = 3 / 45.58355
Iteration 15: Changes / Distsum = 2 / 45.55463
Iteration 16: Changes / Distsum =  1 / 45.5514
Iteration 17: Changes / Distsum = 1 / 45.54965
Iteration 18: Changes / Distsum = 1 / 45.53893
Iteration 19: Changes / Distsum = 2 / 45.52778
Iteration 20: Changes / Distsum = 2 / 45.49593
Iteration 21: Changes / Distsum = 1 / 45.47808
Iteration 22: Changes / Distsum = 0 / 45.47592

Iteration 1: Changes / Distsum = 424 / 61.51845
Iteration 2: Changes / Distsum = 86 / 51.21426
Iteration 3: Changes / Distsum = 40 / 48.23107
Iteration 4: Changes / Distsum = 39 / 47.11085
Iteration 5: Changes / Distsum = 27 / 46.24415
Iteration 6: Changes / Distsum = 24 / 45.55183
Iteration 7: Changes / Distsum = 22 / 45.09483
Iteration 8: Changes / Distsum = 10 / 44.54623
Iteration 9: Changes / Distsum = 7 / 44.36281
Iteration 10: Changes / Distsum = 4 / 44.25711
Iteration 11: Changes / Distsum = 4 / 44.18221
Iteration 12: Changes / Distsum =  3 / 44.1342
Iteration 13: Changes / Distsum = 2 / 44.11238
Iteration 14: Changes / Distsum = 2 / 44.10935
Iteration 15: Changes / Distsum = 2 / 44.09725
Iteration 16: Changes / Distsum = 0 / 44.09232

    Elapsed time is 5.95 seconds.</code></pre>
<pre class="r"><code>internal_CVI(pc_ks, &quot;Partial clustering with k-shape method&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-17-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 3 or 4 clusters
pc_ks3 &lt;- tsclust(l_SRF8_z, k = 3L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 108.647
Iteration 2: Changes / Distsum = 56 / 76.80189
Iteration 3: Changes / Distsum = 30 / 73.50964
Iteration 4: Changes / Distsum = 27 / 72.39893
Iteration 5: Changes / Distsum = 26 / 71.5724
Iteration 6: Changes / Distsum = 22 / 70.87693
Iteration 7: Changes / Distsum = 24 / 70.38391
Iteration 8: Changes / Distsum = 18 / 69.87478
Iteration 9: Changes / Distsum = 7 / 69.50894
Iteration 10: Changes / Distsum = 7 / 69.41389
Iteration 11: Changes / Distsum = 5 / 69.36102
Iteration 12: Changes / Distsum = 4 / 69.30983
Iteration 13: Changes / Distsum = 1 / 69.29236
Iteration 14: Changes / Distsum =  0 / 69.2913

    Elapsed time is 0.61 seconds.</code></pre>
<pre class="r"><code>pc_ks4 &lt;- tsclust(l_SRF8_z, k = 4L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 76.5106
Iteration 2: Changes / Distsum = 32 / 67.07705
Iteration 3: Changes / Distsum = 20 / 65.07166
Iteration 4: Changes / Distsum = 10 / 64.62115
Iteration 5: Changes / Distsum = 12 / 64.41459
Iteration 6: Changes / Distsum = 11 / 64.21979
Iteration 7: Changes / Distsum = 5 / 64.07669
Iteration 8: Changes / Distsum = 3 / 64.07443
Iteration 9: Changes / Distsum = 4 / 64.06104
Iteration 10: Changes / Distsum = 2 / 64.05042
Iteration 11: Changes / Distsum = 2 / 64.05731
Iteration 12: Changes / Distsum = 7 / 64.01087
Iteration 13: Changes / Distsum = 5 / 63.88928
Iteration 14: Changes / Distsum = 7 / 63.50889
Iteration 15: Changes / Distsum = 10 / 63.1806
Iteration 16: Changes / Distsum = 10 / 62.96688
Iteration 17: Changes / Distsum = 12 / 62.79098
Iteration 18: Changes / Distsum = 17 / 62.53946
Iteration 19: Changes / Distsum = 20 / 62.20188
Iteration 20: Changes / Distsum = 11 / 61.93916
Iteration 21: Changes / Distsum = 11 / 61.83186
Iteration 22: Changes / Distsum = 12 / 61.69036
Iteration 23: Changes / Distsum = 9 / 61.54638
Iteration 24: Changes / Distsum = 8 / 61.40556
Iteration 25: Changes / Distsum = 7 / 61.29195
Iteration 26: Changes / Distsum = 5 / 61.21528
Iteration 27: Changes / Distsum = 6 / 61.15293
Iteration 28: Changes / Distsum = 6 / 61.08039
Iteration 29: Changes / Distsum = 2 / 61.04132
Iteration 30: Changes / Distsum = 1 / 61.03316
Iteration 31: Changes / Distsum = 2 / 61.02398
Iteration 32: Changes / Distsum = 1 / 61.01079
Iteration 33: Changes / Distsum = 0 / 61.00639

    Elapsed time is 1.4 seconds.</code></pre>
<pre class="r"><code>pc_ks5 &lt;- tsclust(l_SRF8_z, k = 5L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 74.85699
Iteration 2: Changes / Distsum = 65 / 63.46492
Iteration 3: Changes / Distsum = 46 / 60.69721
Iteration 4: Changes / Distsum = 23 / 59.59166
Iteration 5: Changes / Distsum = 16 / 59.15221
Iteration 6: Changes / Distsum = 6 / 58.96142
Iteration 7: Changes / Distsum = 4 / 58.94024
Iteration 8: Changes / Distsum = 3 / 58.92438
Iteration 9: Changes / Distsum = 7 / 58.92885
Iteration 10: Changes / Distsum =  8 / 58.8633
Iteration 11: Changes / Distsum =  5 / 58.7412
Iteration 12: Changes / Distsum = 3 / 58.71087
Iteration 13: Changes / Distsum = 5 / 58.70122
Iteration 14: Changes / Distsum = 8 / 58.67248
Iteration 15: Changes / Distsum = 4 / 58.62334
Iteration 16: Changes / Distsum = 7 / 58.54815
Iteration 17: Changes / Distsum = 8 / 58.33184
Iteration 18: Changes / Distsum = 6 / 58.20243
Iteration 19: Changes / Distsum =  2 / 58.0072
Iteration 20: Changes / Distsum =  4 / 57.9674
Iteration 21: Changes / Distsum =  5 / 57.9328
Iteration 22: Changes / Distsum = 2 / 57.88911
Iteration 23: Changes / Distsum = 0 / 57.87923

    Elapsed time is 1 seconds.</code></pre>
<pre class="r"><code># Prototypes for 3 clusters
plot(pc_ks3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-17-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for 4 clusters
plot(pc_ks4)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-17-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for 5 clusters
plot(pc_ks5)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-17-4.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="partial-clustering-methods---tadpole" class="section level4">
<h4>(2-4) partial clustering methods - Tadpole</h4>
<p>problematic for our dataset (series’ cross-distance matrix is NOT symmetric)</p>
<pre class="r"><code># Tadpole method
pc_tp &lt;- tsclust(l_SRF8_z, k = 2L:10L, type = &quot;t&quot;,
  seed = 8, trace = TRUE,
  control = tadpole_control(dc = 1.5,
  window.size = 4L))</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 12.7%
Performing cluster assignment

TADPole completed for k = 2 &amp; dc = 1.5
TADPole completed for k = 3 &amp; dc = 1.5
TADPole completed for k = 4 &amp; dc = 1.5
TADPole completed for k = 5 &amp; dc = 1.5
TADPole completed for k = 6 &amp; dc = 1.5
TADPole completed for k = 7 &amp; dc = 1.5
TADPole completed for k = 8 &amp; dc = 1.5
TADPole completed for k = 9 &amp; dc = 1.5
TADPole completed for k = 10 &amp; dc = 1.5

    Elapsed time is 0.39 seconds.</code></pre>
<pre class="r"><code>internal_CVI(pc_tp, &quot;Partial clustering with Tadpole method&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-18-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 8 clusters
pc_tp8 &lt;- tsclust(l_SRF8_z, k = 8L, type = &quot;t&quot;,
  seed = 8, trace = TRUE,
  control = tadpole_control(dc = 1.5,
  window.size = 4L))</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 12.7%
Performing cluster assignment

TADPole completed for k = 8 &amp; dc = 1.5

    Elapsed time is 0.29 seconds.</code></pre>
<pre class="r"><code># Prototypes for 8 clusters
plot(pc_tp8)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-18-2.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="rain-analysis-rhythmicity-analysis-incorporating-non-parametric-methods" class="section level3">
<h3>6. RAIN analysis (Rhythmicity Analysis Incorporating Non-parametric methods)</h3>
<pre class="r"><code># setting our data into input format
df_8 &lt;- df_filt8 %&gt;% filter(Depth==&#39;SRF&#39;) %&gt;% select(Peptide_id,Time,log2_ave_intensity)

# reshape the dataframe with timepoints
library(maditr)
v_names &lt;- c(&quot;T1&quot;,&quot;T2&quot;,&quot;T3&quot;,&quot;T4&quot;,&quot;T5&quot;,&quot;T6&quot;,&quot;T7&quot;,&quot;T8&quot;)
df_8$Time &lt;- factor(df_8$Time, levels=v_names)
dc_8 &lt;- dcast(df_8, Peptide_id ~ Time, value.var = &quot;log2_ave_intensity&quot;)
# make Peptide_id more simpler (Pep_1 -&gt; 1)
dc_8$Peptide_id &lt;- str_replace(dc_8$Peptide_id,&quot;Pep_&quot;,&quot;P.&quot;)
# make first column into row name
dc_8 &lt;- tibble::column_to_rownames(dc_8, var=&quot;Peptide_id&quot;)

t(dc_8) %&gt;% head</code></pre>
<pre><code>          P.1        P.10      P.100      P.101      P.102      P.103
T1 -1.0453876 -0.26057924 -1.0143509 -0.8317648 -0.9829509 -0.6658099
T2 -0.5618940 -0.03474568 -0.4049560 -0.4653076 -0.4806841 -0.2152961
T3 -0.8833514 -0.12536825 -0.6901525 -0.7990762 -0.8958779 -0.6607146
T4 -0.4816502 -0.11104262 -0.4837968 -0.5977718 -0.4934429 -0.3043880
T5 -0.6294670 -0.28277123 -0.6024637 -0.6378048 -0.6268050 -0.5047989
T6 -0.6177759  0.19692425 -0.4844288 -0.6321670 -0.7666261 -0.6726476
         P.104      P.105       P.106      P.107       P.108      P.109
T1 -0.57279154 -0.5301071 -0.34372408 -0.9754704 -0.03894755 -0.7249617
T2 -0.09691295 -0.1251783  0.15368891 -0.4866671  0.12467430 -0.3627370
T3 -0.45706630 -0.2904050  0.09577283 -0.7967290 -0.13788364 -0.6715219
T4 -0.23284068 -0.1791823  0.57104674 -0.4752546 -0.09026565 -0.4997971
T5 -0.27535205 -0.1286187  0.44861791 -0.6840575  0.03121187 -0.5536551
T6 -0.27154381 -0.0990272  0.23928404 -0.6023233  0.07918491 -0.4451320
           P.11     P.110      P.111       P.112       P.113      P.114
T1 -0.321120764 0.5068092 -1.6098003 -0.83785517 -0.26946844 -0.6726125
T2  0.003721000 0.5446791 -0.7651968 -0.13141587  0.07481852 -0.2053318
T3 -0.203228013 0.3493607 -0.8397248 -0.64220908 -0.11065331 -0.5422976
T4  0.004395147 0.5918475 -0.0696760  0.07392372  0.08270836 -0.3306332
T5  0.093410625 0.4249019 -0.2568937 -0.38967381  0.23744790 -0.3361315
T6 -0.038512262 0.2203005 -0.9793996 -0.35099017 -0.13869080 -0.3822199
        P.116       P.117       P.118         P.12      P.120      P.121
T1 -0.8239160 -1.06367644 -0.47758741 -0.294505787 -0.8091724 -0.9400446
T2 -0.2814528 -0.28008555 -0.08873231  0.067263285 -0.2805512 -0.5370530
T3 -0.5560117 -0.03415438 -0.14883719 -0.081737678 -0.7720590 -0.9879733
T4 -0.2836463  0.70531396 -0.08415782 -0.005849915 -0.2921928 -0.5075198
T5 -0.3358911  0.49591533 -0.02170220  0.098514795 -0.4400185 -0.6391697
T6 -0.5834200  0.04392846 -0.04253549  0.019108686 -0.3998282 -1.0286091
         P.122      P.123        P.124      P.125        P.126       P.127
T1  0.09551623 -0.1591971 -0.477335260 -1.0834906 -0.245307039 -0.36919920
T2  0.09734635 -0.3065255 -0.009761818 -0.6697323 -0.007092971 -0.08774467
T3  0.08467194 -0.1046050 -0.196986037 -1.0563858 -0.372008262 -0.17069556
T4  0.32494014 -0.1240981 -0.003863750 -0.6724888 -0.349546484  0.06781162
T5  0.43555697  0.2329094  0.057073105 -0.3794314 -0.609488513  0.21302798
T6 -0.08543362 -0.1640625 -0.203439127 -0.7296695 -0.458246892 -0.01603113
          P.128       P.129       P.13        P.130       P.131       P.132
T1 -0.548241858 -0.24901282 -0.3677829 -0.094462397 -0.46306454 -0.52110983
T2 -0.002523651  0.02120456 -0.1714880 -0.036357748 -0.18638996 -0.23048658
T3 -0.314535433 -0.21588680 -0.1793528 -0.246699474 -0.16405758 -0.41671786
T4 -0.079986771  0.39405326 -0.2920643  0.202755512 -0.12078608  0.07048288
T5 -0.070025910  0.29611873 -0.1866017  0.103013896  0.07291394 -0.31030935
T6 -0.133177471 -0.14657324 -0.1072261 -0.009393561 -0.27978053 -0.64262765
       P.133       P.134       P.135      P.136      P.137      P.138
T1 0.6004971 -0.32444541 -0.33470305 -0.8555562 -0.3198131 -0.8780245
T2 0.5084590 -0.07668956 -0.11917068 -0.3128457  0.1251773 -0.3092127
T3 0.5144312 -0.25717477 -0.15416514 -0.6698615  0.5839826 -1.0459999
T4 0.4173884 -0.14758095 -0.01725573 -0.2206582  1.0088148 -0.6671231
T5 0.6381687  0.10272525 -0.36100120 -0.4558336  1.1607134 -0.5194117
T6 0.3480713 -0.26672071 -0.09584823 -0.9332923  0.8070943 -0.7238475
        P.139        P.14      P.140      P.141      P.142       P.143
T1 -0.6560311 -0.46845380 -0.5975564 -0.5744649 -0.8162821 -0.53557799
T2 -0.3938871  0.05663258 -0.1523198 -0.1933908 -0.5529535 -0.15472992
T3 -0.5709264 -0.20798535 -0.3897442 -0.4182257 -0.8854529 -0.51879718
T4  0.1746623 -0.01640640 -0.1031721 -0.2294199 -0.4216772 -0.16650319
T5 -0.2587000 -0.12820428 -0.2004209 -0.2464688 -0.2813192  0.03823977
T6 -0.8571208 -0.07249961 -0.2734070 -0.6412213 -1.0552517 -0.12083408
         P.145       P.146       P.147      P.148     P.149        P.15
T1 -0.55798416 -0.43795382 -0.23483558 -0.7268952 -2.019363 -0.47852600
T2 -0.19898437 -0.10809463 -0.01646902 -0.1065666 -1.892339 -0.05392158
T3 -0.48185655 -0.19816454 -0.36740542 -0.0758675 -2.074560 -0.26925619
T4 -0.20251878 -0.08893185  0.15463918  0.2178399 -2.156826 -0.07740637
T5  0.09791144 -0.04788161 -0.27278029 -0.2680583 -1.908014  0.01245936
T6 -0.42822901 -0.07151667 -0.08193591 -0.4877827 -2.128428  0.02866251
          P.151        P.152      P.153       P.154       P.155       P.156
T1 -0.625614193 -0.500598642 -0.8219013 -0.43631608 -0.36651507 -0.60663099
T2  0.008365184 -0.007410431 -0.6003282 -0.05036387  0.07637746 -0.23653774
T3 -0.186339061 -0.396284797 -0.6980623 -0.20703819 -0.07777840 -0.24573112
T4  0.151498581 -0.044077309 -0.4492911  0.02266782  0.15684360 -0.09671347
T5  0.049773333 -0.071362310 -0.3180559  0.05129708  0.26775432 -0.07762086
T6 -0.159296973 -0.224634997 -0.5884437 -0.21965180 -0.01177398 -0.40822652
        P.157        P.158      P.159        P.16       P.160       P.161
T1 -0.3583943 -0.005639208 -0.9562667 -0.28068651 -0.65281102 -0.24285599
T2 -0.2865419  0.293731817 -0.5896662  0.12207471  0.04375516  0.03152115
T3 -0.7748885  0.042106096 -0.7635526 -0.17977499 -0.36503233 -0.24755540
T4 -0.5727049  0.264658773 -0.4290607  0.07353696 -0.39429475 -0.12870330
T5 -0.5601155  0.005450734 -0.4525929 -0.06042190 -0.30347637 -0.10763603
T6 -0.5527972  0.148377472 -0.9189873 -0.01538129 -0.39297352 -0.14124185
        P.162       P.163       P.164      P.165       P.167        P.168
T1 -0.7519948 -0.18793856 -0.36682563 -0.5610429  0.02287792 -0.400586985
T2 -0.3695270  0.01698970 -0.27090356 -0.1470653 -0.06133788 -0.089103026
T3 -0.5545218 -0.19284861 -0.16906640 -0.6218618  0.35180475 -0.298382233
T4 -0.2720266  0.01560548 -0.20859676 -0.5610308  0.19914626 -0.187771945
T5 -0.3281983 -0.01256982 -0.05978918 -0.3460990  1.62626484 -0.004625279
T6 -0.6345714 -0.06814335 -0.33591929 -0.4016481 -0.98492634 -0.324943023
         P.169       P.17      P.170        P.171      P.172      P.173
T1 -0.72162413 -0.5923399 -0.4897311  0.247541538 -1.0388422 -0.5327181
T2 -0.34606521 -0.1555421 -0.1538035 -0.042205190 -0.6299756 -0.1165121
T3 -0.48696209 -0.3979568 -0.5129277 -0.254666790 -1.0913529 -0.2985524
T4 -0.29651937 -0.3284097 -0.1303343 -0.361340805 -0.5774038 -0.3454546
T5 -0.32362236 -0.2653519 -0.2544366  0.017088480 -0.6594046 -0.1785467
T6 -0.08165521 -0.1843027 -0.5510481  0.004896414 -0.9536299 -0.4857752
         P.175      P.176        P.177      P.178       P.179        P.18
T1 -0.31007697 -0.7709433 -0.547975874 -1.1653708 -0.31918277 -0.54825077
T2 -0.21941622 -0.3132882  0.195591619 -0.6831558 -0.18147077  0.03778584
T3 -0.10505839 -0.4293273  0.047753720 -0.9656198 -0.29916734  0.19821672
T4 -0.01665550 -0.2580012  0.246278326 -0.6893047 -0.04712607  1.04539016
T5 -0.15541975 -0.1441313 -0.044330875 -0.8926146 -0.18989196  1.02184679
T6 -0.05830447 -0.3369388 -0.002969375 -1.2674399 -0.14642252  0.40071027
         P.180      P.181      P.182       P.183       P.184       P.187
T1 -0.26631428 -0.9239532 -0.8455098 -0.03877315 -0.39091191 -0.36547840
T2  0.15778215 -0.6528992 -0.2456235  0.25680447 -0.25834303 -0.07649456
T3 -0.37638956 -0.6815149 -0.6251730 -0.03513287 -0.40924792 -0.30367141
T4 -0.02024047 -0.4678549 -0.2366003  0.16337787 -0.02026267 -0.04320397
T5 -0.19723379 -0.3713716 -0.4957247  0.15642872 -0.08806596  0.20011791
T6 -0.18445048 -0.8139680 -0.3573198  0.25559491 -0.17159933 -0.13503107
         P.188         P.19      P.191        P.193       P.194      P.196
T1 -0.67195697 -0.366053012 -0.8978573 -0.761113956 -0.32885049 -0.9580187
T2 -0.28202936 -0.087124996 -0.5055711 -0.603301973 -0.08276554 -0.4363703
T3 -0.77176714 -0.166113702 -0.7435255 -0.743720617 -0.45255683 -1.0265478
T4 -0.10170601  0.002183897 -0.4822187 -0.007870168  0.13149490 -0.7456004
T5 -0.04947751 -0.059324653 -0.5457992 -0.398423062  0.12450647 -0.7241048
T6 -0.50012107 -0.036966621 -0.7865231 -0.796439385 -0.51167010 -0.8361970
        P.198      P.199         P.2        P.20      P.201       P.202
T1 -1.0923558 -0.7480296 -0.34438421 -0.50690514 -0.8757399 -0.58848195
T2 -0.3735074 -0.3286794 -0.04041118 -0.00209271 -0.3185969 -0.06907909
T3 -0.6302880 -0.4353040 -0.31218852 -0.28597946 -1.1285855  0.03942113
T4 -0.4410128 -0.3204666 -0.31924971  0.09557231 -0.4582154  0.39506248
T5 -0.3550520 -0.5052510 -0.48290105 -0.21814293 -0.3230820  0.12289996
T6 -1.0031494 -0.4808226 -0.06961178 -0.41021397 -0.7536515 -0.07874693
         P.203      P.204        P.205      P.208      P.209       P.21
T1 -0.84333378 -0.9899692 -0.389012295 -1.1514661 -0.8477889 -0.7938158
T2 -0.06395741 -0.4349326 -0.008723976 -0.4592425 -0.2439684 -0.3651405
T3 -0.43781621 -0.4412674 -0.263850304 -0.8532851 -0.4292535 -0.5465462
T4 -0.08331764  0.1409874 -0.055485381 -0.1798036 -0.2829366 -0.2010369
T5 -0.16172208  0.5317645  0.113985088 -0.5797169 -0.1325034 -0.2893602
T6 -0.27847101 -0.0226270 -0.299262758 -0.9711405 -0.4788141 -0.3885357
         P.210       P.211      P.212      P.213      P.214      P.215
T1 -0.56539459 -0.41360901 -0.7184889 -0.9861060 -0.6353695 -0.4520660
T2 -0.01676613 -0.02204735 -0.3431040 -0.4318320 -0.3022961 -0.2258121
T3 -0.42598020 -0.08300564 -0.9200014 -0.8901220 -0.7792001 -0.2695389
T4 -0.04012639  0.44776516 -0.5640700 -0.4222009 -0.5864240 -0.1506260
T5  0.03191539  0.48957248 -0.6827738 -0.5607619 -0.5810184 -0.1010726
T6 -0.29149500 -0.10482101 -0.4826613 -0.9330717 -0.7141851 -0.1710028
        P.216      P.217       P.218      P.219        P.22       P.220
T1 0.35330351 -1.2343857 -0.44152923 -0.6243615 -0.51135868 -0.69361010
T2 0.96559603 -0.4075173 -0.14283715 -0.3935107  0.01101818 -0.02169774
T3 0.06663746 -0.4711806  0.11392104 -0.7260993 -0.19215674 -0.42069611
T4 1.55299982 -0.6260560  0.07393293 -0.5162971 -0.03945653 -0.11197228
T5 2.45604490 -0.3974950  0.08271102 -0.4561907 -0.19907707  0.23183539
T6 1.32009351 -0.5796337 -0.33853273 -0.5760533 -0.02593112 -0.28712296
        P.221       P.224      P.226      P.227      P.229        P.23
T1 -0.8648411 -0.39397005 -0.2218076 -0.7054853 -0.6913419 -0.39585750
T2 -0.4863458 -0.04902512 -0.1020160 -0.4324026 -0.2802031 -0.05050258
T3 -0.7835049 -0.31467539 -1.1054850 -0.6428378 -0.5993844 -0.26842435
T4 -0.7404796 -0.25734261 -0.1945368 -0.4530355 -0.2339258 -0.13298793
T5 -0.5457975  0.28198862 -0.4993592 -0.5201120 -0.3582536 -0.09712209
T6 -0.7063975 -0.23913084 -0.1424451 -0.5149362 -0.6378868 -0.08339498
        P.230      P.233       P.235      P.236      P.237      P.238
T1 -0.7364498 -0.2477097 -0.92833486 -0.6741615 -0.7910659 -0.9148947
T2 -0.1406928  0.1446455 -0.35529666 -0.4773717 -0.3070140 -0.3709765
T3 -0.5443483  0.0355987 -0.27262904 -0.3225421 -0.8748593 -0.8421746
T4 -0.1158205  0.1976911  0.50801230  0.0680453 -0.2769750 -0.6705578
T5 -0.2620575  0.1533082  0.72349130 -0.2834249 -0.4275121 -0.6787063
T6 -0.4175346  0.3159444  0.02811449 -0.4137935 -0.7589847 -0.8997163
          P.24      P.240        P.241       P.242      P.243      P.246
T1 -0.57255711 -0.8538865 -0.181048526 0.004501653 -0.8299391 -1.0183314
T2 -0.07009962 -0.3077621  0.001307105 0.253105686 -0.3534030 -0.5780482
T3 -0.31010408 -0.7626894 -0.073697925 0.121263494 -0.5802675 -0.8070953
T4 -0.08769213 -0.1261845  0.025464241 0.075907215 -0.3581631 -0.4043955
T5 -0.18019512 -0.2196312  0.051287280 0.666072277 -0.4842860 -0.7783175
T6 -0.22552152 -0.5456985 -0.081959408 0.664564488 -0.6632964 -0.5677839
        P.247      P.248      P.249       P.25      P.250       P.251
T1 -1.0922821 -0.8467424 -0.6873279 -0.9347508 -0.8790332 -0.48991421
T2 -0.4181666 -0.8407300 -0.2599992 -0.3654766 -0.5352166 -0.02409316
T3 -1.0459729 -0.6373919 -0.5296830 -0.8635913 -0.6846082 -0.48297486
T4 -0.7562759 -0.2714491 -0.2995321 -0.4936830 -0.3513203 -0.40842793
T5 -0.6012349 -0.6686207 -0.3668619 -0.5737563 -0.3484147 -0.19433078
T6 -1.0084323 -0.2650431 -0.5078675 -0.5557971 -0.5976245 -0.15662375
        P.252      P.253       P.255      P.256       P.257       P.258
T1 -0.9556292 -1.2508692 -0.44234055 -1.0352960 -0.64927159 -0.48577892
T2 -0.4429010 -0.4688726 -0.07045726 -0.4285134 -0.30296009  0.04831388
T3 -0.7064987 -1.0866211 -0.39430566 -0.3606579 -0.80633833 -0.21286372
T4 -0.3329362 -0.9094796 -0.09820068  0.7396992 -0.07829668  0.38882889
T5 -0.3839919 -1.2652925 -0.25653031  0.6668367 -0.73664333  0.52997328
T6 -0.5641911 -1.3533478 -0.32938094  0.2076982 -0.62200517 -0.08399486
         P.259         P.26       P.262      P.263       P.264      P.265
T1 -0.46015472 -0.601813673 -0.36987024 -0.2526400 -0.53794276 -0.3771886
T2 -0.14561299 -0.008988549 -0.10354697 -0.1761088 -0.01641383 -0.4707711
T3 -0.44913648 -0.402755689 -0.21837031 -0.5308661  0.55377689 -0.6180125
T4 -0.10387087 -0.120385802 -0.14981984 -0.2431680  1.04805968 -0.3672559
T5 -0.36602595 -0.166250520  0.05982829 -0.5147416  0.44550997 -0.3058606
T6 -0.06521653 -0.179943657 -0.32418956 -0.5324793  0.91232575 -0.3910257
        P.266      P.267       P.268      P.269       P.27      P.271
T1 -0.4442697 -0.6239661 -0.36599766 -0.9742396 -0.5104374 -0.8491810
T2 -0.3469879 -0.4971302 -0.04799722 -0.5303801 -0.1294605 -0.2969625
T3 -0.3045438 -0.6339007 -0.31380161 -0.8060840 -0.4532145 -0.6692885
T4 -0.1131696 -0.5577485 -0.14312595 -0.2858142 -0.1665647 -0.3904393
T5 -0.3782411 -0.7222951  0.10200870 -0.6447592 -0.2883921 -0.6966551
T6 -0.1247394 -0.4855046 -0.16958485 -0.8075446 -0.2478419 -0.3449275
        P.272      P.274      P.275      P.276      P.277      P.279       P.28
T1 -0.9800717 -0.7401184 -0.8739605 -1.1847134 -0.7291613 -0.5940051 -1.0191078
T2 -0.3950380 -0.3321087 -0.3280666 -0.4722336 -0.1985518 -0.1688116 -0.3870799
T3 -0.3173755 -0.6483104 -0.8028576 -0.8855193 -0.6727607 -0.8695064 -0.9004453
T4  0.1587799 -0.2776100 -0.4868099 -0.1959879 -0.1009515 -0.1223642 -0.4932344
T5  0.4608694 -0.3751976 -0.4275269 -0.5502217 -0.2056578 -0.4234567 -0.6731199
T6 -0.0965910 -0.7746891 -0.9002997 -1.0918615 -0.8098391 -0.4879567 -0.6636584
        P.280       P.281       P.282      P.283       P.285       P.286
T1 0.08733282 -0.59962864 -0.67997361 -0.3162140 -0.73609035 -0.22435867
T2 0.09434655  0.02721424 -0.10297889  0.1957351 -0.07010317 -0.01573962
T3 0.11512790 -0.26464883 -0.59654419 -0.1890773 -0.24562800  0.29587972
T4 0.13888553 -0.06709282  0.01540307  0.2061323 -0.18285485  0.03060054
T5 0.15174866  0.24892937 -0.13920330  0.2635703 -0.10966871  0.23559725
T6 0.10068892 -0.23227611 -0.35466105 -0.2072079 -0.45511259 -0.61789545
         P.287       P.288      P.289       P.29       P.290       P.291
T1 -0.49556861 -0.79550157 -0.9363062 -0.5455000 -0.44479840 -0.33801749
T2 -0.14178808 -0.10980353 -0.5727585 -0.2777099  0.04260252  0.11075352
T3 -0.50013598 -0.35622527 -0.7988294 -0.5346071 -0.41221838 -0.30741536
T4 -0.24164478 -0.06065325 -0.5064641 -0.5260263 -0.03342798 -0.23363140
T5 -0.06091411  0.01089603 -0.1404250 -0.3568090  0.11922807  0.20964024
T6 -0.39899143 -0.39237913 -0.7214746 -0.1993049 -0.34496944 -0.04731244
        P.292       P.294        P.295       P.297      P.298      P.299
T1 -1.1483421 -0.26303883 -0.678577584 -0.71402598 -0.6145451 -0.6186851
T2 -0.7174842 -0.01542150 -0.129423593 -0.04250527 -0.2855095 -0.1224433
T3 -0.9283395 -0.02586734 -0.272313619 -0.52465981 -0.4453512 -0.4125336
T4 -0.8807943  0.25532086 -0.136719999 -0.14097298 -0.3124786 -0.1885374
T5 -0.8504364  0.40393318  0.002186419  0.01265445 -0.3330226 -0.1213900
T6 -0.7185548 -0.40199938 -0.258745424 -0.44068477 -0.5672965 -0.2462210
          P.3        P.30      P.300      P.301      P.302       P.303
T1 -0.6726626 -0.73219928 -0.8299249 -0.5000730 -0.7768909 -0.55616822
T2 -0.1455197 -0.19331114 -0.3875852 -0.5293392 -0.3002482 -0.26965798
T3 -0.5106208 -0.12687629 -0.7771194 -0.4592850 -0.5955948 -0.44722996
T4 -0.2168220  0.48107996 -0.3158384 -0.3029623 -0.1810978 -0.25985138
T5 -0.2704619  0.41789416 -0.4870707 -0.1640658 -0.1569919 -0.04847384
T6 -0.2561029  0.08396952 -0.8593519 -0.5715304 -0.5480782 -0.34386135
        P.304      P.305       P.308        P.31       P.311        P.312
T1 -0.2468865 -0.8502419 -0.54381798 -0.35206113 -0.73893344  0.001511728
T2  0.2114468 -0.3201943 -0.12715681  0.50053158 -0.10376983 -0.552427001
T3 -0.2275800 -0.8941615 -0.19071930 -0.04432133 -0.49506851 -0.326844137
T4  0.1097146 -0.4898706 -0.07249432  0.23116684  0.34592154  0.049291397
T5  0.1200875 -0.4539529 -0.14837185  0.05323818  0.53576318 -0.103944332
T6 -0.1925296 -0.7088430 -0.55265479 -0.29015030 -0.03138384 -0.235143427
        P.313       P.314      P.315      P.316      P.317       P.318
T1 -1.0480083 -0.51088362 -0.2743983 -0.5343445 -0.9483194 -0.29959271
T2 -0.1944541  0.04500086 -0.3606844 -0.1732987 -0.4561788  0.05600667
T3 -0.6662250  0.33861582 -0.4717959 -0.3869511 -0.9470639 -0.24342710
T4 -0.3563500  1.35353236 -0.2976861 -0.2647530 -0.4090599  0.03871606
T5 -0.3451003  1.28145884 -0.3051678 -0.1449738 -0.1402231  0.01050442
T6 -1.1486605 -0.10647673 -0.2357312 -0.5829913 -0.7722364  0.02978960
         P.319       P.32      P.320      P.321      P.323      P.326
T1 -0.57857218 -0.7263295 -0.5991601 -0.6858768 -0.8673134 -0.4852441
T2  0.07782768 -0.3712206 -0.2563057 -0.4882407 -0.3493949 -0.2351178
T3 -0.22096353 -0.5989140 -0.6347874 -1.1556381 -0.6295227 -0.5081568
T4  0.14968949 -0.2416417 -0.2384018 -0.5608134 -0.2538375 -0.3877388
T5  0.07795349 -0.4113260 -0.3439808 -0.6782863 -0.3936706 -0.1539466
T6 -0.14006794 -0.3482188 -0.4374236 -0.5014876 -0.8783319 -0.4806899
        P.327       P.328      P.329      P.33       P.331       P.332
T1 -1.5745285 -0.38537831 -0.7644325 0.1866353 -0.20439487 -0.33028043
T2 -0.7910255 -0.15420081 -0.2088215 0.5091808  0.01375784 -0.79148710
T3 -0.7042922 -0.34817838 -0.6160904 0.2909784 -0.16875033 -0.27648503
T4 -0.2308184 -0.02586991 -0.3793413 0.4207897  0.02086776 -0.22455511
T5 -0.4135163  0.17865647 -0.2021711 0.5098857 -0.03145408 -0.03500101
T6 -0.5106429 -0.26820630 -0.5407022 0.5092885 -0.01933633 -0.18756316
        P.334       P.336      P.337       P.338      P.339        P.34
T1 -0.8564278 -1.39905585 -0.2391798 -0.53831297 -0.8806980 -0.23749023
T2 -0.3096087  0.05872214  0.2035693  0.03265034 -0.5591649  0.22092262
T3 -0.7076182  0.02726330  0.0463724 -0.35054442 -0.8593254 -0.15365979
T4 -0.2395321  0.12776857  0.1823350 -0.39357039 -0.4662307  0.01510278
T5 -0.4084063  0.30494596  0.1822758  0.13311304 -0.5532119  0.26989166
T6 -0.6975532  0.23093370 -0.4499326 -0.58167819 -1.0595464 -0.15697981
        P.340       P.341       P.342        P.343       P.344      P.345
T1 -0.2918280 -0.49552884 -0.92898617 -0.523751810 -1.06415118 -1.1306078
T2 -0.1010141 -0.19449674 -0.01220054  0.007067455 -0.39574605 -0.4917563
T3 -1.0650961 -0.46807039 -0.60403424 -0.393470129 -0.74656657 -0.9434483
T4 -0.1798326 -0.08594624 -0.69050039  0.207154813  0.05548442 -0.3997207
T5  0.0653422 -0.12555191 -0.32044941  0.045188858 -0.19447965 -0.5613617
T6 -0.3098934 -0.29363336 -0.45676081 -0.184034279 -0.77641364 -1.0118181
        P.346       P.347        P.349       P.35      P.350      P.351
T1 -0.4721618 -0.76443319 -0.218828093 -0.8149324 -0.8188480 -1.6246498
T2 -0.1075973 -0.08402653 -0.006738606 -0.2600780 -0.3595474  0.2930966
T3 -0.5403053 -0.73117960 -0.466881166 -0.5652580 -0.5601257  0.7119666
T4 -0.5905581 -0.17146919 -0.122357602 -0.2906523 -0.2779402  0.7947103
T5 -0.1590613 -0.33558521 -0.392624659 -0.5859734 -0.3957273  0.9344249
T6 -0.3903328 -0.06782642 -0.171348524 -0.4046224 -0.7431686  0.8968501
         P.352      P.355      P.356      P.357       P.358       P.36
T1 -2.10899368 -0.9063849 -0.7941874 -0.6361290  0.02353061 -0.9777621
T2 -0.28560804 -0.5434173 -0.1834062 -0.2137305  0.15699433 -0.2753159
T3  0.05569900 -0.5240709 -0.4550409 -0.5097200 -0.52502282 -0.9630859
T4  0.08863260 -0.2873059 -0.2481393 -0.2231905 -0.03646263 -0.5420529
T5  0.75462528 -0.7868168 -0.0661952 -0.1736427 -0.13952878 -0.6864845
T6  0.02465837 -0.7617946 -0.2479478 -0.4345857 -0.29725346 -0.5019534
        P.360      P.361      P.363       P.365       P.367      P.369
T1 -0.6798263 -0.7020258 -0.5648951 -1.02389001 -1.07998865 -1.1333051
T2 -0.3268746 -0.2664802 -0.2448382 -0.31437640  0.45179517 -0.7417386
T3 -0.8327767 -0.7748899 -0.4823191 -0.74105047 -0.09883531 -0.7301387
T4 -0.4922604 -0.2959987 -0.2082383 -0.50653307  0.52248925 -0.5515838
T5 -0.4146073 -0.3564995 -0.2197328  0.07024829  0.41881082 -0.1196001
T6 -0.4734659 -0.4420801 -0.6801194 -0.82972504 -0.54207388 -0.4830262
        P.370       P.373      P.374      P.375      P.377       P.38
T1 -0.6414308 -0.56972695 -1.7318770 -0.8208109 -0.9438112 -0.9492526
T2 -0.2689435 -0.19903698 -0.4166221 -0.1513862 -0.4896528 -0.6009241
T3 -0.5573216 -0.36179565 -0.9800827 -0.6904630 -0.7678964 -0.7097168
T4 -0.3450318 -0.12069554  0.2946781 -0.3515681 -0.2751925 -0.5179971
T5 -0.3883780 -0.19861114  0.1239467 -0.1835996 -0.6489568 -0.6697880
T6 -0.4455236 -0.07025221 -0.7311473 -0.5609347 -1.0640393 -0.4120860
         P.380       P.381        P.382       P.383       P.387      P.388
T1 -0.55642573 -1.07651397 -0.091067298 -0.76464619 -0.23349499 -0.9004721
T2 -0.03193395 -0.31864926  0.002052364  0.23868603 -0.06942569 -0.1522997
T3 -0.42559676 -0.62829717 -0.011742042 -0.18459688 -0.36999956 -0.2350001
T4  0.14147350 -0.21150950  0.056819504  0.06291438 -0.28839300 -0.2699400
T5  0.05252025 -0.07830091 -0.041065887  0.53637734 -0.08748219 -0.1323683
T6 -0.22712326 -0.55933164 -0.185479903 -0.07117354 -0.18164257 -0.5290828
         P.390       P.393         P.4       P.40      P.401       P.406
T1 -0.48609998 -0.63887913 -0.70912574 -0.7166506 -1.2336570 -0.26039072
T2 -0.09204134  0.04038714 -0.02302984 -0.3289531 -0.6440965  0.11887668
T3 -0.19269667 -0.12813870  0.11580367 -0.8593156 -0.9235909 -0.09973602
T4  0.01736095 -0.01113586  1.02144306 -0.4642856 -0.5588469  0.07535718
T5  0.20361127  0.27562076  0.95353940 -0.9959083 -0.4771497  0.02814912
T6 -0.62862453  0.10201747  0.48474775 -0.5047784 -1.2531283 -0.46015121
        P.407       P.408       P.41      P.417      P.419       P.42
T1 -0.6530825 -0.32676776 -0.7647676 -1.0642462 -0.6119101 -0.8686779
T2 -0.2084586 -0.04148842 -0.3736619 -0.4801498 -0.4112430 -0.7380716
T3 -0.4086719 -0.19418806 -0.5125160 -0.7166231 -0.9042906 -1.0116496
T4 -0.7276837  0.06503923 -0.1058966 -0.3718038 -0.6749678 -0.5880218
T5 -0.3577011  0.07817297 -0.2678321 -0.2509825 -0.2964697 -0.4086118
T6 -0.7942797 -0.19120435 -0.4380710 -0.5222823 -0.6543203 -0.6792359
         P.422       P.423      P.428        P.43      P.434     P.435
T1 -0.24226985 -0.80028749 -0.8623498 -0.13053641 -0.9208684 -1.467224
T2 -0.06295855 -0.37094738 -0.1561085  0.12816335 -0.5161158 -1.030864
T3 -0.34023183 -0.41639651 -0.4650931 -0.02275912 -1.2534332 -1.382630
T4 -0.07322682 -0.16420667 -0.4443436  0.03709233 -0.3705263 -1.125382
T5 -0.12862187  0.05297637 -0.1929423 -0.30942885 -0.6003503 -1.172956
T6 -0.28712824 -0.32240687 -0.5633492  0.19789077 -0.6091977 -1.250101
         P.436       P.437      P.440      P.441      P.445      P.447
T1 -0.52738859 -0.76650777 -1.0198664 -0.5404670 -0.1954380 -1.1676924
T2  0.09906214 -0.07799942 -0.5039113 -0.3076442  0.4921782 -0.6333095
T3 -0.36694700 -0.27318289 -0.3656267 -0.7773505  0.1681622 -0.9738675
T4 -0.14080652 -0.23339184 -0.2246049 -0.1928223  0.3612494 -0.2845013
T5 -0.06190500  0.08979374  0.0424167 -0.5375497  0.5060584 -0.3658446
T6 -0.18448338 -0.23843064 -0.2862689 -0.6844722  0.2804198 -0.7394388
        P.448       P.45       P.450       P.454       P.456         P.457
T1 -0.8763331 -0.5220129 -0.74592018 -0.91377245 -0.77392941 -0.5228701741
T2 -0.3464480 -0.1257654  0.11832639 -0.31595078 -0.29655798  0.0001940105
T3 -0.8165739 -0.4046217 -0.30873765 -0.91746962 -0.42155390 -0.3462363444
T4 -0.3631213 -0.0563774  0.05952127 -0.37258360 -0.11771315 -0.0819042368
T5 -0.4106473 -0.1965225  0.10928458 -0.09180013  0.05923149  0.1148053119
T6 -0.7225898 -0.1089298 -0.26449355 -0.67657692 -0.61852296 -0.2094058975
        P.459      P.46       P.460     P.461      P.462       P.463      P.465
T1 -1.0317654 0.5038323 -0.37958630 -1.549158 -1.1219867  0.03700058 -0.6504867
T2 -0.4291838 0.2809181 -0.11032219 -1.114164 -0.4926773 -0.11887842 -0.4251408
T3 -0.8529522 0.9727335 -0.54002604 -1.314180 -0.9870684 -0.03552705 -0.4267322
T4 -0.4226602 0.5351250 -0.13352698 -1.102216 -0.4835440 -0.14285261 -0.1319442
T5 -0.3585847 0.7819069  0.04657589 -1.131034 -0.6780689 -0.06059692 -0.3791989
T6 -0.7799970 0.9502870  0.01604878 -1.584879 -0.9306927 -0.05534898 -0.6056982
          P.466      P.467       P.47        P.473         P.477      P.478
T1 -0.550335371 -1.2949101 -0.7782403 -0.632273424 -0.6645527848 -0.6795008
T2 -0.243722908 -0.4556308 -0.3529652  0.052064538 -0.1918790392 -0.3915810
T3 -0.342431054 -1.0181127 -0.6128576 -0.377847634 -0.5921250254 -0.8663190
T4 -0.007127392 -0.4367276 -0.3809909 -0.007054821 -0.4867360188 -0.3723885
T5 -0.152737609 -0.3598614 -0.4856882  0.011899577 -0.0004644195 -0.5361793
T6 -1.047312772 -0.8615792 -0.3344368 -0.403566852 -0.5307247803 -0.8462986
        P.479       P.48      P.482       P.484      P.485      P.487
T1 -1.5085372 -1.0547364 -1.3752989 -1.28749645 -0.3377519 -1.0458303
T2 -0.4838986 -0.4466145 -0.5145666 -0.39507877 -0.2004348 -0.3908538
T3 -0.7053582 -0.9399275 -1.2890834 -0.50746937 -0.3877373 -0.6759126
T4  0.5408546 -0.4505329 -0.6262917 -0.06155867 -0.2591533 -0.3856246
T5  0.6791010 -0.6708069 -0.6847321 -0.06077910 -0.1728645 -0.5912217
T6 -0.2058277 -0.6971938 -0.9693758 -0.23934028 -0.2788572 -1.3017239
         P.49      P.491      P.494      P.496       P.497      P.498
T1 -0.5868564 -1.0777526 -0.7815017 -0.9757387 -1.28531594 -0.8787576
T2 -0.2601426 -1.1415631 -0.1865948 -0.2306964 -0.39266352 -0.5210504
T3 -0.4536978 -0.7698117 -0.9422783 -0.6394475 -0.40745886 -1.1534724
T4 -0.2721362 -0.7706075 -0.3289248 -0.1953322  0.07483661 -0.6837599
T5 -0.4146732 -0.6376344 -0.4182541 -0.2348761 -0.20648819 -0.7711657
T6 -0.3797099 -0.8107101 -0.9362005 -0.5974003 -1.10210874 -1.0363879
          P.5       P.50       P.502       P.505      P.506      P.51
T1 -0.6028922 -0.5046687 -0.10853658 -0.33166217 -0.7608145 0.5470061
T2 -0.1615516 -0.1588869  0.15407708  0.08491040 -0.3858942 0.2791323
T3 -0.3664218 -0.7040687 -0.18660549  0.21322989 -0.4671524 0.4643706
T4 -0.2047850 -0.5363382 -0.23754802  0.15783472 -0.2777654 0.9716447
T5 -0.2921886 -0.5036667 -0.08118276  0.04732946  0.3574705 0.9913739
T6 -0.1089927 -0.5613138 -0.25575154  0.04300626 -0.3648937 0.5233572
        P.511      P.513      P.519      P.52      P.520      P.521      P.522
T1 -1.3442157 -0.7572941 -1.3579189 -1.643091 -0.5745617 -0.5881077 -0.7118011
T2 -0.6646123 -0.4975705 -0.5342701 -1.209137 -0.1043883 -0.1076058 -0.3066376
T3 -1.0773019 -0.9593782 -0.1951235 -1.592060 -0.7056853 -0.5717429 -0.4212811
T4 -0.5602580 -0.9553000  1.0319938 -1.384160 -0.3223920 -0.1919871 -0.2054680
T5 -0.5680290 -0.4752271  0.6879435 -1.514584 -0.3794001  0.7392984 -0.2658185
T6 -1.1776384 -0.7069876 -0.3928460 -1.467102 -0.7450060 -0.8151574 -0.5208849
         P.526       P.53        P.530       P.533       P.535      P.537
T1 -0.93149992 -0.8580493 -0.915754780 -0.32192016 -0.60528097 -1.1377079
T2 -0.45561110 -0.4034396 -0.563017996 -0.25576689  0.05241747 -0.5286373
T3 -0.37096746 -0.7193805 -0.581120674 -0.32753458  0.02351885 -0.9561379
T4  0.06649284 -0.5623430 -0.006020053 -0.20170639  0.72904385 -0.4690134
T5 -0.29651075 -0.5052452  0.234221346  0.07457936  0.48435108 -0.6219408
T6 -1.03902087 -0.6568816  0.201284489 -0.23688199  0.11030125 -1.2104621
       P.539       P.54       P.541       P.542      P.543       P.55
T1 0.4042896 -0.8546989 -0.21780639 -0.46193532 -1.0188434 -0.4664108
T2 0.1322977 -0.3745885  0.06340608  0.00147722 -0.3923062  0.1117647
T3 0.2621508 -0.7564407 -0.08320829 -0.17305425 -0.6636331 -0.1459718
T4 0.2172881 -0.3967947 -0.02292761 -0.26024603 -0.4609226  0.0704334
T5 0.1794824 -0.6724697  0.16632465 -0.09335736 -0.4171134  0.1514649
T6 0.2778663 -0.6546107 -0.36123561 -0.24116756 -0.5046174 -0.2638577
         P.550      P.555      P.559        P.56       P.564      P.566
T1 -0.72980254 -1.2658896 -0.8738942 -0.34300010 -0.86767546 -0.7473907
T2 -0.14801274 -0.2143291 -0.5448608  0.29826104 -0.03476287 -0.1623745
T3 -0.47734915 -0.9749160 -1.1012711 -0.04696121 -0.23900870 -0.3906091
T4 -0.17171974 -0.6832099 -0.8733725  0.05284560 -0.13879464 -0.3041203
T5  0.07728724 -0.5605694 -0.4978815 -0.20195034 -0.10085554 -0.2281832
T6 -0.31767953 -1.1414836 -0.8407219 -0.16107471 -0.69267511 -0.2286759
         P.57      P.571       P.58      P.582      P.584       P.587
T1 -0.6979825 -1.2756436 -0.7916914 -0.5923861 -1.5231783 -0.71463870
T2 -0.4188541 -0.6305762 -0.1345011 -0.1697897 -0.5244262 -0.04445389
T3 -0.6587091 -0.9062529 -0.7912246 -0.5264158 -0.4568934 -0.92473536
T4 -0.6550218 -0.9012840 -0.3692526 -0.2229411 -0.3483827 -0.40795247
T5 -0.7868819 -0.3019018 -0.5336533 -0.5933277  0.1304226 -0.37999129
T6 -0.4768138 -0.9899314 -0.3609687 -0.3488054 -0.3481441 -0.91320801
         P.59      P.593      P.596      P.597          P.6        P.60
T1 -0.9113883 -0.9317083 -0.8892471 -1.2254666 -0.020155725 -0.51274688
T2 -0.4277542 -0.6592028 -0.1744413 -0.5900188  0.044075400  0.03954107
T3 -0.9668937 -0.9720118 -0.6827225 -1.2619192 -0.014545322 -0.27652149
T4 -0.6011490 -1.0968050 -0.3254980 -0.2974017 -0.012771316 -0.11894404
T5 -0.7614497 -0.5186774 -0.3499046 -0.9527541 -0.002531079 -0.10574495
T6 -0.6286918 -1.0203167 -0.7376441 -1.3775335  0.066968478 -0.09765761
         P.607      P.608        P.61       P.613        P.62       P.628
T1 -1.14144682 -0.4275231 -0.22103351 -0.51956261 -0.50638501 -0.63201302
T2 -0.18827807 -0.1878935  0.02753475 -0.16111773  0.05980000 -0.07944979
T3 -0.72008709 -0.6084268 -0.23032213 -0.47797630 -0.24160827 -0.50304551
T4 -0.74081002 -0.3937658 -0.01956425 -0.16035339 -0.01417087 -0.05745756
T5  0.05259145 -0.5315520  0.02995033 -0.07295816  0.13966090 -0.24166326
T6  0.42839650 -0.4449725 -0.00457759 -0.33937588 -0.01417776 -0.06921202
         P.63       P.64      P.649       P.65       P.655       P.656
T1 -0.7325420 -0.7343540 -1.1699926 -0.8796870 -0.75349672 -0.20586304
T2 -0.2462933 -0.3237799 -0.9778257 -0.2948772 -0.38252190 -0.19377275
T3 -0.4266913 -0.4476129 -0.7142244 -0.8539797 -0.12952301 -0.29174611
T4 -0.2701434 -0.1713230 -0.1389276 -0.4800697 -0.69302169  0.06792708
T5 -0.3508421 -0.3619821 -0.4284065 -0.5969094 -0.37537295 -0.11322926
T6 -0.3267424 -0.2427233 -0.1885161 -0.6177026 -0.06397488 -0.17349293
        P.657      P.658        P.66       P.663      P.667      P.668
T1 -1.4759126 -1.4419151 -0.30861327 -0.22570244 -0.9218281 -0.3238481
T2 -0.6459928 -0.3608954  0.15325616 -0.23848301 -0.4795271 -0.1375525
T3 -1.3836743 -1.2537700 -0.20553936 -0.55204060 -0.7991884 -0.4260284
T4 -0.4944516 -1.1646986  0.18954600 -0.17663003 -0.3019115 -0.2944625
T5 -0.7226147 -0.8275787  0.03970777  0.09903376 -0.4412185 -0.3523193
T6 -0.8324576 -0.3300998 -0.17902304 -0.06631277 -0.4589455 -0.4299171
         P.67      P.675       P.68      P.685       P.69      P.691
T1 -0.7479679 -1.2235250 -0.8691626 -0.9326561 -0.5985620 -1.6145199
T2 -0.3681048 -0.2873591 -0.5140039 -0.1183195 -0.1279794 -0.9575513
T3 -0.4622092 -0.7093806 -0.9470750 -0.5492753 -0.3286141 -1.3817778
T4 -0.4929379 -0.5270114 -0.6747315 -0.2610801 -0.1954478 -0.9091956
T5 -0.3044729 -0.2826955 -0.8735161 -0.1729376 -0.3225870 -0.7411277
T6 -0.6432516 -0.7646924 -1.1676023 -0.3300899 -0.2573761 -1.2299058
            P.7        P.70      P.702      P.703       P.71       P.712
T1 -0.188076276 -0.02891723 -1.3263608 -0.8073741 -0.5971490 -0.94036125
T2  0.128296702 -0.05875585 -0.8867260 -0.2434952 -0.1815171 -0.05768061
T3  0.004599413  0.07025862 -1.0496142 -0.8087284 -0.5689046 -0.14160903
T4  0.226335680  0.05312224 -0.5286164 -0.3648978 -0.2522356 -0.29346356
T5  0.239016166 -0.18601845 -0.6904205 -0.2244123 -0.1734858 -0.24604067
T6  0.154755246  0.02409542 -0.4208786 -0.5241744 -0.2595003 -0.82402766
        P.715       P.72        P.73       P.737      P.739        P.74
T1 -0.9214864 -0.8278874 -0.77191355 -0.48138749 -1.4541598 -0.57431123
T2 -0.5655449 -0.4064797 -0.17400561 -0.27007804 -1.4326319 -0.15808738
T3 -1.0060590 -0.6900025 -0.35389771 -0.62684887 -0.6940780 -0.38723310
T4  0.1636033 -0.5248513  0.01136927 -0.46715200 -0.6739873 -0.03075128
T5 -0.3896353 -0.3711612 -0.07187390 -0.01537806 -1.1749176 -0.26402596
T6 -1.0700898 -0.3385766  0.11582946 -0.22817188 -0.8990468 -0.14542430
        P.740     P.758       P.76      P.763      P.767       P.77       P.78
T1 -1.2284500 -1.626193 -0.5704797 -0.8680414 -0.5460939  0.2314151 -0.5859673
T2 -0.5904421 -1.046888 -0.1845324 -0.2091455 -0.6585039 -0.2873307 -0.1293894
T3 -1.3804798 -1.441179 -0.4790820 -0.7901252 -1.0549933  0.7697128 -0.3853552
T4 -0.8128595 -1.123559 -0.3418450 -0.2149559 -0.6718536  0.6119573 -0.2405412
T5 -0.9812958 -0.978202 -0.2703150 -0.6267853 -0.6163349  0.4426602 -0.1633711
T6 -0.8438624 -1.444493 -0.2845354 -0.4486101 -0.6352016  0.4683381 -0.3149892
         P.787       P.79         P.8       P.80      P.805      P.81
T1 -0.42107442 -0.9103489 -0.61553536 -0.7232931 -0.3409708 0.2255638
T2 -0.36990879 -0.3603249  0.11880428 -0.3194402  0.1758305 0.2821640
T3 -0.52301664 -0.7962883  0.03654904 -0.5008078 -0.2163087 0.1202157
T4 -0.08431052 -0.3224103  0.48725256 -0.2451269 -0.3714671 0.1662991
T5 -0.14089181 -0.5150304  0.36806403 -0.2538582 -0.1473172 0.2364246
T6 -0.69412237 -0.7445453  1.37395918 -0.3394435 -0.2355736 0.3790681
         P.811       P.83         P.84       P.85      P.851         P.856
T1 -0.53636316 -0.4665224 -0.662612198 -0.9760539 -1.0637824 -0.3692932309
T2 -0.02603017 -0.1534729  0.004651871 -0.4765468 -0.2090129  0.0008504531
T3 -0.35696674 -0.4687993 -0.290843827 -0.7465209 -0.9299944 -0.6545824388
T4  0.26114652 -0.3665836  0.345620134 -0.3974861 -0.1458041 -0.4537388450
T5  0.48932443 -0.1817744  0.203717095 -0.5357815 -0.4315040 -0.3556250187
T6 -0.38557721 -0.3383455  0.061205601 -0.3680565 -1.1407861 -0.4440885158
          P.857      P.884        P.89       P.898         P.9      P.905
T1  0.921040693 -0.8951142 -0.20944227 -1.31064192 -0.45118621 -1.1753377
T2 -0.270658939 -0.1209749  0.08950027  0.31987068 -0.13292502 -1.0337043
T3 -0.466730046 -0.6172330  0.14242139 -0.01854284 -0.05515973 -1.4297013
T4 -0.222855734 -0.4175290  0.24634803  0.40533219  0.08066342 -0.9468699
T5 -0.344744053 -0.2841514  0.36337433  0.49265652 -0.14491150 -1.0909300
T6 -0.003603441 -0.3680443 -0.02284633  1.28690934  0.39367302 -1.7397886
         P.92       P.94       P.95       P.96       P.98       P.99
T1 -0.7643898 -1.1364978 -0.9196910  0.5039760 -0.6781184 -0.8556759
T2 -0.4068724  0.1815271 -0.4844022  0.3298605 -0.2012016 -0.4089954
T3 -0.5582092  0.7009060 -0.8612219 -0.1102627 -0.4356799 -0.5646588
T4 -0.2856618  0.7006048 -0.5183608  0.3061426 -0.1550468 -0.3800826
T5 -0.3716837 -0.4044211 -0.7759049  0.3037301 -0.2998436 -0.4785340
T6 -0.4827336  0.7051299 -0.8181087  0.3783358 -0.2290668 -0.4324683</code></pre>
<pre class="r"><code># setup time vector for RAIN (source: Maria&#39;s code provided to me 3/3/21)
# The following code gives a vector where the times given in &quot;t&quot; are represented by a 1 in the vector &quot;ft&quot;.
# The time series in question lasted 84 hours and sampling times were every 4 hours, so the 
# vector &quot;ft&quot; gives a 1 for each hour representing a sampling time, and ft could is a vector of 12 1&#39;s and deltat=4 in the RAIN call below. 
t &lt;- c(0, 3, 6, 9, 15, 19, 22, 25)
(t &lt;- t+1) # start from 1</code></pre>
<pre><code>[1]  1  4  7 10 16 20 23 26</code></pre>
<pre class="r"><code># If the time series is not equally spaced it can be regularized by introducing time points with
# zero repeats. This may be combined with any of the above repeat settings.
# Example: A series measured at times {1, 3, 4, 6} is usable with the measure.sequence
# {1, 0, 1, 1, 0, 1} and a matrix x
t &lt;- c(1,0,0,1,0,0,1,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,1) # adjusted for irregular repeats

# RAIN analysis
library(rain)
rainresult &lt;- rain(t(dc_8), period=8, measure.sequence=t, deltat=1)
##add new column with corrected pvals
p.adjust(as.numeric(rainresult$pVal), method=&quot;bonferroni&quot;)</code></pre>
<pre><code>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[112] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[149] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[186] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[223] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[260] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[297] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[334] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[371] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[408] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</code></pre>
<pre class="r"><code>p.adjust(as.numeric(rainresult$pVal), method=&quot;fdr&quot;)</code></pre>
<pre><code>  [1] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
  [8] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
 [15] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
 [22] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
 [29] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
 [36] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
 [43] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
 [50] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
 [57] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
 [64] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
 [71] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
 [78] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
 [85] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
 [92] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
 [99] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[106] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[113] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[120] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[127] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[134] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[141] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[148] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[155] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[162] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[169] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[176] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[183] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[190] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[197] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[204] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[211] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[218] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[225] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[232] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[239] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[246] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[253] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[260] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[267] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[274] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[281] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[288] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[295] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[302] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[309] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[316] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[323] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[330] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[337] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[344] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[351] 0.9942119 0.9942119 0.9951640 0.9942119 0.9942119 0.9942119 0.9942119
[358] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[365] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[372] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[379] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[386] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[393] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[400] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[407] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[414] 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119 0.9942119
[421] 0.9942119 0.9942119 0.9942119 0.9942119</code></pre>
<pre class="r"><code>rainresult$fdr &lt;- p.adjust(as.numeric(rainresult$pVal), method=&quot;fdr&quot;) # correct p-values for multiple testing

# pVal cut off 0.05
rainresult %&gt;% filter(pVal &lt; 0.05)</code></pre>
<pre><code>             pVal phase peak.shape period       fdr
P.135 0.008200168     2          6      8 0.9942119
P.226 0.011345337     4          3      8 0.9942119
P.312 0.017057569     2          4      8 0.9942119
P.434 0.037934668     2          5      8 0.9942119</code></pre>
<pre class="r"><code># pVal cut off 0.01
rainresult %&gt;% filter(pVal &lt; 0.01)</code></pre>
<pre><code>             pVal phase peak.shape period       fdr
P.135 0.008200168     2          6      8 0.9942119</code></pre>
</div>
<div id="checking-the-intensity-distribution-of-peptides-in-each-sample" class="section level3">
<h3>6.2. Checking the intensity distribution of peptides in each sample</h3>
<ol style="list-style-type: decimal">
<li>Peptide level histograms</li>
</ol>
<pre class="r"><code># function to plot histogram
hist_intensity &lt;- function(depth=&quot;SRF&quot;,time=&quot;T1&quot;){
  df_ave_SRF_T1 &lt;- df_ave %&gt;% filter(Time==time &amp; Depth ==depth)
  theme_set(theme_bw())
  h1 &lt;- ggplot(df_ave_SRF_T1, aes(x=log2_Mean_intensity)) +
    geom_freqpoly(binwidth = 0.05, aes(color=Replicate)) +
    scale_fill_brewer(palette=&#39;Set2&#39;) +
    ylab(&quot;Intensity \n&quot;) +
    xlab(&quot;\n Frequency of intensity&quot;) +
    ggtitle(paste0(&quot;Histogram of sample (&quot;,depth,&quot;-&quot;,time,&quot;) \n&quot;))+
    ## adjust positions
    theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.text.x = element_text(angle = 90, hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
    theme(axis.text.y = element_text(size=10))
    # theme(panel.grid.major = element_blank())
    # theme(panel.grid.minor = element_blank()) 
  return(h1)
}

hist_intensity(depth=&quot;SRF&quot;,time=&quot;T1&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-20-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity(depth=&quot;SRF&quot;,time=&quot;T2&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-20-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity(depth=&quot;SRF&quot;,time=&quot;T3&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-20-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity(depth=&quot;SRF&quot;,time=&quot;T4&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-20-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity(depth=&quot;SRF&quot;,time=&quot;T5&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-20-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity(depth=&quot;SRF&quot;,time=&quot;T6&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-20-6.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity(depth=&quot;SRF&quot;,time=&quot;T7&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-20-7.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity(depth=&quot;SRF&quot;,time=&quot;T8&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-20-8.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># draw histogram in multigrids
library(gridExtra)
paste0(&quot;T&quot;,1L:8L)</code></pre>
<pre><code>[1] &quot;T1&quot; &quot;T2&quot; &quot;T3&quot; &quot;T4&quot; &quot;T5&quot; &quot;T6&quot; &quot;T7&quot; &quot;T8&quot;</code></pre>
<pre class="r"><code>l &lt;- list()
for (i in paste0(&quot;T&quot;,1L:8L)){
  print(i)
  l[[i]] &lt;- hist_intensity(depth=&quot;SRF&quot;,time=i)
}</code></pre>
<pre><code>[1] &quot;T1&quot;
[1] &quot;T2&quot;
[1] &quot;T3&quot;
[1] &quot;T4&quot;
[1] &quot;T5&quot;
[1] &quot;T6&quot;
[1] &quot;T7&quot;
[1] &quot;T8&quot;</code></pre>
<pre class="r"><code>length(l)</code></pre>
<pre><code>[1] 8</code></pre>
<pre class="r"><code>grid.arrange(grobs = l, ncol=3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-20-9.png" width="1056" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Spectra level histograms</li>
</ol>
<pre class="r"><code># function to plot histogram
hist_intensity_spec &lt;- function(depth=&quot;SRF&quot;,time=&quot;T1&quot;){
  df_int_SRF_T1 &lt;- df_int %&gt;% filter(Time==time &amp; Depth ==depth) %&gt;% select(-Peptide_id)
  theme_set(theme_bw())
  h1 &lt;- ggplot(df_int_SRF_T1, aes(x=log2.18O.16O.Ratio)) +
    geom_freqpoly(binwidth = 0.05, aes(color=Replicate)) +
    scale_fill_brewer(palette=&#39;Set2&#39;) +
    ylab(&quot;Intensity \n&quot;) +
    xlab(&quot;\n Frequency of intensity (Spec-level)&quot;) +
    ggtitle(paste0(&quot;Histogram of sample (&quot;,depth,&quot;-&quot;,time,&quot;) \n&quot;))+
    ## adjust positions
    theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.text.x = element_text(angle = 90, hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
    theme(axis.text.y = element_text(size=10))
    # theme(panel.grid.major = element_blank())
    # theme(panel.grid.minor = element_blank()) 
  return(h1)
}

hist_intensity_spec(depth=&quot;SRF&quot;,time=&quot;T1&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-21-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity_spec(depth=&quot;SRF&quot;,time=&quot;T2&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-21-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity_spec(depth=&quot;SRF&quot;,time=&quot;T3&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-21-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity_spec(depth=&quot;SRF&quot;,time=&quot;T4&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-21-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity_spec(depth=&quot;SRF&quot;,time=&quot;T5&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-21-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity_spec(depth=&quot;SRF&quot;,time=&quot;T6&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-21-6.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity_spec(depth=&quot;SRF&quot;,time=&quot;T7&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-21-7.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist_intensity_spec(depth=&quot;SRF&quot;,time=&quot;T8&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-21-8.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># draw histogram in multigrids
library(gridExtra)
paste0(&quot;T&quot;,1L:8L)</code></pre>
<pre><code>[1] &quot;T1&quot; &quot;T2&quot; &quot;T3&quot; &quot;T4&quot; &quot;T5&quot; &quot;T6&quot; &quot;T7&quot; &quot;T8&quot;</code></pre>
<pre class="r"><code>l &lt;- list()
for (i in paste0(&quot;T&quot;,1L:8L)){
  print(i)
  l[[i]] &lt;- hist_intensity_spec(depth=&quot;SRF&quot;,time=i)
}</code></pre>
<pre><code>[1] &quot;T1&quot;
[1] &quot;T2&quot;
[1] &quot;T3&quot;
[1] &quot;T4&quot;
[1] &quot;T5&quot;
[1] &quot;T6&quot;
[1] &quot;T7&quot;
[1] &quot;T8&quot;</code></pre>
<pre class="r"><code>length(l)</code></pre>
<pre><code>[1] 8</code></pre>
<pre class="r"><code>grid.arrange(grobs = l, ncol=3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-21-9.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="archived-not-using-this-part" class="section level3">
<h3>Archived: Not using this part</h3>
<p>Approach2: Time Series Classification using Dynamic time warping distance Time series classification is to build a classification model based on labelled time series and then use the model to predict the label of unlabelled time series. The way for time series classification with R is to extract and build features from time series data first, and then apply existing classification techniques, such as SVM, k-NN, neural networks, regression and decision trees, to the feature set.</p>
<p>Discrete Wavelet Transform (DWT) provides a multi-resolution representation using wavelets and is used in the example below. Another popular feature extraction technique is Discrete Fourier Transform (DFT). (<a href="http://www.rdatamining.com/examples/time-series-clustering-classification" class="uri">http://www.rdatamining.com/examples/time-series-clustering-classification</a>)</p>
<pre class="r"><code># extracting DWT coefficients (with Haar filter)
library(wavelets)
wtData &lt;- NULL

sc &lt;- read.table(&quot;data/synthetic_control.data.txt&quot;, header=F, sep=&quot;&quot;)

for (i in 1:nrow(sc)){
  a &lt;- t(sc[i,])
  wt &lt;- dwt(a, filter=&quot;haar&quot;, boundary=&#39;periodic&#39;)
  wtData &lt;- rbind(wtData, unlist(c(wt@W,wt@V[[wt@level]])))
}

wtData &lt;- as.data.frame(wtData)
head(wtData)

# set class labels into categorical values
classId &lt;- c(rep(1,100), rep(2,100), rep(3,100),rep(4,100), rep(5,100), rep(6,100))
wtSc &lt;- data.frame(cbind(classId, wtData))

# build a decision tree with ctree() in package party
library(party)
ct &lt;- ctree(classId ~ ., data=wtSc, controls = ctree_control(minsplit=30, minbucket=10, maxdepth=5))
pClassId &lt;- predict(ct)

# check predicted classes against original class labels
table(classId, pClassId)
# accuracy
(sum(classId==pClassId)) / nrow(wtSc)

plot(ct, ip_args=list(pval=FALSE), ep_args=list(digits=0))


# Lower CVI means better clustering : k_shape is the best clustering method
sapply(list(DTW = pc_dtw, DTW_LB = pc_dtwlb, kShape = pc_ks, TADPole = pc_tp), cvi, b = names(l_SRF8), type = &quot;VI&quot;)

sapply(list(DTW = pc_dtw, DTW_LB = pc_dtwlb, kShape = pc_ks, TADPole = pc_tp), cvi, type = &quot;internal&quot;)


# subset
data &lt;- CharTraj[1L:20L]
pc_k &lt;- tsclust(data, k = 3L:5L, distance = &quot;dtw_basic&quot;, centroid = &quot;pam&quot;, seed = 94L)
names(pc_k) &lt;- paste0(&quot;k_&quot;, 3L:5L)
sapply(pc_k, cvi, type = &quot;internal&quot;)



names(l_SRF8)</code></pre>
<p>5.3. dtwclust the clustering itself may be shape-based, feature-based or model-based.<br />
In the context of shape-based time-series clustering, it is common to utilize the Dynamic Time Warping (DTW) distance as dissimilarity measure (Aghabozorgi et al. 2015).<br />
DTW is a dynamic programming algorithm that compares two series and tries to find the optimum warping path between them under certain constraints, such as monotonicity. It started being used by the data mining community to overcome some of the limitations associated with the Euclidean distance (Ratanamahatana and Keogh 2004; Berndt and Clifford 1994).<br />
<a href="https://cran.r-project.org/web/packages/dtwclust/vignettes/dtwclust.pdf" class="uri">https://cran.r-project.org/web/packages/dtwclust/vignettes/dtwclust.pdf</a></p>
<pre class="r"><code># install.packages(&#39;dtwclust&#39;)
# install.packages(&#39;TSclust&#39;)
library(dtwclust)
require(&quot;TSclust&quot;)
data(&quot;uciCT&quot;)

proxy::pr_DB$set_entry(FUN = diss.ACF, names = c(&quot;ACFD&quot;), loop = TRUE, type = &quot;metric&quot;, distance = TRUE, description = &quot;Autocorrelation-based distance&quot;)

# Normalized DTW
ndtw &lt;- function(x, y, ...) {
  dtw(x, y, ...,
  step.pattern = asymmetric,
  distance.only = TRUE)$normalizedDistance
}

# Register the distance with proxy
proxy::pr_DB$set_entry(FUN = ndtw, names = c(&quot;nDTW&quot;),
  loop = TRUE, type = &quot;metric&quot;, distance = TRUE,
  description = &quot;Normalized, asymmetric DTW&quot;)

# Partitional clustering
tsclust(CharTraj[1L:10L], k = 2L,
  distance = &quot;nDTW&quot;, seed = 838)

# hierarchical clustering
hc_sbd &lt;- tsclust(CharTraj, type = &quot;h&quot;, k = 20L,
  preproc = zscore, seed = 899,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))

plot(hc_sbd)

# The series and the obtained prototypes can be plotted too
plot(hc_sbd, type = &quot;sc&quot;)

# Focusing on the first cluster
plot(hc_sbd, type = &quot;series&quot;, clus = 1L)
plot(hc_sbd, type = &quot;centroids&quot;, clus = 1L)


### Hierarchical clustering w/ shape based distance
hc_sbd &lt;- tsclust(CharTraj, type = &quot;h&quot;, k = 20L,
  preproc = zscore, seed = 899,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))


### partial clustering methods
# Reinterpolate to same length
data &lt;- reinterpolate(CharTraj, new.length = max(lengths(CharTraj)))

# z-normalization
data &lt;- zscore(data[60L:100L])
names(data)
# DTW method
pc_dtw &lt;- tsclust(data, k = 4L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 20L,
  args = tsclust_args(cent = list(trace = TRUE)))

# DTW_lb method
pc_dtwlb &lt;- tsclust(data, k = 4L,
  distance = &quot;dtw_lb&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 20L,
  control = partitional_control(pam.precompute = FALSE),
  args = tsclust_args(cent = list(trace = TRUE)))

# k-shape method
pc_ks &lt;- tsclust(data, k = 4L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)

# Tadpole method
pc_tp &lt;- tsclust(data, k = 4L, type = &quot;t&quot;,
  seed = 8, trace = TRUE,
  control = tadpole_control(dc = 1.5,
  window.size = 20L))

# Fuzzy clustering

# Calculate autocorrelation up to 50th lag
acf_fun &lt;- function(series, ...) {
  lapply(series, function(x) {
  as.numeric(acf(x, lag.max = 50, plot = FALSE)$acf)
  })
}
# Fuzzy c-means
fc &lt;- tsclust(CharTraj[1:20], type = &quot;f&quot;, k = 4L,
  preproc = acf_fun, distance = &quot;L2&quot;,
  seed = 42)

# Lower CVI means better clustering : k_shape is the best clustering method
sapply(list(DTW = pc_dtw, DTW_LB = pc_dtwlb, kShape = pc_ks, TADPole = pc_tp), cvi, b = CharTrajLabels[60L:100L], type = &quot;VI&quot;)

CharTraj

# Plot crisp partition in the original space
plot(fc, series = CharTraj[1:20], type = &quot;series&quot;)

# subset
data &lt;- CharTraj[1L:20L]
pc_k &lt;- tsclust(data, k = 3L:5L, distance = &quot;dtw_basic&quot;, centroid = &quot;pam&quot;, seed = 94L)
names(pc_k) &lt;- paste0(&quot;k_&quot;, 3L:5L)
sapply(pc_k, cvi, type = &quot;internal&quot;)</code></pre>
<p>6.1. Given code: <a href="https://rdrr.io/bioc/rain/f/inst/doc/rain.pdf" class="uri">https://rdrr.io/bioc/rain/f/inst/doc/rain.pdf</a></p>
<pre class="r"><code># BiocManager::install(&#39;rain&#39;)

set.seed(123)
times &lt;- c(1: 24) * 2
sin &lt;- 1 + 0.5 * sin(times / 24 * 2 * pi) + rnorm(24, 0, 0.3)
saw &lt;- rep(13:24 / 18 , 2) + rnorm(24, 0, 0.3)
measure &lt;- cbind(sin, saw)
require(&#39;lattice&#39;)
xyplot(t(measure)~rep(times, each=2) | c(&#39;sin&#39;, &#39;saw&#39;),layout = c(1, 2), type = &#39;o&#39;, xlab = &#39;time&#39;, ylab = &#39;value&#39;, cex.lab = 0.6)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-24-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>require(rain)
rainresult &lt;- rain(measure, period=24, deltat=2, peak.border=c(0.1,0.9), verbose=FALSE)
rainresult</code></pre>
<pre><code>            pVal phase peak.shape period
sin 5.176859e-06     6         12     24
saw 1.162142e-02    24          2     24</code></pre>
<pre class="r"><code>data(menetRNASeqMouseLiver)
colnames(menetRNASeqMouseLiver)</code></pre>
<pre><code> [1] &quot;ZT_2_1&quot;  &quot;ZT_2_2&quot;  &quot;ZT_6_1&quot;  &quot;ZT_6_2&quot;  &quot;ZT_10_1&quot; &quot;ZT_10_2&quot; &quot;ZT_14_1&quot;
 [8] &quot;ZT_14_2&quot; &quot;ZT_18_1&quot; &quot;ZT_18_2&quot; &quot;ZT_22_1&quot; &quot;ZT_22_2&quot;</code></pre>
<pre class="r"><code>results &lt;- rain(t(menetRNASeqMouseLiver), deltat=4, period=24, nr.series=2, peak.border=c(0.3, 0.7), verbose=FALSE)
best &lt;- order(results$pVal)[1:10]
xyplot(as.matrix(menetRNASeqMouseLiver[best, (0:5 * 2 + rep(c(1, 2), each = 6))]) ~rep(0:11 * 4 + 2, each = 10) |rownames(menetRNASeqMouseLiver)[best], scales = list(y = list(relation = &#39;free&#39;)), layout = c(2, 5), type = &#39;b&#39;, pch = 16, xlab = &#39;time&#39;, ylab = &#39;expression value&#39;, cex.lab = 1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-24-2.png" width="1056" style="display: block; margin: auto;" /></p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19042)

Matrix products: default

Random number generation:
 RNG:     L&#39;Ecuyer-CMRG 
 Normal:  Inversion 
 Sample:  Rejection 
 
locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] lattice_0.20-41     gridExtra_2.3       rain_1.24.0        
 [4] multtest_2.46.0     Biobase_2.50.0      BiocGenerics_0.36.0
 [7] gmp_0.6-2           TSclust_1.3.1       cluster_2.1.0      
[10] pdc_1.0.3           dtwclust_5.5.6      dtw_1.22-3         
[13] proxy_0.4-24        maditr_0.7.4        data.table_1.14.0  
[16] formattable_0.2.1   ggplot2_3.3.3       stringr_1.4.0      
[19] tidyr_1.1.2         dplyr_1.0.4         workflowr_1.6.2    

loaded via a namespace (and not attached):
  [1] bigmemory_4.5.36        bigmemory.sri_0.1.3     colorspace_2.0-0       
  [4] ellipsis_0.3.1          class_7.3-17            modeltools_0.2-23      
  [7] rprojroot_2.0.2         fs_1.5.0                clue_0.3-58            
 [10] rstudioapi_0.13         farver_2.1.0            ggrepel_0.9.1          
 [13] RSpectra_0.16-0         fansi_0.4.2             splines_4.0.3          
 [16] codetools_0.2-16        knitr_1.31              longitudinalData_2.4.1 
 [19] jsonlite_1.7.2          nloptr_1.2.2.2          shiny_1.6.0            
 [22] compiler_4.0.3          assertthat_0.2.1        Matrix_1.2-18          
 [25] fastmap_1.1.0           cli_2.3.1               later_1.1.0.1          
 [28] htmltools_0.5.1.1       tools_4.0.3             misc3d_0.9-0           
 [31] gtable_0.3.0            glue_1.4.2              reshape2_1.4.4         
 [34] Rcpp_1.0.5              jquerylib_0.1.3         fracdiff_1.5-1         
 [37] vctrs_0.3.6             urca_1.3-0              nlme_3.1-149           
 [40] clv_0.3-2.2             iterators_1.0.13        crosstalk_1.1.1        
 [43] lmtest_0.9-38           timeDate_3043.102       xfun_0.20              
 [46] ps_1.6.0                mime_0.10               miniUI_0.1.1.1         
 [49] lifecycle_1.0.0         MASS_7.3-53             zoo_1.8-8              
 [52] scales_1.1.1            promises_1.1.1          yaml_2.2.1             
 [55] quantmod_0.4.18         curl_4.3                sass_0.3.1             
 [58] stringi_1.5.3           highr_0.8               tseries_0.10-48        
 [61] foreach_1.5.1           TTR_0.24.2              manipulateWidget_0.10.1
 [64] rlang_0.4.10            pkgconfig_2.0.3         rgl_0.105.13           
 [67] locpol_0.7-0            evaluate_0.14           purrr_0.3.4            
 [70] htmlwidgets_1.5.3       labeling_0.4.2          tidyselect_1.1.0       
 [73] plyr_1.8.6              magrittr_2.0.1          R6_2.5.0               
 [76] generics_0.1.0          DBI_1.1.1               pillar_1.5.0           
 [79] whisker_0.4             withr_2.4.1             xts_0.12.1             
 [82] survival_3.2-7          nnet_7.3-14             tibble_3.0.4           
 [85] crayon_1.4.1            KernSmooth_2.23-17      utf8_1.1.4             
 [88] rmarkdown_2.7           grid_4.0.3              flexclust_1.4-0        
 [91] git2r_0.28.0            forecast_8.13           digest_0.6.27          
 [94] webshot_0.5.2           xtable_1.8-4            httpuv_1.5.4           
 [97] RcppParallel_5.0.3      stats4_4.0.3            munsell_0.5.0          
[100] bslib_0.2.4             tcltk_4.0.3             quadprog_1.5-8         
[103] shinyjs_2.0.0          </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
