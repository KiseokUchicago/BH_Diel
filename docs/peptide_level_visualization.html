<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="KiseokUchicago" />

<meta name="date" content="2021-02-22" />

<title>peptide_level_visualization</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BH_Diel</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/KiseokUchicago/BH_Diel">
    <span class="fas fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">peptide_level_visualization</h1>
<h4 class="author">KiseokUchicago</h4>
<h4 class="date">2021-02-22</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-03-03
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>BH_Diel/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20210222code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20210222)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20210222code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20210222)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomKiseokUchicagoBHDieltree7a8405a4efd40a8494bdf38a3d224b56406bdbf5targetblank7a8405aa"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/KiseokUchicago/BH_Diel/tree/7a8405a4efd40a8494bdf38a3d224b56406bdbf5" target="_blank">7a8405a</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomKiseokUchicagoBHDieltree7a8405a4efd40a8494bdf38a3d224b56406bdbf5targetblank7a8405aa" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/KiseokUchicago/BH_Diel/tree/7a8405a4efd40a8494bdf38a3d224b56406bdbf5" target="_blank">7a8405a</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  01_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-BDCL_filtered_PSMs.tsv
    Untracked:  01_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-BDCL_filtered_PSMs.xlsx
    Untracked:  02_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-DCL_filtered_PSMs.tsv
    Untracked:  02_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-DCL_filtered_PSMs.xlsx
    Untracked:  03_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-SRF_filtered_PSMs.tsv
    Untracked:  03_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T1-SRF_filtered_PSMs.xlsx
    Untracked:  04_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-BDCL_filtered_PSMs.tsv
    Untracked:  04_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-BDCL_filtered_PSMs.xlsx
    Untracked:  05_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-DCL_filtered_PSMs.tsv
    Untracked:  05_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-DCL_filtered_PSMs.xlsx
    Untracked:  06_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-SRF_filtered_PSMs.tsv
    Untracked:  06_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T2-SRF_filtered_PSMs.xlsx
    Untracked:  07_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-BDCL_filtered_PSMs.tsv
    Untracked:  07_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-BDCL_filtered_PSMs.xlsx
    Untracked:  08_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-DCL_filtered_PSMs.tsv
    Untracked:  08_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-DCL_filtered_PSMs.xlsx
    Untracked:  09_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-SRF_filtered_PSMs.tsv
    Untracked:  09_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T3-SRF_filtered_PSMs.xlsx
    Untracked:  10_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-BDCL_filtered_PSMs.tsv
    Untracked:  10_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-BDCL_filtered_PSMs.xlsx
    Untracked:  11_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-DCL_filtered_PSMs.tsv
    Untracked:  11_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-DCL_filtered_PSMs.xlsx
    Untracked:  12_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-SRF_filtered_PSMs.tsv
    Untracked:  12_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T4-SRF_filtered_PSMs.xlsx
    Untracked:  13_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-BDCL_filtered_PSMs.tsv
    Untracked:  13_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-BDCL_filtered_PSMs.xlsx
    Untracked:  14_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-DCL_filtered_PSMs.tsv
    Untracked:  14_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-DCL_filtered_PSMs.xlsx
    Untracked:  15_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-SRF_filtered_PSMs.tsv
    Untracked:  15_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T5-SRF_filtered_PSMs.xlsx
    Untracked:  16_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-BDCL_filtered_PSMs.tsv
    Untracked:  16_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-BDCL_filtered_PSMs.xlsx
    Untracked:  17_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-DCL_filtered_PSMs.tsv
    Untracked:  17_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-DCL_filtered_PSMs.xlsx
    Untracked:  18_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-SRF_filtered_PSMs.tsv
    Untracked:  18_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T6-SRF_filtered_PSMs.xlsx
    Untracked:  19_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T8-BDCL_filtered_PSMs.tsv
    Untracked:  19_IPTL-CyanoSUMI-MI41M-18OMix-16O-A-T8-BDCL_filtered_PSMs.xlsx
    Untracked:  20_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-BDCL_filtered_PSMs.tsv
    Untracked:  20_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-BDCL_filtered_PSMs.xlsx
    Untracked:  21_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-DCL_filtered_PSMs.tsv
    Untracked:  21_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-DCL_filtered_PSMs.xlsx
    Untracked:  22_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-SRF_filtered_PSMs.tsv
    Untracked:  22_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T1-SRF_filtered_PSMs.xlsx
    Untracked:  23_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-BDCL_filtered_PSMs.tsv
    Untracked:  23_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-BDCL_filtered_PSMs.xlsx
    Untracked:  24_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-DCL_filtered_PSMs.tsv
    Untracked:  24_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-DCL_filtered_PSMs.xlsx
    Untracked:  25_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-SRF_filtered_PSMs.tsv
    Untracked:  25_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T2-SRF_filtered_PSMs.xlsx
    Untracked:  26_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-BDCL_filtered_PSMs.tsv
    Untracked:  26_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-BDCL_filtered_PSMs.xlsx
    Untracked:  27_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-DCL_filtered_PSMs.tsv
    Untracked:  27_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-DCL_filtered_PSMs.xlsx
    Untracked:  28_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-SRF_filtered_PSMs.tsv
    Untracked:  28_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T3-SRF_filtered_PSMs.xlsx
    Untracked:  29_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-BDCL_filtered_PSMs.tsv
    Untracked:  29_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-BDCL_filtered_PSMs.xlsx
    Untracked:  30_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-DCL_filtered_PSMs.tsv
    Untracked:  30_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-DCL_filtered_PSMs.xlsx
    Untracked:  31_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-SRF_filtered_PSMs.tsv
    Untracked:  31_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T4-SRF_filtered_PSMs.xlsx
    Untracked:  32_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-BDCL_filtered_PSMs.tsv
    Untracked:  32_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-BDCL_filtered_PSMs.xlsx
    Untracked:  33_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-DCL_filtered_PSMs.tsv
    Untracked:  33_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-DCL_filtered_PSMs.xlsx
    Untracked:  34_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-SRF_filtered_PSMs.tsv
    Untracked:  34_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T5-SRF_filtered_PSMs.xlsx
    Untracked:  35_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-BDCL_filtered_PSMs.tsv
    Untracked:  35_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-BDCL_filtered_PSMs.xlsx
    Untracked:  36_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-DCL_filtered_PSMs.tsv
    Untracked:  36_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-DCL_filtered_PSMs.xlsx
    Untracked:  37_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-SRF_filtered_PSMs.tsv
    Untracked:  37_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T6-SRF_filtered_PSMs.xlsx
    Untracked:  38_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-BDCL_filtered_PSMs.tsv
    Untracked:  38_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-BDCL_filtered_PSMs.xlsx
    Untracked:  39_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-DCL_filtered_PSMs.tsv
    Untracked:  39_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-DCL_filtered_PSMs.xlsx
    Untracked:  40_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-SRF_filtered_PSMs.tsv
    Untracked:  40_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T7-SRF_filtered_PSMs.xlsx
    Untracked:  41_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-BDCL_filtered_PSMs.tsv
    Untracked:  41_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-BDCL_filtered_PSMs.xlsx
    Untracked:  42_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-DCL_filtered_PSMs.tsv
    Untracked:  42_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-DCL_filtered_PSMs.xlsx
    Untracked:  43_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-SRF_filtered_PSMs.tsv
    Untracked:  43_IPTL-CyanoSUMI-MI41M-18OMix-16O-B-T8-SRF_filtered_PSMs.xlsx
    Untracked:  44_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-BDCL_filtered_PSMs.tsv
    Untracked:  44_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-BDCL_filtered_PSMs.xlsx
    Untracked:  45_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-DCL_filtered_PSMs.tsv
    Untracked:  45_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-DCL_filtered_PSMs.xlsx
    Untracked:  46_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-SRF_filtered_PSMs.tsv
    Untracked:  46_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T1-SRF_filtered_PSMs.xlsx
    Untracked:  47_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-BDCL_filtered_PSMs.tsv
    Untracked:  47_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-BDCL_filtered_PSMs.xlsx
    Untracked:  48_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-DCL_filtered_PSMs.tsv
    Untracked:  48_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-DCL_filtered_PSMs.xlsx
    Untracked:  49_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-SRF_filtered_PSMs.tsv
    Untracked:  49_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T3-SRF_filtered_PSMs.xlsx
    Untracked:  50_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-BDCL_filtered_PSMs.tsv
    Untracked:  50_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-BDCL_filtered_PSMs.xlsx
    Untracked:  51_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-DCL_filtered_PSMs.tsv
    Untracked:  51_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-DCL_filtered_PSMs.xlsx
    Untracked:  52_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-SRF_filtered_PSMs.tsv
    Untracked:  52_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T4-SRF_filtered_PSMs.xlsx
    Untracked:  53_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-BDCL_filtered_PSMs.tsv
    Untracked:  53_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-BDCL_filtered_PSMs.xlsx
    Untracked:  54_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-DCL_filtered_PSMs.tsv
    Untracked:  54_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-DCL_filtered_PSMs.xlsx
    Untracked:  55_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-SRF_filtered_PSMs.tsv
    Untracked:  55_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T5-SRF_filtered_PSMs.xlsx
    Untracked:  56_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-BDCL_filtered_PSMs.tsv
    Untracked:  56_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-BDCL_filtered_PSMs.xlsx
    Untracked:  57_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-DCL_filtered_PSMs.tsv
    Untracked:  57_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-DCL_filtered_PSMs.xlsx
    Untracked:  58_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-SRF_filtered_PSMs.tsv
    Untracked:  58_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T6-SRF_filtered_PSMs.xlsx
    Untracked:  59_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T7-BDCL_filtered_PSMs.tsv
    Untracked:  59_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T7-BDCL_filtered_PSMs.xlsx
    Untracked:  60_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T7-DCL_filtered_PSMs.tsv
    Untracked:  60_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T7-DCL_filtered_PSMs.xlsx
    Untracked:  61_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-BDCL_filtered_PSMs.tsv
    Untracked:  61_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-BDCL_filtered_PSMs.xlsx
    Untracked:  62_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-DCL_filtered_PSMs.tsv
    Untracked:  62_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-DCL_filtered_PSMs.xlsx
    Untracked:  63_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-SRF_filtered_PSMs.tsv
    Untracked:  63_IPTL-CyanoSUMI-MI41M-18OMix-16O-C-T8-SRF_filtered_PSMs.xlsx
    Untracked:  Hist_freq_of_peptide_id.pdf
    Untracked:  Hist_number of timepoints_peptide_appears.pdf
    Untracked:  P1_number_unique_peptide_per_sample.pdf
    Untracked:  P2_number_of_cumulative_unique_peptides.pdf
    Untracked:  Peptide_id.tsv
    Untracked:  Replicate_ABC50_combined.tsv
    Untracked:  Replicate_ABC50_combined.xlsx
    Untracked:  Replicate_ABC63_combined.tsv
    Untracked:  Replicate_ABC63_combined.xlsx
    Untracked:  Replicate_BC_combined.tsv
    Untracked:  Replicate_BC_combined.xlsx
    Untracked:  Replicate_B_combined.tsv
    Untracked:  Replicate_B_combined.xlsx
    Untracked:  Time_series_intesity_all.pdf
    Untracked:  data/Time_metadata.txt
    Untracked:  data/diel-Feb21/
    Untracked:  data/diel-Feb25/
    Untracked:  data/diel-Feb26/
    Untracked:  data/diel-Mar2/
    Untracked:  data/synthetic_control.data.txt
    Untracked:  hclust_DTW_average_wide.pdf

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/peptide_level_visualization.Rmd</code>) and HTML (<code>docs/peptide_level_visualization.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/7a8405a4efd40a8494bdf38a3d224b56406bdbf5/analysis/peptide_level_visualization.Rmd" target="_blank">7a8405a</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-03
</td>
<td>
rain_not_done
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/403a8fb73c61d964f60bec6f048d4d6638c546c9/docs/peptide_level_visualization.html" target="_blank">403a8fb</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-03
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/2294f512531a7fb7d0fdf56e259e674cf6b6c570/analysis/peptide_level_visualization.Rmd" target="_blank">2294f51</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-03
</td>
<td>
clustering
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/6a616230eede9f744ec3f3134d36affbb46ff1f3/docs/peptide_level_visualization.html" target="_blank">6a61623</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-02
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/5478476358f9190fb8438dfee193052b3c2e3bb0/analysis/peptide_level_visualization.Rmd" target="_blank">5478476</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-02
</td>
<td>
hclust
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/7218e38d19977eee4cdac9f49bb92a9c754c0687/docs/peptide_level_visualization.html" target="_blank">7218e38</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-02
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/dc0c92541c7a095cc906479e3d7db744c6e4f4ca/analysis/peptide_level_visualization.Rmd" target="_blank">dc0c925</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-02
</td>
<td>
average
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/52cb18451f2c50292d084abf3126d330ef6be2bb/docs/peptide_level_visualization.html" target="_blank">52cb184</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-02
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/7f26b0f0ed5a088087ff67171af9bd22c65efe5f/analysis/peptide_level_visualization.Rmd" target="_blank">7f26b0f</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-03-02
</td>
<td>
update
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/c2f25d3613813ebed224e4e969c5753250e890fe/docs/peptide_level_visualization.html" target="_blank">c2f25d3</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-26
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/c5ec37ef6ebd29a83bdba8d242b57fccc7837df9/analysis/peptide_level_visualization.Rmd" target="_blank">c5ec37e</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-26
</td>
<td>
total 50 samples
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/e6cbdfa41b1e0486cb84eb4cb9e37efb7dc3e5ff/docs/peptide_level_visualization.html" target="_blank">e6cbdfa</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-25
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/af94ad010f576c08f5207ee8e60e202cb93a8691/analysis/peptide_level_visualization.Rmd" target="_blank">af94ad0</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-25
</td>
<td>
peptide
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/3db29b0bc2c1673a15f5600c103841a88b5a47bf/docs/peptide_level_visualization.html" target="_blank">3db29b0</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-23
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/fe508d15413c128cce2d577485c74c32d77d1704/analysis/peptide_level_visualization.Rmd" target="_blank">fe508d1</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-23
</td>
<td>
publish
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/e55579c873cb14ccd7bc7796c410ba177abc2a6c/docs/peptide_level_visualization.html" target="_blank">e55579c</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-23
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/44eb05fc0b315c8860224b5d2d2d40e0947e21dd/analysis/peptide_level_visualization.Rmd" target="_blank">44eb05f</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-23
</td>
<td>
publish
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/1ca336372d560d548ec8e4f1ee97dd6bd9de4d26/docs/peptide_level_visualization.html" target="_blank">1ca3363</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/dd3354ea8f4f0fc98a1ac9e91aeb7b5acc3645c9/analysis/peptide_level_visualization.Rmd" target="_blank">dd3354e</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
peptide
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/69d6ce78a34ed33f4c1c6f84cc3d565cc46908a9/docs/peptide_level_visualization.html" target="_blank">69d6ce7</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/deb4db2f0aae05e8a37b3c9f238db1621ed35046/analysis/peptide_level_visualization.Rmd" target="_blank">deb4db2</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
peptide
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/6915013940ded02942cbecc91fd9b56b9ecbec28/docs/peptide_level_visualization.html" target="_blank">6915013</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/5a66cb1df60159b096f60da4df338e24228e996d/analysis/peptide_level_visualization.Rmd" target="_blank">5a66cb1</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
peptide
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/12b2c74add495b09b165c27e24022cdd0f863103/docs/peptide_level_visualization.html" target="_blank">12b2c74</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/c4cbcd229432d571f38ef352a2c584f61be1c6c1/docs/peptide_level_visualization.html" target="_blank">c4cbcd2</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/7830f0053fe892c583494bdfddfc272fe7ffbd2c/analysis/peptide_level_visualization.Rmd" target="_blank">7830f00</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
publish
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/KiseokUchicago/BH_Diel/ee263ad22c2ca793bafd055ecf12f368d5b9386e/docs/peptide_level_visualization.html" target="_blank">ee263ad</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/KiseokUchicago/BH_Diel/blob/0ccca1470fe945598555adf482d6057be73b219f/analysis/peptide_level_visualization.Rmd" target="_blank">0ccca14</a>
</td>
<td>
KiseokUchicago
</td>
<td>
2021-02-22
</td>
<td>
visualization
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="peptide-level-visualization" class="section level3">
<h3>Peptide level visualization</h3>
<pre class="r"><code># libraries
library(dplyr)
library(tidyr)
library(stringr)
library(ggplot2)
library(formattable)</code></pre>
</div>
<div id="quality-check-number-of-uniq-peptides-sequence-per-sample" class="section level3">
<h3>1. Quality check: Number of uniq peptides (sequence) per sample</h3>
<pre class="r"><code># read in combined table of 24 samples (Replicate B)
df_pep &lt;- read.table(&quot;Replicate_ABC63_combined.tsv&quot;,sep=&#39;\t&#39;,header = T)

# count unique peptide per sample
df_uni &lt;- df_pep %&gt;% group_by(SampleID) %&gt;% summarize(uniq_pep = length(unique(Base.Peptide.Sequence)))
df_uni1 &lt;- df_uni %&gt;% separate(SampleID, sep=&#39;_&#39;, into= c(&#39;Depth&#39;,&#39;Time&#39;,&#39;Replicate&#39;),remove = F) %&gt;% select(-Time, -Replicate)
df_uni2 &lt;- df_uni1 %&gt;% arrange(desc(Depth))

# get the order right from SRF -&gt; DCL -&gt; BDCL
ord &lt;- df_uni2$SampleID 
df_uni2$SampleID &lt;- factor(df_uni2$SampleID, levels = ord)
df_uni2$Depth &lt;- factor(df_uni2$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))

# Making barplot
theme_set(theme_bw())
cols &lt;- c(&#39;SRF&#39;=&#39;#fc8d62&#39;,&#39;DCL&#39;=&#39;#66c2a5&#39;,&#39;BDCL&#39;=&#39;#8da0cb&#39;)
uniq1 &lt;- ggplot(df_uni2, aes(x=SampleID, fill=Depth, y=uniq_pep)) +  ## I put fill=value which was wrong
  geom_bar(stat=&quot;identity&quot;) +
  scale_fill_manual(values=cols) +
  ylab(&quot;Number of unique peptide sequence \n&quot;) +
  xlab(&quot;\n SampleID&quot;) +
  ggtitle(&quot;Number of unique peptide sequences per sample&quot;)+
  ## adjust positions
  theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(angle = 90, hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=10))+
  theme(panel.grid.major = element_blank()) +
  theme(panel.grid.minor = element_blank())

uniq2 &lt;- uniq1 + geom_text(aes(x=df_uni$SampleID, y=df_uni$uniq_pep, label=df_uni$uniq_pep),
            size = 3, hjust = 0.5, position = position_stack(vjust = +1.05), family=&quot;serif&quot;)
uniq2</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-2-1.png" width="1056" style="display: block; margin: auto;" /></p>
<p>sample DCL_T8 doesn’t seem to have good quality MS data.</p>
</div>
<div id="number-of-accumulative-uniq-peptides-sequence-does-it-saturate" class="section level3">
<h3>2. Number of accumulative uniq peptides (sequence): Does it saturate?</h3>
<pre class="r"><code># read in combined table of 24 samples (Replicate B)
df_pep &lt;- read.table(&quot;Replicate_ABC63_combined.tsv&quot;,sep=&#39;\t&#39;,header = T)

# get unique peptides per sample
dt &lt;- df_pep %&gt;% select(SampleID, Base.Peptide.Sequence) %&gt;% unique()
# change SampleID into number
dt1 &lt;- dt %&gt;% select(SampleID) %&gt;% unique() %&gt;% arrange(SampleID) %&gt;%  arrange()
dt2 &lt;- tibble::rownames_to_column(dt1,&quot;depth&quot;)
# merge dt and dt2
dt_depth &lt;- left_join(dt,dt2,by=c(&#39;SampleID&#39;=&#39;SampleID&#39;))
dim(dt_depth)</code></pre>
<pre><code>[1] 34685     3</code></pre>
<pre class="r"><code># get cumulative number of unique peptides (https://stackoverflow.com/questions/15698399/cumulative-count-of-unique-values-in-r)
require(data.table)
dt_depth &lt;- as.data.table(dt_depth)
setkey(dt_depth, &quot;depth&quot;)
dt_depth[, Base.Peptide.Sequence := as.numeric(factor(Base.Peptide.Sequence, levels = unique(Base.Peptide.Sequence)))]
setkey(dt_depth, &quot;depth&quot;, &quot;Base.Peptide.Sequence&quot;)
dt.out &lt;- dt_depth[J(unique(depth)), mult=&quot;last&quot;]
dt.out[, Base.Peptide.Sequence := cummax(Base.Peptide.Sequence)]

# getting ready to make plot
df.out &lt;- tibble::rowid_to_column(dt.out) 
df.out2 &lt;- df.out %&gt;% select(rowid, Base.Peptide.Sequence) %&gt;% rename(value=Base.Peptide.Sequence)
# Making line plot
theme_set(theme_bw())

p1 &lt;- ggplot(df.out2,aes(x = rowid,y = value)) + geom_line(col=&quot;magenta&quot;) + geom_point(color=&#39;maroon&#39;) +
  ylab(&quot;Number of cumulative unique peptide sequence \n&quot;) +
  xlab(&quot;\n Number of cumulative samples&quot;) +
  # ylim(c(0,2200)) +
  ggtitle(&quot;Number of cumulative unique peptide sequences \n&quot;)+
  ## adjust positions
  theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=10))
  # theme(panel.grid.major = element_blank())
  # theme(panel.grid.minor = element_blank())

p1</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-3-1.png" width="1056" style="display: block; margin: auto;" /> It seems to saturate as more samples are added.</p>
</div>
<div id="which-peptide_ids-are-present-in-allalmost-time-points" class="section level3">
<h3>3. Which Peptide_ids are present in all(almost) time points?</h3>
<p>Make a histogram of x-axis being the # of time points present, y-axis being the number of Peptide_ids<br />
We need 3 histogram for (1) Surface, (2) DCL, and (3) BDCL</p>
<pre class="r"><code># read in combined table of 24 samples (Replicate B)
df_pep &lt;- read.table(&quot;Replicate_ABC63_combined.tsv&quot;,sep=&#39;\t&#39;,header = T)

# (1) Surface
colnames(df_pep)</code></pre>
<pre><code> [1] &quot;Spec_id&quot;               &quot;Base.Peptide.Sequence&quot; &quot;log2.18O.16O.Ratio&quot;   
 [4] &quot;SampleID&quot;              &quot;Index&quot;                 &quot;Cruise&quot;               
 [7] &quot;Station&quot;               &quot;Isotope&quot;               &quot;Replicate&quot;            
[10] &quot;Time&quot;                  &quot;Depth&quot;                 &quot;SpectrumID&quot;           
[13] &quot;ScanID&quot;                &quot;Target.&quot;               &quot;Decoy.&quot;               
[16] &quot;Peptide_id&quot;           </code></pre>
<pre class="r"><code>df_srf &lt;- df_pep %&gt;% filter(Depth == &#39;SRF&#39;) %&gt;% select(Peptide_id, SampleID, Time, Depth) %&gt;% unique() %&gt;% arrange(Peptide_id)
# How many time points did it appear
(df_srf2 &lt;- df_srf %&gt;% group_by(Peptide_id) %&gt;% summarize(Timepoints = n_distinct(Time)) %&gt;% ungroup())</code></pre>
<pre><code># A tibble: 1,956 x 2
   Peptide_id Timepoints
 * &lt;chr&gt;           &lt;int&gt;
 1 Pep_1               8
 2 Pep_10              8
 3 Pep_100             8
 4 Pep_1000            5
 5 Pep_1001            4
 6 Pep_1002            6
 7 Pep_1003            4
 8 Pep_1004            4
 9 Pep_1005            6
10 Pep_1006            4
# ... with 1,946 more rows</code></pre>
<pre class="r"><code># Check if Pep_1 appeared in 8 time points
df_srf %&gt;% filter(Peptide_id==&quot;Pep_1004&quot;) # true 8 times</code></pre>
<pre><code>  Peptide_id SampleID Time Depth
1   Pep_1004 SRF_T1_A   T1   SRF
2   Pep_1004 SRF_T6_A   T6   SRF
3   Pep_1004 SRF_T3_B   T3   SRF
4   Pep_1004 SRF_T7_B   T7   SRF</code></pre>
<pre class="r"><code># Histogram
theme_set(theme_bw())
ggplot(df_srf2, aes(Timepoints)) + geom_bar() +
  ylab(&quot;Number of peptides \n&quot;) +
  xlab(&quot;\n Cumulative number of timepoints peptide are present&quot;) +
  scale_x_continuous(breaks=seq(1,8,1))+
  ggtitle(&quot;Distribution of number of timepoints each Peptide_id appears (Surface) \n&quot;)+
  ## adjust positions
  theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=10))</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-4-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>  # theme(panel.grid.major = element_blank())
  # theme(panel.grid.minor = element_blank())

# Let&#39;s try to plot all of them at once
df_all &lt;- df_pep %&gt;% select(Peptide_id, SampleID, Time, Depth) %&gt;% unique() %&gt;% arrange(Peptide_id)
# How many time points did it appear
(df_all2 &lt;- df_all %&gt;% group_by(Peptide_id, Depth) %&gt;% summarize(Timepoints = n_distinct(Time)) %&gt;% ungroup())</code></pre>
<pre><code># A tibble: 5,831 x 3
   Peptide_id Depth Timepoints
   &lt;chr&gt;      &lt;chr&gt;      &lt;int&gt;
 1 Pep_1      BDCL           8
 2 Pep_1      DCL            8
 3 Pep_1      SRF            8
 4 Pep_10     BDCL           8
 5 Pep_10     DCL            8
 6 Pep_10     SRF            8
 7 Pep_100    BDCL           8
 8 Pep_100    DCL            7
 9 Pep_100    SRF            8
10 Pep_1000   BDCL           1
# ... with 5,821 more rows</code></pre>
<pre class="r"><code>df_all2$Depth &lt;- factor(df_all2$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))

# Histogram
ggplot(df_all2, aes(Timepoints)) + geom_bar(aes(fill=Depth), position=&#39;dodge&#39;) +
  scale_fill_manual(values=cols) +
  ylab(&quot;Number of peptides \n&quot;) +
  xlab(&quot;\n Cumulative number of timepoints peptide are present&quot;) +
  scale_x_continuous(breaks=seq(1,8,1))+
  ggtitle(&quot;Distribution of number of timepoints each Peptide_id appears \n&quot;)+
  ## adjust positions
  theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=10))</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-4-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>  # theme(panel.grid.major = element_blank())
  # theme(panel.grid.minor = element_blank())</code></pre>
<p>Why does DCL have so less?</p>
</div>
<div id="plotting-time-series-fluctuation-for-the-peptides" class="section level3">
<h3>4. Plotting time series fluctuation for the peptides</h3>
<p>First retrieve the log intensity value for all peptides (average over the same spec_id)</p>
<pre class="r"><code># (1) Get list of peptides that are present in 7 or 8 timepoints
df_all2_filt &lt;- df_all2 %&gt;% filter(Timepoints &gt; 6) %&gt;% unique() 

# (2) Let&#39;s average the intensity for each unique peptide
df_int &lt;- df_pep %&gt;% select(Peptide_id, Spec_id, log2.18O.16O.Ratio, SampleID, Time, Depth, Replicate) %&gt;% unique() %&gt;% arrange(Peptide_id)
head(df_int)</code></pre>
<pre><code>  Peptide_id         Spec_id log2.18O.16O.Ratio  SampleID Time Depth Replicate
1      Pep_1 BDCL_T1_A_31195         -0.3969800 BDCL_T1_A   T1  BDCL         A
2      Pep_1 BDCL_T1_A_31179         -0.5078004 BDCL_T1_A   T1  BDCL         A
3      Pep_1 BDCL_T1_A_31003         -0.3509932 BDCL_T1_A   T1  BDCL         A
4      Pep_1 BDCL_T1_A_31022         -0.4062575 BDCL_T1_A   T1  BDCL         A
5      Pep_1 BDCL_T1_A_31372         -0.4000644 BDCL_T1_A   T1  BDCL         A
6      Pep_1 BDCL_T1_A_31355         -0.3204865 BDCL_T1_A   T1  BDCL         A</code></pre>
<pre class="r"><code># first average the spectrum_id per sample 
# important to make sure to take log2 after averaging the original value(2^x)
df_int %&gt;% filter(Peptide_id==&#39;Pep_1&#39; &amp; Time ==&#39;T1&#39; &amp; SampleID == &#39;BDCL_T1_A&#39;)</code></pre>
<pre><code>   Peptide_id         Spec_id log2.18O.16O.Ratio  SampleID Time Depth Replicate
1       Pep_1 BDCL_T1_A_31195         -0.3969800 BDCL_T1_A   T1  BDCL         A
2       Pep_1 BDCL_T1_A_31179         -0.5078004 BDCL_T1_A   T1  BDCL         A
3       Pep_1 BDCL_T1_A_31003         -0.3509932 BDCL_T1_A   T1  BDCL         A
4       Pep_1 BDCL_T1_A_31022         -0.4062575 BDCL_T1_A   T1  BDCL         A
5       Pep_1 BDCL_T1_A_31372         -0.4000644 BDCL_T1_A   T1  BDCL         A
6       Pep_1 BDCL_T1_A_31355         -0.3204865 BDCL_T1_A   T1  BDCL         A
7       Pep_1 BDCL_T1_A_30845         -0.9341082 BDCL_T1_A   T1  BDCL         A
8       Pep_1 BDCL_T1_A_30832         -1.0560891 BDCL_T1_A   T1  BDCL         A
9       Pep_1 BDCL_T1_A_31549         -0.5557501 BDCL_T1_A   T1  BDCL         A
10      Pep_1 BDCL_T1_A_31536         -0.5959763 BDCL_T1_A   T1  BDCL         A
11      Pep_1 BDCL_T1_A_31789         -0.4540486 BDCL_T1_A   T1  BDCL         A
12      Pep_1 BDCL_T1_A_32226         -0.2962970 BDCL_T1_A   T1  BDCL         A</code></pre>
<pre class="r"><code>df_ave &lt;- df_int %&gt;% group_by(SampleID, Time, Depth, Replicate, Peptide_id) %&gt;% summarize(log2_Mean_intensity=log2(mean(2^log2.18O.16O.Ratio))) %&gt;% ungroup()
head(df_ave)</code></pre>
<pre><code># A tibble: 6 x 6
  SampleID  Time  Depth Replicate Peptide_id log2_Mean_intensity
  &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;                    &lt;dbl&gt;
1 BDCL_T1_A T1    BDCL  A         Pep_1                   -0.506
2 BDCL_T1_A T1    BDCL  A         Pep_10                  -0.446
3 BDCL_T1_A T1    BDCL  A         Pep_100                 -0.865
4 BDCL_T1_A T1    BDCL  A         Pep_101                 -0.820
5 BDCL_T1_A T1    BDCL  A         Pep_1017                -0.655
6 BDCL_T1_A T1    BDCL  A         Pep_1018                -1.64 </code></pre>
<pre class="r"><code>df_ave %&gt;% filter(Peptide_id==&#39;Pep_1&#39; &amp; Time ==&#39;T1&#39; &amp; SampleID == &#39;BDCL_T1_A&#39;) # check if Pep_1 in sample &#39;BDCL_T1_A&#39; is -0.5059 (yes correct)</code></pre>
<pre><code># A tibble: 1 x 6
  SampleID  Time  Depth Replicate Peptide_id log2_Mean_intensity
  &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;                    &lt;dbl&gt;
1 BDCL_T1_A T1    BDCL  A         Pep_1                   -0.506</code></pre>
<pre class="r"><code># then average and error by replicate
# see here for calculating error bar in log scale (https://faculty.washington.edu/stuve/log_error.pdf)
# for example of Pep_1
df_ave %&gt;% group_by(SampleID) %&gt;% filter(Peptide_id==&#39;Pep_1&#39;) %&gt;% head(10)</code></pre>
<pre><code># A tibble: 10 x 6
# Groups:   SampleID [10]
   SampleID  Time  Depth Replicate Peptide_id log2_Mean_intensity
   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;                    &lt;dbl&gt;
 1 BDCL_T1_A T1    BDCL  A         Pep_1                  -0.506 
 2 BDCL_T1_B T1    BDCL  B         Pep_1                  -0.606 
 3 BDCL_T1_C T1    BDCL  C         Pep_1                  -1.38  
 4 BDCL_T2_A T2    BDCL  A         Pep_1                  -1.04  
 5 BDCL_T2_B T2    BDCL  B         Pep_1                  -0.910 
 6 BDCL_T3_A T3    BDCL  A         Pep_1                  -0.0283
 7 BDCL_T3_B T3    BDCL  B         Pep_1                  -0.618 
 8 BDCL_T3_C T3    BDCL  C         Pep_1                  -0.240 
 9 BDCL_T4_A T4    BDCL  A         Pep_1                  -0.582 
10 BDCL_T4_B T4    BDCL  B         Pep_1                  -0.859 </code></pre>
<pre class="r"><code># calculate average and error bar for intensity
df_ave_rep &lt;- df_ave %&gt;% group_by(Time, Depth, Peptide_id) %&gt;% summarize(log2_ave_intensity=log2(mean(2^log2_Mean_intensity)), sd_intensity=sd(2^log2_Mean_intensity)) %&gt;% ungroup()
head(df_ave_rep)</code></pre>
<pre><code># A tibble: 6 x 5
  Time  Depth Peptide_id log2_ave_intensity sd_intensity
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;        &lt;dbl&gt;
1 T1    BDCL  Pep_1                  -0.781       0.173 
2 T1    BDCL  Pep_10                 -0.204       0.160 
3 T1    BDCL  Pep_100                -1.02        0.0770
4 T1    BDCL  Pep_1004               -1.03       NA     
5 T1    BDCL  Pep_1009               -0.749      NA     
6 T1    BDCL  Pep_101                -0.968       0.0619</code></pre>
<pre class="r"><code># why is there no sd for Pep_1004?
df_ave %&gt;% group_by(SampleID) %&gt;% filter(Peptide_id==&#39;Pep_1004&#39;) # there is only 1 sample for T1 BDCL </code></pre>
<pre><code># A tibble: 11 x 6
# Groups:   SampleID [11]
   SampleID  Time  Depth Replicate Peptide_id log2_Mean_intensity
   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;                    &lt;dbl&gt;
 1 BDCL_T1_B T1    BDCL  B         Pep_1004                -1.03 
 2 BDCL_T2_B T2    BDCL  B         Pep_1004                -0.320
 3 BDCL_T3_B T3    BDCL  B         Pep_1004                -0.697
 4 BDCL_T5_A T5    BDCL  A         Pep_1004                -0.341
 5 BDCL_T5_B T5    BDCL  B         Pep_1004                -0.602
 6 BDCL_T8_B T8    BDCL  B         Pep_1004                -0.876
 7 DCL_T1_B  T1    DCL   B         Pep_1004                -0.454
 8 SRF_T1_A  T1    SRF   A         Pep_1004                -0.548
 9 SRF_T3_B  T3    SRF   B         Pep_1004                -0.214
10 SRF_T6_A  T6    SRF   A         Pep_1004                -0.474
11 SRF_T7_B  T7    SRF   B         Pep_1004                -0.751</code></pre>
<pre class="r"><code># log scale error bar: d(log2y)=1/log2 * (dy / y)
df_ave_rep2 &lt;- df_ave_rep %&gt;% mutate(ave_intensity = 2^log2_ave_intensity) %&gt;% mutate(rel_error = sd_intensity/ave_intensity) %&gt;% mutate(log2_sd_intensity = (1/log(2))*rel_error) %&gt;% mutate(log2_error_up=log2_ave_intensity+log2_sd_intensity) %&gt;% mutate(log2_error_down=log2_ave_intensity-log2_sd_intensity)

head(df_ave_rep2)</code></pre>
<pre><code># A tibble: 6 x 10
  Time  Depth Peptide_id log2_ave_intensity sd_intensity ave_intensity rel_error
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
1 T1    BDCL  Pep_1                  -0.781       0.173          0.582     0.297
2 T1    BDCL  Pep_10                 -0.204       0.160          0.868     0.184
3 T1    BDCL  Pep_100                -1.02        0.0770         0.493     0.156
4 T1    BDCL  Pep_1004               -1.03       NA              0.488    NA    
5 T1    BDCL  Pep_1009               -0.749      NA              0.595    NA    
6 T1    BDCL  Pep_101                -0.968       0.0619         0.511     0.121
# ... with 3 more variables: log2_sd_intensity &lt;dbl&gt;, log2_error_up &lt;dbl&gt;,
#   log2_error_down &lt;dbl&gt;</code></pre>
<pre class="r"><code># (3) import time metadata and merge
(df_time &lt;- read.table(&#39;data/Time_metadata.txt&#39;, header=T, sep=&#39;\t&#39;))</code></pre>
<pre><code>  timepoint          date_time elapsed_hours
1        T1 6/26/2019 12:45:00             0
2        T2 6/26/2019 15:45:00             3
3        T3 6/26/2019 18:45:00             6
4        T4 6/26/2019 21:45:00             9
5        T5  6/27/2019 4:40:00            15
6        T6  6/27/2019 7:45:00            19
7        T7 6/27/2019 10:45:00            22
8        T8 6/27/2019 13:45:00            25</code></pre>
<pre class="r"><code># left_join with average data
df_ave2 &lt;- df_ave_rep2 %&gt;% left_join(df_time, by=c(&#39;Time&#39;=&#39;timepoint&#39;))
head(df_ave2)</code></pre>
<pre><code># A tibble: 6 x 12
  Time  Depth Peptide_id log2_ave_intensity sd_intensity ave_intensity rel_error
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
1 T1    BDCL  Pep_1                  -0.781       0.173          0.582     0.297
2 T1    BDCL  Pep_10                 -0.204       0.160          0.868     0.184
3 T1    BDCL  Pep_100                -1.02        0.0770         0.493     0.156
4 T1    BDCL  Pep_1004               -1.03       NA              0.488    NA    
5 T1    BDCL  Pep_1009               -0.749      NA              0.595    NA    
6 T1    BDCL  Pep_101                -0.968       0.0619         0.511     0.121
# ... with 5 more variables: log2_sd_intensity &lt;dbl&gt;, log2_error_up &lt;dbl&gt;,
#   log2_error_down &lt;dbl&gt;, date_time &lt;chr&gt;, elapsed_hours &lt;int&gt;</code></pre>
<pre class="r"><code># only use peptides that appear 7 or 8 times
df_ave2 %&gt;% select(Peptide_id) %&gt;% unique() %&gt;% dim() # 3233 peptides before</code></pre>
<pre><code>[1] 3233    1</code></pre>
<pre class="r"><code>df_filt78 &lt;- inner_join(df_ave2, df_all2_filt, by=c(&#39;Peptide_id&#39;=&#39;Peptide_id&#39;,&#39;Depth&#39;=&#39;Depth&#39;))

# inspecting if the inner join was successful
head(df_filt78)</code></pre>
<pre><code># A tibble: 6 x 13
  Time  Depth Peptide_id log2_ave_intensity sd_intensity ave_intensity rel_error
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
1 T1    BDCL  Pep_1                  -0.781       0.173          0.582     0.297
2 T1    BDCL  Pep_10                 -0.204       0.160          0.868     0.184
3 T1    BDCL  Pep_100                -1.02        0.0770         0.493     0.156
4 T1    BDCL  Pep_101                -0.968       0.0619         0.511     0.121
5 T1    BDCL  Pep_102                -1.21        0.109          0.432     0.251
6 T1    BDCL  Pep_1020               -1.31        0.108          0.404     0.267
# ... with 6 more variables: log2_sd_intensity &lt;dbl&gt;, log2_error_up &lt;dbl&gt;,
#   log2_error_down &lt;dbl&gt;, date_time &lt;chr&gt;, elapsed_hours &lt;int&gt;,
#   Timepoints &lt;int&gt;</code></pre>
<pre class="r"><code>colnames(df_ave2)</code></pre>
<pre><code> [1] &quot;Time&quot;               &quot;Depth&quot;              &quot;Peptide_id&quot;        
 [4] &quot;log2_ave_intensity&quot; &quot;sd_intensity&quot;       &quot;ave_intensity&quot;     
 [7] &quot;rel_error&quot;          &quot;log2_sd_intensity&quot;  &quot;log2_error_up&quot;     
[10] &quot;log2_error_down&quot;    &quot;date_time&quot;          &quot;elapsed_hours&quot;     </code></pre>
<pre class="r"><code>colnames(df_time)</code></pre>
<pre><code>[1] &quot;timepoint&quot;     &quot;date_time&quot;     &quot;elapsed_hours&quot;</code></pre>
<pre class="r"><code>colnames(df_filt78)</code></pre>
<pre><code> [1] &quot;Time&quot;               &quot;Depth&quot;              &quot;Peptide_id&quot;        
 [4] &quot;log2_ave_intensity&quot; &quot;sd_intensity&quot;       &quot;ave_intensity&quot;     
 [7] &quot;rel_error&quot;          &quot;log2_sd_intensity&quot;  &quot;log2_error_up&quot;     
[10] &quot;log2_error_down&quot;    &quot;date_time&quot;          &quot;elapsed_hours&quot;     
[13] &quot;Timepoints&quot;        </code></pre>
<pre class="r"><code>df_filt78 %&gt;% select(Peptide_id) %&gt;% unique() %&gt;% dim() # 736 peptides for peptides in 7 or 8 timepoints</code></pre>
<pre><code>[1] 736   1</code></pre>
<pre class="r"><code>df_filt78$Depth &lt;- factor(df_filt78$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))

# get only 8 ones
df_filt8 &lt;- df_filt78 %&gt;% filter(Timepoints &gt; 7)
df_filt8 %&gt;% select(Peptide_id) %&gt;% unique() %&gt;% dim() # 539 peptides for peptides in all 8 timepoints</code></pre>
<pre><code>[1] 539   1</code></pre>
<pre class="r"><code>df_filt8$Depth &lt;- factor(df_filt8$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))

# get only 7 ones
df_filt7 &lt;- df_filt78 %&gt;% filter(Timepoints == 7)
df_filt7 %&gt;% select(Peptide_id) %&gt;% unique() %&gt;% dim() # 533 peptides for peptides in 7 timepoints</code></pre>
<pre><code>[1] 533   1</code></pre>
<pre class="r"><code>df_filt8$Depth &lt;- factor(df_filt8$Depth, levels = c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;))</code></pre>
<p>Plot for peptides present in 7 or 8 timepoints</p>
<pre class="r"><code># (4) Plot the scatter plot with error bars
theme_set(theme_bw())

ggplot(df_filt78, aes(x=elapsed_hours,y=log2_ave_intensity, color=Depth, group=interaction(Peptide_id,Depth))) +
  geom_point(size=2, shape=21) +
  geom_line()+
  geom_errorbar(aes(ymin=log2_error_down, ymax=log2_error_up), width=.2, position=position_dodge(.9))+
  scale_color_manual(values=cols) +
  ylab(&quot;log2 Mean intensity (log2(18O/16O)) \n&quot;) +
  xlab(&quot;\n Elapsed hours after 12:45pm June 26 2019 (day 05:17-20:30)&quot;) +
  scale_x_continuous(breaks=seq(0,26,1))+
  ggtitle(&quot;Time series intensity of peptide_id \n&quot;)+
  ## adjust positions
  theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=10)) +
  annotate(&quot;rect&quot;, xmin = 7.75, xmax = 16.53, ymin = -Inf, ymax = Inf, alpha = .2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-6-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>  # geom_rect(aes(xmin=7.75, xmax=16.53, ymin=0, ymax=Inf))
  # theme(panel.grid.major = element_blank()) +
  # theme(panel.grid.minor = element_blank())</code></pre>
<p>without error bars</p>
<pre class="r"><code>theme_set(theme_bw())
ggplot(df_filt78, aes(x=elapsed_hours,y=log2_ave_intensity, color=Depth, group=interaction(Peptide_id,Depth))) +
  geom_point(size=2, shape=21) +
  geom_line()+
  # geom_errorbar(aes(ymin=log2_error_down, ymax=log2_error_up), width=.2, position=position_dodge(.9))+
  scale_color_manual(values=cols) +
  ylab(&quot;log2 Mean intensity (log2(18O/16O)) \n&quot;) +
  xlab(&quot;\n Elapsed hours after 12:45pm June 26 2019 (day 05:17-20:30)&quot;) +
  scale_x_continuous(breaks=seq(0,26,1))+
  ggtitle(&quot;Time series intensity of peptide_id \n&quot;)+
  ## adjust positions
  theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
  theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
  theme(axis.text.y = element_text(size=10)) +
  annotate(&quot;rect&quot;, xmin = 7.75, xmax = 16.53, ymin = -Inf, ymax = Inf, alpha = .2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-7-1.png" width="1056" style="display: block; margin: auto;" /></p>
<p>4.1. Surface(SRF)</p>
<pre class="r"><code># color code
# 1. Surface(orange): #fc8d62
# 2. DCL(green): #66c2a5
# 3. BDCL(blue): #8da0cb
color_vec &lt;- c(&#39;#fc8d62&#39;,&#39;#66c2a5&#39;,&#39;#8da0cb&#39;)
depth_vec &lt;- c(&#39;SRF&#39;,&#39;DCL&#39;,&#39;BDCL&#39;)

time_series_1depth_woError &lt;- function(df_filt78, depth){
  theme_set(theme_bw())
  # filter depth
  df_filt78_s &lt;- df_filt78 %&gt;% filter(Depth == depth_vec[depth])
  ggplot(df_filt78_s, aes(x=elapsed_hours,y=log2_ave_intensity, group=Peptide_id)) +
    geom_point(size=2, shape=21, color=color_vec[depth]) +
    geom_line(color= color_vec[depth])+
    ylab(&quot;Mean log2 intensity (log2(18O/16O)) \n&quot;) +
    xlab(&quot;\n Elapsed hours after 12:45pm June 26 2019 (day 05:17-20:30)&quot;) +
    scale_x_continuous(breaks=seq(0,26,1))+
    ggtitle(paste0(&quot;Time series intensity of peptide_id&quot;,&quot; (&quot;,depth_vec[depth],&quot;)&quot;,&quot;\n&quot;))+
    ## adjust positions
    theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
    theme(axis.text.y = element_text(size=10)) +
    annotate(&quot;rect&quot;, xmin = 7.75, xmax = 16.53, ymin = -Inf, ymax = Inf, alpha = .2)
    # theme(panel.grid.major = element_blank()) +
    # theme(panel.grid.minor = element_blank())
}

time_series_1depth_wError &lt;- function(df_filt78, depth){
  theme_set(theme_bw())
  # filter depth
  df_filt78_s &lt;- df_filt78 %&gt;% filter(Depth == depth_vec[depth])
  ggplot(df_filt78_s, aes(x=elapsed_hours,y=log2_ave_intensity, group=Peptide_id)) +
    geom_point(size=2, shape=21, color=color_vec[depth]) +
    geom_line(color= color_vec[depth])+
    geom_errorbar(aes(ymin=log2_error_down, ymax=log2_error_up), width=.05, position=position_dodge(.2),color=&#39;red&#39;)+
    ylab(&quot;Mean log2 intensity (log2(18O/16O)) \n&quot;) +
    xlab(&quot;\n Elapsed hours after 12:45pm June 26 2019 (day 05:17-20:30)&quot;) +
    scale_x_continuous(breaks=seq(0,26,1))+
    ggtitle(paste0(&quot;Time series intensity of peptide_id&quot;,&quot; (&quot;,depth_vec[depth],&quot;)&quot;,&quot;\n&quot;))+
    ## adjust positions
    theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
    theme(axis.text.y = element_text(size=10)) +
    annotate(&quot;rect&quot;, xmin = 7.75, xmax = 16.53, ymin = -Inf, ymax = Inf, alpha = .2)
    # theme(panel.grid.major = element_blank()) +
    # theme(panel.grid.minor = element_blank())
}

# when we use all 7, 8 appearance cases
time_series_1depth_woError(df_filt78,1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-8-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt78,1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-8-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># when we use only 8 appearance cases
time_series_1depth_woError(df_filt8,1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-8-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt8,1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-8-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># when we use only 7 appearance cases
time_series_1depth_woError(df_filt7,1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-8-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt7,1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-8-6.png" width="1056" style="display: block; margin: auto;" /></p>
<p>4.2. Deep Chlorophyll layer (DCL)</p>
<pre class="r"><code># when we use all 7, 8 appearance cases
time_series_1depth_woError(df_filt78,2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-9-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt78,2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-9-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># when we use only 8 appearance cases
time_series_1depth_woError(df_filt8,2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-9-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt8,2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-9-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># when we use only 7 appearance cases
time_series_1depth_woError(df_filt7,2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-9-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt7,2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-9-6.png" width="1056" style="display: block; margin: auto;" /></p>
<p>4.3. Below Deep Chlorophyll layer (BDCL)</p>
<pre class="r"><code># when we use all 7, 8 appearance cases
time_series_1depth_woError(df_filt78,3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-10-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt78,3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-10-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># when we use only 8 appearance cases
time_series_1depth_woError(df_filt8,3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-10-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt8,3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-10-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># when we use only 7 appearance cases
time_series_1depth_woError(df_filt7,3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-10-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>time_series_1depth_wError(df_filt7,3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-10-6.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="time-series-clustering" class="section level3">
<h3>5. Time series clustering</h3>
<p>For time series clustering with R, the first step is to work out an appropriate distance/similarity metric, and then, at the second step, use existing clustering techniques, such as k-means, hierarchical clustering, density-based clustering or subspace clustering, to find clustering structures. (<a href="http://www.rdatamining.com/examples/time-series-clustering-classification" class="uri">http://www.rdatamining.com/examples/time-series-clustering-classification</a>)</p>
<p>5.1. Approach 1: Hierarchical clustering using Dynamic time warping distance Dynamic Time Warping (DTW) finds optimal alignment between two time series, and DTW distance is used as a distance metric in the example below. (<a href="http://www.rdatamining.com/examples/time-series-clustering-classification" class="uri">http://www.rdatamining.com/examples/time-series-clustering-classification</a>)</p>
<pre class="r"><code># let&#39;s try cluster our time series data
colnames(df_filt8)</code></pre>
<pre><code> [1] &quot;Time&quot;               &quot;Depth&quot;              &quot;Peptide_id&quot;        
 [4] &quot;log2_ave_intensity&quot; &quot;sd_intensity&quot;       &quot;ave_intensity&quot;     
 [7] &quot;rel_error&quot;          &quot;log2_sd_intensity&quot;  &quot;log2_error_up&quot;     
[10] &quot;log2_error_down&quot;    &quot;date_time&quot;          &quot;elapsed_hours&quot;     
[13] &quot;Timepoints&quot;        </code></pre>
<pre class="r"><code>df_8 &lt;- df_filt8 %&gt;% filter(Depth==&#39;SRF&#39;) %&gt;% select(Peptide_id,Time,log2_ave_intensity)

# reshape the dataframe with timepoints
library(maditr)
v_names &lt;- c(&quot;T1&quot;,&quot;T2&quot;,&quot;T3&quot;,&quot;T4&quot;,&quot;T5&quot;,&quot;T6&quot;,&quot;T7&quot;,&quot;T8&quot;)
df_8$Time &lt;- factor(df_8$Time, levels=v_names)
dc_8 &lt;- dcast(df_8, Peptide_id ~ Time, value.var = &quot;log2_ave_intensity&quot;)
# make Peptide_id more simpler (Pep_1 -&gt; 1)
dc_8$Peptide_id &lt;- str_replace(dc_8$Peptide_id,&quot;Pep_&quot;,&quot;&quot;)
# make first column into row name
dc_8 &lt;- tibble::column_to_rownames(dc_8, var=&quot;Peptide_id&quot;)

# DTW distances
library(dtw)
any(is.na(dc_8)) # False: there is no NA in the table</code></pre>
<pre><code>[1] FALSE</code></pre>
<pre class="r"><code>distMatrix &lt;- dist(dc_8, method=&quot;DTW&quot;)
hc &lt;- hclust(distMatrix, method=&quot;average&quot;)
plot(hc, cex=0.7, xlab=&#39;Hierarchical clustering of Distance(DTW) Matrix&#39;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-11-1.png" width="1056" style="display: block; margin: auto;" /></p>
<p>Draw the particular small cluster in the time series plot</p>
<pre class="r"><code># function for plotting cluster of piptides
time_series_clust_wError &lt;- function(df_filt78, depth, clust1){
  theme_set(theme_bw())
  # filter depth
  df_filt78_s &lt;- df_filt78 %&gt;% filter(Depth == depth_vec[depth]) %&gt;% filter(Peptide_id %in% clust1)
  ggplot(df_filt78_s, aes(x=elapsed_hours,y=log2_ave_intensity, group=Peptide_id)) +
    geom_point(size=2, shape=21, color=color_vec[depth]) +
    geom_line(color= color_vec[depth])+
    geom_errorbar(aes(ymin=log2_error_down, ymax=log2_error_up), width=.05, position=position_dodge(.2),color=&#39;red&#39;)+
    ylab(&quot;Mean log2 intensity (log2(18O/16O)) \n&quot;) +
    xlab(&quot;\n Elapsed hours after 12:45pm June 26 2019 (day 05:17-20:30)&quot;) +
    scale_x_continuous(breaks=seq(0,26,1))+
    ggtitle(paste0(&quot;Time series intensity of peptide_id&quot;,&quot; (&quot;,depth_vec[depth],&quot;)&quot;,&quot;\n&quot;))+
    ## adjust positions
    theme(plot.title = element_text(size = 20,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.x = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.title.y = element_text(size = 15,hjust = 0.5, family=&quot;serif&quot;)) + 
    theme(axis.text.x = element_text(hjust = 0.5, vjust=0.3,size=13, family=&quot;serif&quot;))+
    theme(axis.text.y = element_text(size=10)) +
    annotate(&quot;rect&quot;, xmin = 7.75, xmax = 16.53, ymin = -Inf, ymax = Inf, alpha = .2)
    # theme(panel.grid.major = element_blank()) +
    # theme(panel.grid.minor = element_blank())
}

# cluster1
clust1 &lt;- c(&#39;149&#39;)
clust1 &lt;- str_replace(clust1,&quot;^&quot;,&quot;Pep_&quot;) # make Peptide_id
time_series_clust_wError(df_filt8, 1, clust1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-12-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># cluster2
clust2 &lt;- c(&quot;167&quot;,&quot;216&quot;,&quot;351&quot;,&quot;352&quot;,&quot;96&quot;,&quot;502&quot;,&quot;242&quot;, &quot;77&quot;,&quot;110&quot;,&quot;133&quot;, &quot;81&quot;,&quot;33&quot;,&quot;539&quot;,&quot;46&quot;,&quot;51&quot;, &quot;137&quot;,&quot;264&quot;,&quot;94&quot;,&quot;535&quot;,&quot;18&quot;,&quot;4&quot;, &quot;898&quot;, &quot;314&quot;, &quot;8&quot;)
clust2 &lt;- str_replace(clust2,&quot;^&quot;,&quot;Pep_&quot;) # make Peptide_id
time_series_clust_wError(df_filt8, 1, clust2)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-12-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># cluster
clust3 &lt;- c(&quot;374&quot;,&quot;479&quot;,&quot;758&quot;,&quot;905&quot;,&quot;52&quot;,&quot;435&quot;,&quot;461&quot;,&quot;111&quot;,&quot;196&quot;,&quot;482&quot;,&quot;691&quot;,&quot;597&quot;,&quot;739&quot;,&quot;657&quot;,&quot;740&quot;)
clust3 &lt;- str_replace(clust3,&quot;^&quot;,&quot;Pep_&quot;) # make Peptide_id
time_series_clust_wError(df_filt8, 1, clust3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-12-3.png" width="1056" style="display: block; margin: auto;" /></p>
<p>5.2. Unsupervised clustering with various distances (SBD, DTW, …) / prototyping methods / clustering methods<br />
- Using dtwclust package - How many clusters should we use? Evaluate by CVI (Cluster validity index, the bigger the better for internal CVI)<br />
- Please normalize before clustering</p>
<ol start="0" style="list-style-type: decimal">
<li>Data formating for tsclust input</li>
</ol>
<pre class="r"><code># (1) Change our data into list format for input into tsclust
colnames(df_filt8)</code></pre>
<pre><code> [1] &quot;Time&quot;               &quot;Depth&quot;              &quot;Peptide_id&quot;        
 [4] &quot;log2_ave_intensity&quot; &quot;sd_intensity&quot;       &quot;ave_intensity&quot;     
 [7] &quot;rel_error&quot;          &quot;log2_sd_intensity&quot;  &quot;log2_error_up&quot;     
[10] &quot;log2_error_down&quot;    &quot;date_time&quot;          &quot;elapsed_hours&quot;     
[13] &quot;Timepoints&quot;        </code></pre>
<pre class="r"><code>make_list &lt;- function(df_filt8,depth){
  df_SRF8 &lt;- df_filt8 %&gt;% filter(Depth==depth) %&gt;% select(Peptide_id,Time,log2_ave_intensity)
  # reshape the dataframe with timepoints
  library(maditr)
  v_names &lt;- c(&quot;T1&quot;,&quot;T2&quot;,&quot;T3&quot;,&quot;T4&quot;,&quot;T5&quot;,&quot;T6&quot;,&quot;T7&quot;,&quot;T8&quot;)
  df_SRF8$Time &lt;- factor(df_SRF8$Time, levels=v_names)
  dc_SRF8 &lt;- dcast(df_SRF8, Peptide_id ~ Time, value.var = &quot;log2_ave_intensity&quot;)
  # make Peptide_id more simpler (Pep_1 -&gt; P.1)
  dc_SRF8$Peptide_id &lt;- str_replace(dc_SRF8$Peptide_id,&quot;Pep_&quot;,&quot;P.&quot;)
  # make first column into row name
  dc_SRF8 &lt;- tibble::column_to_rownames(dc_SRF8, var=&quot;Peptide_id&quot;)
  # make it into list format
  # l_SRF8 &lt;- setNames(split(dc_SRF8, seq(nrow(dc_SRF8))), rownames(dc_SRF8))
  l_SRF8 &lt;- as.list(as.data.frame(t(dc_SRF8)))
  return(l_SRF8)
}

l_SRF8 &lt;- make_list(df_filt8,&#39;SRF&#39;)
l_DCL8 &lt;- make_list(df_filt8,&#39;DCL&#39;)
l_BDCL8 &lt;- make_list(df_filt8,&#39;BDCL&#39;)</code></pre>
<ol style="list-style-type: decimal">
<li>Hierarchical clustering w/ shape based distance</li>
</ol>
<pre class="r"><code># input into tsclust
library(dtwclust)
require(&quot;TSclust&quot;)

### Hierarchical clustering w/ shape based distance
hc_sbd &lt;- tsclust(l_SRF8, type = &quot;h&quot;, k = 2L:10L,
  preproc = zscore, seed = 899,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))

internal_CVI &lt;- function(hc_sbd,main){
  names(hc_sbd) &lt;- 2L:10L
  (eval &lt;- sapply(hc_sbd, cvi, type = &quot;internal&quot;))
  # divide CH value with 100 just to plot with other internal CVIs 
  eval[&#39;CH&#39;,] &lt;- eval[&#39;CH&#39;,]/100
  t(eval)
  matplot(x=seq(2,10,by=1),y=t(eval), type = c(&quot;b&quot;),pch=1,col = 1:7,
          xlab=&quot;Number of clusters&quot;,ylab=&quot;Internal CVI (cluster validity index)&quot;,main=main,axes=F) #plot
  axis(2)
  axis(side=1,at=2:10)
  legend(&quot;bottomright&quot;, legend = c(&quot;Sil&quot;,&quot;SF&quot;,&quot;CH/100&quot;,&quot;DB&quot;,&quot;DBstar&quot;,&quot;D&quot;,&quot;COP&quot;), col=1:7, pch=1,cex=0.8) # optional legend
}

internal_CVI(hc_sbd,&quot;Hierarchical clustering w/ shape based distance&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 3 or 4 clusters
hc_sbd3 &lt;- tsclust(l_SRF8, type = &quot;h&quot;, k = 3L,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))

hc_sbd4 &lt;- tsclust(l_SRF8, type = &quot;h&quot;, k = 4L,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))

# cluster dendrogram
plot(hc_sbd3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># The series and the obtained prototypes can be plotted too
plot(hc_sbd3, type = &quot;sc&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Focusing on the first cluster
plot(hc_sbd3, type = &quot;series&quot;, clus = 1L)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-4.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(hc_sbd3, type = &quot;centroids&quot;, clus = 1L)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-5.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># cluster dendrogram
plot(hc_sbd4)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-6.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># The series and the obtained prototypes can be plotted too
plot(hc_sbd4, type = &quot;sc&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-14-7.png" width="1056" style="display: block; margin: auto;" /></p>
<p>(2-1) partial clustering methods - DTW</p>
<pre class="r"><code>### partial clustering methods
# z-normalization
l_SRF8_z &lt;- zscore(l_SRF8)

# DTW distance
pc_dtw &lt;- tsclust(l_SRF8_z, k = 2L:10L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 8L,
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 837.7641
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 2: Changes / Distsum = 40 / 676.8562
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 12 / 672.476
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 3 / 672.3992
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 0 / 672.1413

Iteration 1: Changes / Distsum = 424 / 713.123
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
Iteration 2: Changes / Distsum = 59 / 644.8097
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 43 / 636.7099
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 4: Changes / Distsum = 13 / 632.0591
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 5: Changes / Distsum = 13 / 630.8079
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 10 / 629.7147
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 11 / 628.179
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 8: Changes / Distsum = 2 / 627.0636
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 9: Changes / Distsum = 0 / 626.7866

Iteration 1: Changes / Distsum = 424 / 705.456
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 2: Changes / Distsum = 140 / 632.637
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 49 / 617.8038
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 4: Changes / Distsum = 38 / 612.1329
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 5: Changes / Distsum = 22 / 610.2031
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 17 / 609.7836
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 15 / 609.7511
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 8: Changes / Distsum = 11 / 609.5684
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 8 / 609.2241
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
Iteration 10: Changes / Distsum = 18 / 609.113
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 11: Changes / Distsum = 14 / 608.2401
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 12: Changes / Distsum = 10 / 608.0425
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 13: Changes / Distsum = 10 / 607.459
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 14: Changes / Distsum =  6 / 606.965
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 15: Changes / Distsum = 4 / 606.5796
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 16: Changes / Distsum = 4 / 606.2551
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 17: Changes / Distsum = 0 / 606.2718

Iteration 1: Changes / Distsum = 424 / 691.6452
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
Iteration 2: Changes / Distsum = 94 / 619.9781
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 3: Changes / Distsum = 54 / 595.4692
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 17 / 591.6031
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 8 / 591.2969
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 6: Changes / Distsum = 3 / 591.2872
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 3 / 591.1367
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 3 / 590.9102
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum =  2 / 590.735
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 1 / 590.6449
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum =  1 / 590.578
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum = 2 / 590.2061
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 3 / 589.9384
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum =  4 / 589.754
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum = 5 / 589.5962
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 16: Changes / Distsum = 2 / 589.2462
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 17: Changes / Distsum = 2 / 589.1934
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 18: Changes / Distsum = 1 / 589.1304
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 19: Changes / Distsum = 0 / 589.0896

Iteration 1: Changes / Distsum = 424 / 642.5331
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
Iteration 2: Changes / Distsum = 52 / 574.976
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 33 / 568.7701
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 20 / 564.5507
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 5: Changes / Distsum = 24 / 561.8103
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 17 / 559.5756
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 7: Changes / Distsum =  5 / 558.778
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 1 / 558.9816
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 0 / 559.0266

Iteration 1: Changes / Distsum = 424 / 646.413
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 2: Changes / Distsum = 104 / 593.1594
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 3: Changes / Distsum = 70 / 581.8461
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 55 / 570.879
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 5: Changes / Distsum = 47 / 562.1578
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 26 / 555.7919
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 15 / 552.6757
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 19 / 549.1367
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 12 / 546.1405
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 10: Changes / Distsum = 14 / 544.931
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 8 / 544.6424
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 12: Changes / Distsum = 4 / 544.4062
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 2 / 544.1247
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 14: Changes / Distsum = 2 / 543.9265
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 15: Changes / Distsum = 0 / 543.8863

Iteration 1: Changes / Distsum = 424 / 612.6845
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 2: Changes / Distsum = 75 / 574.049
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 3: Changes / Distsum = 60 / 562.6258
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 47 / 553.4506
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 39 / 548.0562
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 27 / 544.9811
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 19 / 543.9388
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 8: Changes / Distsum = 14 / 543.7594
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 9: Changes / Distsum = 8 / 543.8479
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 6 / 543.3883
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 6 / 543.3656
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 12: Changes / Distsum = 3 / 543.1945
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 3 / 543.2105
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum = 5 / 543.1334
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum = 2 / 542.8555
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 16: Changes / Distsum =  0 / 542.946

Iteration 1: Changes / Distsum = 424 / 605.1872
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 2: Changes / Distsum = 76 / 549.9719
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 3: Changes / Distsum = 32 / 545.0619
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 20 / 541.2164
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 18 / 537.4147
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 6: Changes / Distsum = 18 / 533.621
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 26 / 530.192
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 19 / 526.7403
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 11 / 524.7159
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 13 / 523.3768
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 7 / 521.7618
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 12: Changes / Distsum = 10 / 520.9247
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 13: Changes / Distsum = 5 / 520.6718
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 14: Changes / Distsum = 2 / 520.5759
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 15: Changes / Distsum = 3 / 520.5492
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 16: Changes / Distsum = 1 / 520.4426
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 17: Changes / Distsum = 1 / 520.3869
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 18: Changes / Distsum = 0 / 520.2891

Iteration 1: Changes / Distsum = 424 / 600.0815
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1 - Converged!
Iteration 2: Changes / Distsum = 93 / 541.6657
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 3: Changes / Distsum = 50 / 530.1269
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 4: Changes / Distsum = 44 / 520.8806
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 32 / 515.1676
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 6: Changes / Distsum = 13 / 512.8808
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 5 / 512.2954
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 2 / 512.2923
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 1 / 512.1826
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 10: Changes / Distsum = 1 / 512.1642
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 0 / 512.1043

    Elapsed time is 1.91 seconds.</code></pre>
<pre class="r"><code>internal_CVI(pc_dtw, &quot;Partial clustering with DTW distance&quot;)</code></pre>
<pre><code>    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18 - Converged!</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-15-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 4, 5, 7 clusters
pc_dtw4 &lt;- tsclust(l_SRF8_z, k = 4L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 8L,
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 684.7276
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 2: Changes / Distsum = 74 / 615.4492
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 32 / 606.7503
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 4: Changes / Distsum = 20 / 600.5017
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 14 / 597.3448
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 6 / 596.5909
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 0 / 596.7076

    Elapsed time is 0.11 seconds.</code></pre>
<pre class="r"><code>pc_dtw5 &lt;- tsclust(l_SRF8_z, k = 5L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 8L,
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 670.696
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
Iteration 2: Changes / Distsum = 83 / 584.9872
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 30 / 573.5762
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 14 / 571.5058
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 9 / 570.9038
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 6: Changes / Distsum = 7 / 570.5918
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 7 / 570.3472
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 1 / 570.2049
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum =  0 / 570.166

    Elapsed time is 0.14 seconds.</code></pre>
<pre class="r"><code>pc_dtw7 &lt;- tsclust(l_SRF8_z, k = 7L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 8L,
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 658.6697
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 2: Changes / Distsum = 93 / 569.0959
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 3: Changes / Distsum = 44 / 555.4464
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 18 / 551.7695
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum = 5 / 550.2864
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 12 / 549.6522
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 7: Changes / Distsum = 5 / 549.3066
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 4 / 549.0096
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 8 / 548.5317
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum =  8 / 547.939
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 8 / 547.1678
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 12: Changes / Distsum = 4 / 546.4228
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 13: Changes / Distsum = 2 / 546.5455
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum = 2 / 546.6194
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum = 0 / 546.5289

    Elapsed time is 0.22 seconds.</code></pre>
<pre class="r"><code># Prototypes for 4 clusters
plot(pc_dtw4)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-15-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for 5 clusters
plot(pc_dtw5)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-15-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for 7 clusters
plot(pc_dtw7)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-15-4.png" width="1056" style="display: block; margin: auto;" /></p>
<p>(2-2) partial clustering methods - DTW_lb cross-distance matrix is NOT symmetric, which can be problematic for</p>
<pre class="r"><code># DTW_lb distance method
pc_dtwlb &lt;- tsclust(l_SRF8_z, k = 2L:10L,
  distance = &quot;dtw_lb&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 4L,
  control = partitional_control(pam.precompute = FALSE),
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 837.7735
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 2: Changes / Distsum = 40 / 677.2462
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 3: Changes / Distsum = 12 / 673.1021
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 4: Changes / Distsum = 3 / 672.5112
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 1 / 672.2699
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 2 / 672.1298
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 3 / 672.1824
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum =  1 / 671.834
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 9: Changes / Distsum = 5 / 671.8343
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 10: Changes / Distsum = 1 / 671.4003
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 11: Changes / Distsum = 0 / 671.2992

Iteration 1: Changes / Distsum = 424 / 713.1526
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
Iteration 2: Changes / Distsum = 59 / 644.9703
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 43 / 636.8731
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 4: Changes / Distsum = 13 / 632.2127
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 5: Changes / Distsum = 14 / 630.9387
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 9 / 629.7357
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 11 / 628.4192
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 8: Changes / Distsum = 1 / 627.2398
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 0 / 627.0085

Iteration 1: Changes / Distsum = 424 / 705.6913
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
Iteration 2: Changes / Distsum = 133 / 632.8126
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 57 / 617.002
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 4: Changes / Distsum = 27 / 611.1268
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 5: Changes / Distsum = 20 / 609.7637
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 6: Changes / Distsum = 17 / 609.3526
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 7: Changes / Distsum = 13 / 609.1593
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 8: Changes / Distsum = 9 / 608.9651
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 13 / 609.2297
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
Iteration 10: Changes / Distsum = 12 / 608.6984
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 10 / 607.9724
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum =  6 / 607.386
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 13: Changes / Distsum = 10 / 607.1356
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 14: Changes / Distsum = 10 / 606.5816
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 15: Changes / Distsum = 5 / 605.9825
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 16: Changes / Distsum = 0 / 605.8668

Iteration 1: Changes / Distsum = 424 / 691.6497
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
Iteration 2: Changes / Distsum = 87 / 622.4207
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 3: Changes / Distsum = 57 / 596.9498
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 18 / 592.3744
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 11 / 591.9529
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 6: Changes / Distsum =  6 / 591.657
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 4 / 591.4229
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 3 / 590.8425
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 4 / 590.5225
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 4 / 590.1917
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 11: Changes / Distsum = 4 / 589.7865
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 12: Changes / Distsum = 4 / 589.4766
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 13: Changes / Distsum = 7 / 588.6399
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum =  4 / 587.936
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 15: Changes / Distsum = 5 / 587.5831
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 16: Changes / Distsum = 7 / 587.0608
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 17: Changes / Distsum = 5 / 586.1688
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 18: Changes / Distsum = 6 / 585.6281
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 19: Changes / Distsum = 5 / 585.2422
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 20: Changes / Distsum = 2 / 585.0732
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 21: Changes / Distsum = 3 / 585.0456
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 22: Changes / Distsum = 3 / 585.1037
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 23: Changes / Distsum = 0 / 585.0548

Iteration 1: Changes / Distsum = 424 / 642.5366
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
Iteration 2: Changes / Distsum = 52 / 574.976
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 33 / 568.8178
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 20 / 564.4819
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 5: Changes / Distsum = 22 / 561.7997
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 6: Changes / Distsum = 19 / 559.6681
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 7: Changes / Distsum = 5 / 558.3871
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 2 / 558.1468
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 1 / 558.0975
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 0 / 558.0752

Iteration 1: Changes / Distsum = 424 / 646.4274
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 2: Changes / Distsum = 105 / 593.2074
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 3: Changes / Distsum = 76 / 578.8887
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 4: Changes / Distsum = 50 / 569.6825
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 5: Changes / Distsum = 40 / 561.1869
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 28 / 556.7661
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 18 / 554.4278
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 8: Changes / Distsum = 19 / 551.1638
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 13 / 549.5969
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 13 / 547.8961
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 11: Changes / Distsum = 9 / 546.2824
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum =  9 / 545.445
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 7 / 544.8721
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 14: Changes / Distsum = 3 / 544.7822
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum = 5 / 544.6579
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 16: Changes / Distsum = 6 / 544.1657
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 17: Changes / Distsum = 4 / 543.6922
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 18: Changes / Distsum = 0 / 543.7148

Iteration 1: Changes / Distsum = 424 / 612.8833
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 2: Changes / Distsum = 72 / 574.3342
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 3: Changes / Distsum = 55 / 563.6968
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 45 / 554.3876
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 5: Changes / Distsum = 31 / 550.2312
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 6: Changes / Distsum = 36 / 547.3352
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 25 / 545.427
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 15 / 544.5716
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 10 / 544.2227
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum = 20 / 542.1422
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 11: Changes / Distsum = 11 / 539.8553
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum =  8 / 538.735
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 13 / 537.2757
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 14: Changes / Distsum = 12 / 536.8118
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum =  8 / 535.991
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 16: Changes / Distsum = 9 / 535.8227
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 17: Changes / Distsum = 7 / 535.4407
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 18: Changes / Distsum = 13 / 534.9361
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 19: Changes / Distsum = 1 / 535.0951
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 20: Changes / Distsum = 2 / 535.1217
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 21: Changes / Distsum = 1 / 535.1453
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 22: Changes / Distsum = 3 / 535.1157
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 23: Changes / Distsum = 2 / 534.9935
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 24: Changes / Distsum = 2 / 534.9358
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 25: Changes / Distsum = 3 / 534.9118
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 26: Changes / Distsum = 2 / 534.9833
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 27: Changes / Distsum = 0 / 535.0576

Iteration 1: Changes / Distsum = 424 / 605.2519
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
Iteration 2: Changes / Distsum = 74 / 550.033
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 3: Changes / Distsum = 31 / 545.0757
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 4: Changes / Distsum = 24 / 541.6724
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 5: Changes / Distsum =  18 / 537.19
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 27 / 532.4771
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 7: Changes / Distsum = 27 / 527.3292
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 17 / 524.5549
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 12 / 522.9514
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 4 / 522.3964
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 11: Changes / Distsum = 4 / 521.8214
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 12: Changes / Distsum = 7 / 521.6429
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 13: Changes / Distsum = 5 / 521.5748
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 14: Changes / Distsum =  2 / 521.428
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 15: Changes / Distsum = 1 / 521.4018
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 16: Changes / Distsum = 1 / 521.3733
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 17: Changes / Distsum = 1 / 521.3657
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 18: Changes / Distsum = 2 / 521.3768
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 19: Changes / Distsum = 0 / 521.1723

Iteration 1: Changes / Distsum = 424 / 600.108
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1 - Converged!
Iteration 2: Changes / Distsum = 92 / 541.186
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 3: Changes / Distsum = 46 / 530.1588
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 39 / 521.523
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
Iteration 5: Changes / Distsum = 33 / 516.3971
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
Iteration 6: Changes / Distsum = 13 / 514.1648
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 15 / 512.8581
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 8: Changes / Distsum = 4 / 512.0193
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 9: Changes / Distsum = 1 / 511.7074
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 10: Changes / Distsum =  0 / 511.633

    Elapsed time is 2.65 seconds.</code></pre>
<pre class="r"><code>internal_CVI(pc_dtwlb, &quot;Partial clustering with DTW_lb distance&quot;)</code></pre>
<pre><code>    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
         Did not &#39;converge&#39;
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13, 14, 15 - Converged!</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-16-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 8 clusters
pc_dtwlb8 &lt;- tsclust(l_SRF8_z, k = 8L,
  distance = &quot;dtw_lb&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 4L,
  control = partitional_control(pam.precompute = FALSE),
  args = tsclust_args(cent = list(trace = TRUE)))</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 656.7353
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12, 13 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
         11, 12 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 2: Changes / Distsum = 93 / 566.8099
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8, 9 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
Iteration 3: Changes / Distsum = 41 / 553.2823
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7, 8 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6 - Converged!
    DBA Iteration: 1, 2, 3, 4, 5, 6, 7 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
Iteration 4: Changes / Distsum = 24 / 548.9263
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 5: Changes / Distsum = 18 / 547.0032
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 6: Changes / Distsum = 10 / 546.153
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 7: Changes / Distsum = 6 / 545.8056
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 8: Changes / Distsum = 5 / 545.7109
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3, 4 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 9: Changes / Distsum = 3 / 545.5889
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
Iteration 10: Changes / Distsum = 3 / 545.5444
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2, 3 - Converged!
    DBA Iteration: 1, 2 - Converged!
    DBA Iteration: 1, 2 - Converged!
Iteration 11: Changes / Distsum = 0 / 545.6608

    Elapsed time is 0.18 seconds.</code></pre>
<pre class="r"><code># Prototypes for 8 clusters
plot(pc_dtwlb8)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-16-2.png" width="1056" style="display: block; margin: auto;" /></p>
<p>(2-3) partial clustering methods - k-shape</p>
<pre class="r"><code># k-shape method
pc_ks &lt;- tsclust(l_SRF8_z, k = 2L:10L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 127.8352
Iteration 2: Changes / Distsum = 31 / 84.35843
Iteration 3: Changes / Distsum = 9 / 81.47124
Iteration 4: Changes / Distsum = 6 / 80.31175
Iteration 5: Changes / Distsum = 8 / 79.82077
Iteration 6: Changes / Distsum = 10 / 79.34237
Iteration 7: Changes / Distsum = 6 / 78.92006
Iteration 8: Changes / Distsum = 9 / 78.66047
Iteration 9: Changes / Distsum =  9 / 78.3451
Iteration 10: Changes / Distsum =  2 / 78.2486
Iteration 11: Changes / Distsum = 3 / 78.24276
Iteration 12: Changes / Distsum = 0 / 78.24913

Iteration 1: Changes / Distsum = 424 / 91.63448
Iteration 2: Changes / Distsum = 57 / 73.75331
Iteration 3: Changes / Distsum = 34 / 71.78614
Iteration 4: Changes / Distsum = 20 / 71.08878
Iteration 5: Changes / Distsum = 18 / 70.63454
Iteration 6: Changes / Distsum = 11 / 70.37204
Iteration 7: Changes / Distsum = 12 / 70.27019
Iteration 8: Changes / Distsum = 11 / 70.17373
Iteration 9: Changes / Distsum =  6 / 70.1371
Iteration 10: Changes / Distsum = 5 / 70.12271
Iteration 11: Changes / Distsum = 1 / 70.13185
Iteration 12: Changes / Distsum = 0 / 70.13395

Iteration 1: Changes / Distsum = 424 / 79.99188
Iteration 2: Changes / Distsum = 59 / 70.77821
Iteration 3: Changes / Distsum = 37 / 67.79595
Iteration 4: Changes / Distsum = 39 / 65.41857
Iteration 5: Changes / Distsum = 26 / 64.0674
Iteration 6: Changes / Distsum = 17 / 63.53135
Iteration 7: Changes / Distsum = 18 / 63.03356
Iteration 8: Changes / Distsum = 15 / 62.81145
Iteration 9: Changes / Distsum = 9 / 62.65685
Iteration 10: Changes / Distsum = 9 / 62.57608
Iteration 11: Changes / Distsum = 2 / 62.54508
Iteration 12: Changes / Distsum = 1 / 62.51721
Iteration 13: Changes / Distsum = 2 / 62.50475
Iteration 14: Changes / Distsum = 1 / 62.50677
Iteration 15: Changes / Distsum = 0 / 62.50656

Iteration 1: Changes / Distsum = 424 / 80.28873
Iteration 2: Changes / Distsum = 63 / 67.43831
Iteration 3: Changes / Distsum = 60 / 65.1471
Iteration 4: Changes / Distsum = 43 / 63.34235
Iteration 5: Changes / Distsum = 29 / 62.35339
Iteration 6: Changes / Distsum = 21 / 61.62261
Iteration 7: Changes / Distsum = 20 / 61.01708
Iteration 8: Changes / Distsum = 15 / 60.4075
Iteration 9: Changes / Distsum = 13 / 59.97423
Iteration 10: Changes / Distsum = 6 / 59.69924
Iteration 11: Changes / Distsum = 6 / 59.67798
Iteration 12: Changes / Distsum = 5 / 59.60016
Iteration 13: Changes / Distsum = 5 / 59.50334
Iteration 14: Changes / Distsum = 3 / 59.44172
Iteration 15: Changes / Distsum =  5 / 59.3639
Iteration 16: Changes / Distsum =  6 / 59.1843
Iteration 17: Changes / Distsum = 5 / 59.11497
Iteration 18: Changes / Distsum = 3 / 59.07076
Iteration 19: Changes / Distsum = 2 / 59.05037
Iteration 20: Changes / Distsum = 1 / 59.03982
Iteration 21: Changes / Distsum = 1 / 59.03794
Iteration 22: Changes / Distsum = 1 / 59.03843
Iteration 23: Changes / Distsum = 0 / 59.03373

Iteration 1: Changes / Distsum = 424 / 66.70894
Iteration 2: Changes / Distsum = 55 / 57.57221
Iteration 3: Changes / Distsum = 37 / 55.71473
Iteration 4: Changes / Distsum = 16 / 54.99563
Iteration 5: Changes / Distsum = 5 / 54.83773
Iteration 6: Changes / Distsum =  4 / 54.7453
Iteration 7: Changes / Distsum = 5 / 54.61884
Iteration 8: Changes / Distsum = 3 / 54.54992
Iteration 9: Changes / Distsum = 2 / 54.50298
Iteration 10: Changes / Distsum = 4 / 54.49187
Iteration 11: Changes / Distsum = 4 / 54.43837
Iteration 12: Changes / Distsum = 4 / 54.37353
Iteration 13: Changes / Distsum = 1 / 54.33473
Iteration 14: Changes / Distsum = 1 / 54.31347
Iteration 15: Changes / Distsum = 0 / 54.31179

Iteration 1: Changes / Distsum = 424 / 69.42148
Iteration 2: Changes / Distsum = 83 / 60.8033
Iteration 3: Changes / Distsum = 61 / 57.98168
Iteration 4: Changes / Distsum = 41 / 55.24823
Iteration 5: Changes / Distsum = 25 / 54.12382
Iteration 6: Changes / Distsum = 19 / 53.61069
Iteration 7: Changes / Distsum = 12 / 53.24575
Iteration 8: Changes / Distsum = 6 / 53.07515
Iteration 9: Changes / Distsum = 7 / 53.00589
Iteration 10: Changes / Distsum = 7 / 52.89861
Iteration 11: Changes / Distsum = 3 / 52.81761
Iteration 12: Changes / Distsum = 9 / 52.70754
Iteration 13: Changes / Distsum = 7 / 52.38418
Iteration 14: Changes / Distsum = 8 / 52.22399
Iteration 15: Changes / Distsum = 8 / 52.12492
Iteration 16: Changes / Distsum = 3 / 52.01335
Iteration 17: Changes / Distsum = 6 / 51.95592
Iteration 18: Changes / Distsum = 7 / 51.90004
Iteration 19: Changes / Distsum = 6 / 51.83915
Iteration 20: Changes / Distsum = 3 / 51.69992
Iteration 21: Changes / Distsum = 5 / 51.65069
Iteration 22: Changes / Distsum = 2 / 51.60975
Iteration 23: Changes / Distsum = 1 / 51.58112
Iteration 24: Changes / Distsum = 0 / 51.57497

Iteration 1: Changes / Distsum = 424 / 63.5389
Iteration 2: Changes / Distsum = 80 / 54.96947
Iteration 3: Changes / Distsum = 67 / 51.2042
Iteration 4: Changes / Distsum = 41 / 49.37241
Iteration 5: Changes / Distsum = 26 / 48.53739
Iteration 6: Changes / Distsum = 11 / 48.2218
Iteration 7: Changes / Distsum = 10 / 48.09409
Iteration 8: Changes / Distsum = 6 / 47.99314
Iteration 9: Changes / Distsum = 5 / 47.95021
Iteration 10: Changes / Distsum =  2 / 47.9402
Iteration 11: Changes / Distsum = 3 / 47.93425
Iteration 12: Changes / Distsum = 3 / 47.91191
Iteration 13: Changes / Distsum = 2 / 47.89456
Iteration 14: Changes / Distsum = 3 / 47.88037
Iteration 15: Changes / Distsum = 1 / 47.86614
Iteration 16: Changes / Distsum = 1 / 47.86509
Iteration 17: Changes / Distsum = 1 / 47.85159
Iteration 18: Changes / Distsum = 1 / 47.83419
Iteration 19: Changes / Distsum = 4 / 47.83091
Iteration 20: Changes / Distsum = 4 / 47.80601
Iteration 21: Changes / Distsum = 0 / 47.77499

Iteration 1: Changes / Distsum = 424 / 59.57675
Iteration 2: Changes / Distsum = 53 / 50.64901
Iteration 3: Changes / Distsum = 34 / 48.83143
Iteration 4: Changes / Distsum = 19 / 47.77401
Iteration 5: Changes / Distsum = 16 / 47.15763
Iteration 6: Changes / Distsum = 9 / 46.79344
Iteration 7: Changes / Distsum = 12 / 46.58196
Iteration 8: Changes / Distsum = 13 / 46.30513
Iteration 9: Changes / Distsum = 8 / 46.02839
Iteration 10: Changes / Distsum = 9 / 45.88055
Iteration 11: Changes / Distsum = 6 / 45.78132
Iteration 12: Changes / Distsum = 8 / 45.71217
Iteration 13: Changes / Distsum = 8 / 45.64266
Iteration 14: Changes / Distsum = 3 / 45.58355
Iteration 15: Changes / Distsum = 2 / 45.55463
Iteration 16: Changes / Distsum =  1 / 45.5514
Iteration 17: Changes / Distsum = 1 / 45.54965
Iteration 18: Changes / Distsum = 1 / 45.53893
Iteration 19: Changes / Distsum = 2 / 45.52778
Iteration 20: Changes / Distsum = 2 / 45.49593
Iteration 21: Changes / Distsum = 1 / 45.47808
Iteration 22: Changes / Distsum = 0 / 45.47592

Iteration 1: Changes / Distsum = 424 / 61.51845
Iteration 2: Changes / Distsum = 86 / 51.21426
Iteration 3: Changes / Distsum = 40 / 48.23107
Iteration 4: Changes / Distsum = 39 / 47.11085
Iteration 5: Changes / Distsum = 27 / 46.24415
Iteration 6: Changes / Distsum = 24 / 45.55183
Iteration 7: Changes / Distsum = 22 / 45.09483
Iteration 8: Changes / Distsum = 10 / 44.54623
Iteration 9: Changes / Distsum = 7 / 44.36281
Iteration 10: Changes / Distsum = 4 / 44.25711
Iteration 11: Changes / Distsum = 4 / 44.18221
Iteration 12: Changes / Distsum =  3 / 44.1342
Iteration 13: Changes / Distsum = 2 / 44.11238
Iteration 14: Changes / Distsum = 2 / 44.10935
Iteration 15: Changes / Distsum = 2 / 44.09725
Iteration 16: Changes / Distsum = 0 / 44.09232

    Elapsed time is 6.53 seconds.</code></pre>
<pre class="r"><code>internal_CVI(pc_ks, &quot;Partial clustering with k-shape method&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-17-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 3 or 4 clusters
pc_ks3 &lt;- tsclust(l_SRF8_z, k = 3L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 108.647
Iteration 2: Changes / Distsum = 56 / 76.80189
Iteration 3: Changes / Distsum = 30 / 73.50964
Iteration 4: Changes / Distsum = 27 / 72.39893
Iteration 5: Changes / Distsum = 26 / 71.5724
Iteration 6: Changes / Distsum = 22 / 70.87693
Iteration 7: Changes / Distsum = 24 / 70.38391
Iteration 8: Changes / Distsum = 18 / 69.87478
Iteration 9: Changes / Distsum = 7 / 69.50894
Iteration 10: Changes / Distsum = 7 / 69.41389
Iteration 11: Changes / Distsum = 5 / 69.36102
Iteration 12: Changes / Distsum = 4 / 69.30983
Iteration 13: Changes / Distsum = 1 / 69.29236
Iteration 14: Changes / Distsum =  0 / 69.2913

    Elapsed time is 0.65 seconds.</code></pre>
<pre class="r"><code>pc_ks4 &lt;- tsclust(l_SRF8_z, k = 4L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 76.5106
Iteration 2: Changes / Distsum = 32 / 67.07705
Iteration 3: Changes / Distsum = 20 / 65.07166
Iteration 4: Changes / Distsum = 10 / 64.62115
Iteration 5: Changes / Distsum = 12 / 64.41459
Iteration 6: Changes / Distsum = 11 / 64.21979
Iteration 7: Changes / Distsum = 5 / 64.07669
Iteration 8: Changes / Distsum = 3 / 64.07443
Iteration 9: Changes / Distsum = 4 / 64.06104
Iteration 10: Changes / Distsum = 2 / 64.05042
Iteration 11: Changes / Distsum = 2 / 64.05731
Iteration 12: Changes / Distsum = 7 / 64.01087
Iteration 13: Changes / Distsum = 5 / 63.88928
Iteration 14: Changes / Distsum = 7 / 63.50889
Iteration 15: Changes / Distsum = 10 / 63.1806
Iteration 16: Changes / Distsum = 10 / 62.96688
Iteration 17: Changes / Distsum = 12 / 62.79098
Iteration 18: Changes / Distsum = 17 / 62.53946
Iteration 19: Changes / Distsum = 20 / 62.20188
Iteration 20: Changes / Distsum = 11 / 61.93916
Iteration 21: Changes / Distsum = 11 / 61.83186
Iteration 22: Changes / Distsum = 12 / 61.69036
Iteration 23: Changes / Distsum = 9 / 61.54638
Iteration 24: Changes / Distsum = 8 / 61.40556
Iteration 25: Changes / Distsum = 7 / 61.29195
Iteration 26: Changes / Distsum = 5 / 61.21528
Iteration 27: Changes / Distsum = 6 / 61.15293
Iteration 28: Changes / Distsum = 6 / 61.08039
Iteration 29: Changes / Distsum = 2 / 61.04132
Iteration 30: Changes / Distsum = 1 / 61.03316
Iteration 31: Changes / Distsum = 2 / 61.02398
Iteration 32: Changes / Distsum = 1 / 61.01079
Iteration 33: Changes / Distsum = 0 / 61.00639

    Elapsed time is 1.55 seconds.</code></pre>
<pre class="r"><code>pc_ks5 &lt;- tsclust(l_SRF8_z, k = 5L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)</code></pre>
<pre><code>Iteration 1: Changes / Distsum = 424 / 74.85699
Iteration 2: Changes / Distsum = 65 / 63.46492
Iteration 3: Changes / Distsum = 46 / 60.69721
Iteration 4: Changes / Distsum = 23 / 59.59166
Iteration 5: Changes / Distsum = 16 / 59.15221
Iteration 6: Changes / Distsum = 6 / 58.96142
Iteration 7: Changes / Distsum = 4 / 58.94024
Iteration 8: Changes / Distsum = 3 / 58.92438
Iteration 9: Changes / Distsum = 7 / 58.92885
Iteration 10: Changes / Distsum =  8 / 58.8633
Iteration 11: Changes / Distsum =  5 / 58.7412
Iteration 12: Changes / Distsum = 3 / 58.71087
Iteration 13: Changes / Distsum = 5 / 58.70122
Iteration 14: Changes / Distsum = 8 / 58.67248
Iteration 15: Changes / Distsum = 4 / 58.62334
Iteration 16: Changes / Distsum = 7 / 58.54815
Iteration 17: Changes / Distsum = 8 / 58.33184
Iteration 18: Changes / Distsum = 6 / 58.20243
Iteration 19: Changes / Distsum =  2 / 58.0072
Iteration 20: Changes / Distsum =  4 / 57.9674
Iteration 21: Changes / Distsum =  5 / 57.9328
Iteration 22: Changes / Distsum = 2 / 57.88911
Iteration 23: Changes / Distsum = 0 / 57.87923

    Elapsed time is 1.05 seconds.</code></pre>
<pre class="r"><code># Prototypes for 3 clusters
plot(pc_ks3)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-17-2.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for 4 clusters
plot(pc_ks4)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-17-3.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Prototypes for 5 clusters
plot(pc_ks5)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-17-4.png" width="1056" style="display: block; margin: auto;" /></p>
<p>(2-4) partial clustering methods - Tadpole problematic for our dataset (series’ cross-distance matrix is NOT symmetric)</p>
<pre class="r"><code># Tadpole method
pc_tp &lt;- tsclust(l_SRF8_z, k = 2L:10L, type = &quot;t&quot;,
  seed = 8, trace = TRUE,
  control = tadpole_control(dc = 1.5,
  window.size = 4L))</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 12.7%
Performing cluster assignment

TADPole completed for k = 2 &amp; dc = 1.5
TADPole completed for k = 3 &amp; dc = 1.5
TADPole completed for k = 4 &amp; dc = 1.5
TADPole completed for k = 5 &amp; dc = 1.5
TADPole completed for k = 6 &amp; dc = 1.5
TADPole completed for k = 7 &amp; dc = 1.5
TADPole completed for k = 8 &amp; dc = 1.5
TADPole completed for k = 9 &amp; dc = 1.5
TADPole completed for k = 10 &amp; dc = 1.5

    Elapsed time is 0.39 seconds.</code></pre>
<pre class="r"><code>internal_CVI(pc_tp, &quot;Partial clustering with Tadpole method&quot;)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-18-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code># use 8 clusters
pc_tp8 &lt;- tsclust(l_SRF8_z, k = 8L, type = &quot;t&quot;,
  seed = 8, trace = TRUE,
  control = tadpole_control(dc = 1.5,
  window.size = 4L))</code></pre>
<pre><code>
    Entering TADPole...

Computing lower and upper bound matrices
Pruning during local density calculation
Pruning during nearest-neighbor distance calculation (phase 1)
Pruning during nearest-neighbor distance calculation (phase 2)
Pruning percentage = 12.7%
Performing cluster assignment

TADPole completed for k = 8 &amp; dc = 1.5

    Elapsed time is 0.29 seconds.</code></pre>
<pre class="r"><code># Prototypes for 8 clusters
plot(pc_tp8)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-18-2.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="rain-analysis-rhythmicity-analysis-incorporating-non-parametric-methods" class="section level3">
<h3>6. RAIN analysis (Rhythmicity Analysis Incorporating Non-parametric methods)</h3>
</div>
<div id="given-code-httpsrdrr.iobiocrainfinstdocrain.pdf" class="section level3">
<h3>Given code: <a href="https://rdrr.io/bioc/rain/f/inst/doc/rain.pdf" class="uri">https://rdrr.io/bioc/rain/f/inst/doc/rain.pdf</a></h3>
<pre class="r"><code># BiocManager::install(&#39;rain&#39;)

set.seed(123)
times &lt;- c(1: 24) * 2
sin &lt;- 1 + 0.5 * sin(times / 24 * 2 * pi) + rnorm(24, 0, 0.3)
saw &lt;- rep(13:24 / 18 , 2) + rnorm(24, 0, 0.3)
measure &lt;- cbind(sin, saw)
require(&#39;lattice&#39;)
xyplot(t(measure)~rep(times, each=2) | c(&#39;sin&#39;, &#39;saw&#39;),layout = c(1, 2), type = &#39;o&#39;, xlab = &#39;time&#39;, ylab = &#39;value&#39;, cex.lab = 0.6)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-19-1.png" width="1056" style="display: block; margin: auto;" /></p>
<pre class="r"><code>require(rain)
rainresult &lt;- rain(measure, period=24, deltat=2, peak.border=c(0.1,0.9), verbose=FALSE)
rainresult</code></pre>
<pre><code>            pVal phase peak.shape period
sin 5.176859e-06     6         12     24
saw 1.162142e-02    24          2     24</code></pre>
<pre class="r"><code>data(menetRNASeqMouseLiver)
colnames(menetRNASeqMouseLiver)</code></pre>
<pre><code> [1] &quot;ZT_2_1&quot;  &quot;ZT_2_2&quot;  &quot;ZT_6_1&quot;  &quot;ZT_6_2&quot;  &quot;ZT_10_1&quot; &quot;ZT_10_2&quot; &quot;ZT_14_1&quot;
 [8] &quot;ZT_14_2&quot; &quot;ZT_18_1&quot; &quot;ZT_18_2&quot; &quot;ZT_22_1&quot; &quot;ZT_22_2&quot;</code></pre>
<pre class="r"><code>results &lt;- rain(t(menetRNASeqMouseLiver), deltat=4, period=24, nr.series=2, peak.border=c(0.3, 0.7), verbose=FALSE)
best &lt;- order(results$pVal)[1:10]
xyplot(as.matrix(menetRNASeqMouseLiver[best, (0:5 * 2 + rep(c(1, 2), each = 6))]) ~rep(0:11 * 4 + 2, each = 10) |rownames(menetRNASeqMouseLiver)[best], scales = list(y = list(relation = &#39;free&#39;)), layout = c(2, 5), type = &#39;b&#39;, pch = 16, xlab = &#39;time&#39;, ylab = &#39;expression value&#39;, cex.lab = 1)</code></pre>
<p><img src="figure/peptide_level_visualization.Rmd/unnamed-chunk-19-2.png" width="1056" style="display: block; margin: auto;" /></p>
</div>
<div id="apply-it-to-our-data" class="section level3">
<h3>Apply it to our data</h3>
</div>
<div id="archived-not-using-this-part" class="section level3">
<h3>Archived: Not using this part</h3>
<p>Approach2: Time Series Classification using Dynamic time warping distance Time series classification is to build a classification model based on labelled time series and then use the model to predict the label of unlabelled time series. The way for time series classification with R is to extract and build features from time series data first, and then apply existing classification techniques, such as SVM, k-NN, neural networks, regression and decision trees, to the feature set.</p>
<p>Discrete Wavelet Transform (DWT) provides a multi-resolution representation using wavelets and is used in the example below. Another popular feature extraction technique is Discrete Fourier Transform (DFT). (<a href="http://www.rdatamining.com/examples/time-series-clustering-classification" class="uri">http://www.rdatamining.com/examples/time-series-clustering-classification</a>)</p>
<pre class="r"><code># extracting DWT coefficients (with Haar filter)
library(wavelets)
wtData &lt;- NULL

sc &lt;- read.table(&quot;data/synthetic_control.data.txt&quot;, header=F, sep=&quot;&quot;)

for (i in 1:nrow(sc)){
  a &lt;- t(sc[i,])
  wt &lt;- dwt(a, filter=&quot;haar&quot;, boundary=&#39;periodic&#39;)
  wtData &lt;- rbind(wtData, unlist(c(wt@W,wt@V[[wt@level]])))
}

wtData &lt;- as.data.frame(wtData)
head(wtData)

# set class labels into categorical values
classId &lt;- c(rep(1,100), rep(2,100), rep(3,100),rep(4,100), rep(5,100), rep(6,100))
wtSc &lt;- data.frame(cbind(classId, wtData))

# build a decision tree with ctree() in package party
library(party)
ct &lt;- ctree(classId ~ ., data=wtSc, controls = ctree_control(minsplit=30, minbucket=10, maxdepth=5))
pClassId &lt;- predict(ct)

# check predicted classes against original class labels
table(classId, pClassId)
# accuracy
(sum(classId==pClassId)) / nrow(wtSc)

plot(ct, ip_args=list(pval=FALSE), ep_args=list(digits=0))


# Lower CVI means better clustering : k_shape is the best clustering method
sapply(list(DTW = pc_dtw, DTW_LB = pc_dtwlb, kShape = pc_ks, TADPole = pc_tp), cvi, b = names(l_SRF8), type = &quot;VI&quot;)

sapply(list(DTW = pc_dtw, DTW_LB = pc_dtwlb, kShape = pc_ks, TADPole = pc_tp), cvi, type = &quot;internal&quot;)


# subset
data &lt;- CharTraj[1L:20L]
pc_k &lt;- tsclust(data, k = 3L:5L, distance = &quot;dtw_basic&quot;, centroid = &quot;pam&quot;, seed = 94L)
names(pc_k) &lt;- paste0(&quot;k_&quot;, 3L:5L)
sapply(pc_k, cvi, type = &quot;internal&quot;)



names(l_SRF8)</code></pre>
</div>
<div id="archived-5.3.-dtwclust" class="section level3">
<h3>Archived: 5.3. dtwclust</h3>
<p>the clustering itself may be shape-based, feature-based or model-based.<br />
In the context of shape-based time-series clustering, it is common to utilize the Dynamic Time Warping (DTW) distance as dissimilarity measure (Aghabozorgi et al. 2015).<br />
DTW is a dynamic programming algorithm that compares two series and tries to find the optimum warping path between them under certain constraints, such as monotonicity. It started being used by the data mining community to overcome some of the limitations associated with the Euclidean distance (Ratanamahatana and Keogh 2004; Berndt and Clifford 1994).<br />
<a href="https://cran.r-project.org/web/packages/dtwclust/vignettes/dtwclust.pdf" class="uri">https://cran.r-project.org/web/packages/dtwclust/vignettes/dtwclust.pdf</a></p>
<pre class="r"><code># install.packages(&#39;dtwclust&#39;)
# install.packages(&#39;TSclust&#39;)
library(dtwclust)
require(&quot;TSclust&quot;)
data(&quot;uciCT&quot;)

proxy::pr_DB$set_entry(FUN = diss.ACF, names = c(&quot;ACFD&quot;), loop = TRUE, type = &quot;metric&quot;, distance = TRUE, description = &quot;Autocorrelation-based distance&quot;)

# Normalized DTW
ndtw &lt;- function(x, y, ...) {
  dtw(x, y, ...,
  step.pattern = asymmetric,
  distance.only = TRUE)$normalizedDistance
}

# Register the distance with proxy
proxy::pr_DB$set_entry(FUN = ndtw, names = c(&quot;nDTW&quot;),
  loop = TRUE, type = &quot;metric&quot;, distance = TRUE,
  description = &quot;Normalized, asymmetric DTW&quot;)

# Partitional clustering
tsclust(CharTraj[1L:10L], k = 2L,
  distance = &quot;nDTW&quot;, seed = 838)

# hierarchical clustering
hc_sbd &lt;- tsclust(CharTraj, type = &quot;h&quot;, k = 20L,
  preproc = zscore, seed = 899,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))

plot(hc_sbd)

# The series and the obtained prototypes can be plotted too
plot(hc_sbd, type = &quot;sc&quot;)

# Focusing on the first cluster
plot(hc_sbd, type = &quot;series&quot;, clus = 1L)
plot(hc_sbd, type = &quot;centroids&quot;, clus = 1L)


### Hierarchical clustering w/ shape based distance
hc_sbd &lt;- tsclust(CharTraj, type = &quot;h&quot;, k = 20L,
  preproc = zscore, seed = 899,
  distance = &quot;sbd&quot;, centroid = shape_extraction,
  control = hierarchical_control(method = &quot;average&quot;))


### partial clustering methods
# Reinterpolate to same length
data &lt;- reinterpolate(CharTraj, new.length = max(lengths(CharTraj)))

# z-normalization
data &lt;- zscore(data[60L:100L])
names(data)
# DTW method
pc_dtw &lt;- tsclust(data, k = 4L,
  distance = &quot;dtw_basic&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 20L,
  args = tsclust_args(cent = list(trace = TRUE)))

# DTW_lb method
pc_dtwlb &lt;- tsclust(data, k = 4L,
  distance = &quot;dtw_lb&quot;, centroid = &quot;dba&quot;,
  trace = TRUE, seed = 8,
  norm = &quot;L2&quot;, window.size = 20L,
  control = partitional_control(pam.precompute = FALSE),
  args = tsclust_args(cent = list(trace = TRUE)))

# k-shape method
pc_ks &lt;- tsclust(data, k = 4L,
  distance = &quot;sbd&quot;, centroid = &quot;shape&quot;,
  seed = 8, trace = TRUE)

# Tadpole method
pc_tp &lt;- tsclust(data, k = 4L, type = &quot;t&quot;,
  seed = 8, trace = TRUE,
  control = tadpole_control(dc = 1.5,
  window.size = 20L))

# Fuzzy clustering

# Calculate autocorrelation up to 50th lag
acf_fun &lt;- function(series, ...) {
  lapply(series, function(x) {
  as.numeric(acf(x, lag.max = 50, plot = FALSE)$acf)
  })
}
# Fuzzy c-means
fc &lt;- tsclust(CharTraj[1:20], type = &quot;f&quot;, k = 4L,
  preproc = acf_fun, distance = &quot;L2&quot;,
  seed = 42)

# Lower CVI means better clustering : k_shape is the best clustering method
sapply(list(DTW = pc_dtw, DTW_LB = pc_dtwlb, kShape = pc_ks, TADPole = pc_tp), cvi, b = CharTrajLabels[60L:100L], type = &quot;VI&quot;)

CharTraj

# Plot crisp partition in the original space
plot(fc, series = CharTraj[1:20], type = &quot;series&quot;)

# subset
data &lt;- CharTraj[1L:20L]
pc_k &lt;- tsclust(data, k = 3L:5L, distance = &quot;dtw_basic&quot;, centroid = &quot;pam&quot;, seed = 94L)
names(pc_k) &lt;- paste0(&quot;k_&quot;, 3L:5L)
sapply(pc_k, cvi, type = &quot;internal&quot;)</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19042)

Matrix products: default

Random number generation:
 RNG:     L&#39;Ecuyer-CMRG 
 Normal:  Inversion 
 Sample:  Rejection 
 
locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] rain_1.24.0         multtest_2.46.0     Biobase_2.50.0     
 [4] BiocGenerics_0.36.0 gmp_0.6-2           lattice_0.20-41    
 [7] TSclust_1.3.1       cluster_2.1.0       pdc_1.0.3          
[10] dtwclust_5.5.6      dtw_1.22-3          proxy_0.4-24       
[13] maditr_0.7.4        data.table_1.13.6   formattable_0.2.1  
[16] ggplot2_3.3.3       stringr_1.4.0       tidyr_1.1.2        
[19] dplyr_1.0.4         workflowr_1.6.2    

loaded via a namespace (and not attached):
  [1] bigmemory_4.5.36        bigmemory.sri_0.1.3     colorspace_2.0-0       
  [4] ellipsis_0.3.1          class_7.3-17            modeltools_0.2-23      
  [7] rprojroot_2.0.2         fs_1.5.0                clue_0.3-58            
 [10] rstudioapi_0.13         farver_2.0.3            ggrepel_0.9.1          
 [13] RSpectra_0.16-0         fansi_0.4.2             splines_4.0.3          
 [16] codetools_0.2-16        knitr_1.31              longitudinalData_2.4.1 
 [19] jsonlite_1.7.2          nloptr_1.2.2.2          shiny_1.6.0            
 [22] compiler_4.0.3          assertthat_0.2.1        Matrix_1.2-18          
 [25] fastmap_1.1.0           cli_2.3.1               later_1.1.0.1          
 [28] htmltools_0.5.1.1       tools_4.0.3             misc3d_0.9-0           
 [31] gtable_0.3.0            glue_1.4.2              reshape2_1.4.4         
 [34] Rcpp_1.0.5              jquerylib_0.1.3         fracdiff_1.5-1         
 [37] vctrs_0.3.6             urca_1.3-0              nlme_3.1-149           
 [40] clv_0.3-2.2             iterators_1.0.13        crosstalk_1.1.1        
 [43] lmtest_0.9-38           timeDate_3043.102       xfun_0.20              
 [46] ps_1.5.0                mime_0.10               miniUI_0.1.1.1         
 [49] lifecycle_1.0.0         MASS_7.3-53             zoo_1.8-8              
 [52] scales_1.1.1            promises_1.1.1          yaml_2.2.1             
 [55] quantmod_0.4.18         curl_4.3                sass_0.3.1             
 [58] stringi_1.5.3           highr_0.8               tseries_0.10-48        
 [61] foreach_1.5.1           TTR_0.24.2              manipulateWidget_0.10.1
 [64] rlang_0.4.10            pkgconfig_2.0.3         rgl_0.105.13           
 [67] locpol_0.7-0            evaluate_0.14           purrr_0.3.4            
 [70] htmlwidgets_1.5.3       labeling_0.4.2          tidyselect_1.1.0       
 [73] plyr_1.8.6              magrittr_2.0.1          R6_2.5.0               
 [76] generics_0.1.0          DBI_1.1.1               pillar_1.5.0           
 [79] whisker_0.4             withr_2.4.1             xts_0.12.1             
 [82] survival_3.2-7          nnet_7.3-14             tibble_3.0.4           
 [85] crayon_1.4.1            KernSmooth_2.23-17      utf8_1.1.4             
 [88] rmarkdown_2.7           grid_4.0.3              flexclust_1.4-0        
 [91] git2r_0.27.1            forecast_8.13           digest_0.6.27          
 [94] webshot_0.5.2           xtable_1.8-4            httpuv_1.5.4           
 [97] RcppParallel_5.0.3      stats4_4.0.3            munsell_0.5.0          
[100] bslib_0.2.4             tcltk_4.0.3             quadprog_1.5-8         
[103] shinyjs_2.0.0          </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
